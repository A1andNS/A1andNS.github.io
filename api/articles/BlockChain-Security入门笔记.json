{"title":"Blockchain Security入门笔记","uid":"268a3b6bf1055fd03ee61fb9fcbc2807","slug":"BlockChain-Security入门笔记","date":"2021-08-24T15:49:18.000Z","updated":"2021-08-25T16:01:33.500Z","comments":true,"path":"api/articles/BlockChain-Security入门笔记.json","keywords":"A1andNS","cover":[],"content":"<p>Blockchain入门必须从相关名词开始入手。</p>\n<h1 id=\"钱包Wallet\"><a href=\"#钱包Wallet\" class=\"headerlink\" title=\"钱包Wallet\"></a>钱包Wallet</h1><p>Wallet是一个管理私钥的工具，通常包含一个软件客户端，允许使用者通过钱包检查、存储、交易持有的数字货币。这是一个重要的设施和入口。关于钱包的攻击主要集中再钓鱼和第三方hijack，这意味着钱包持有者需要提高安全意识。</p>\n<h1 id=\"冷钱包Cold-Wallet\"><a href=\"#冷钱包Cold-Wallet\" class=\"headerlink\" title=\"冷钱包Cold Wallet\"></a>冷钱包Cold Wallet</h1><p>cold wallet是一种脱离网络连接的离线钱包，将数字货币进行离线存储的钱包。使用者生成数字货币地址和私钥保存在冷钱包而无需网络支持，因此cold wallet的私钥不容易被hacker获取，但是也存在安全风险，例如random number不安全、hardware损坏与丢失等等。而最重要的东西还是那个<strong>私钥</strong>，必须要保护好私钥的安全。</p>\n<h1 id=\"热钱包Hot-Wallet\"><a href=\"#热钱包Hot-Wallet\" class=\"headerlink\" title=\"热钱包Hot Wallet\"></a>热钱包Hot Wallet</h1><p>这个很明显就是Cold Wallet的反义了，所以Hot Wallet自然就是需要网络的在线钱包。但是在线钱包带来便利的同时也带来了更多的安全风险，例如钓鱼网站盗取钱包文件，泄露钱包密码，或者私钥被破解等的问题。注意：中心化管理钱包并非绝对安全，最好在不同平台设置不同的密码，启用二次认证，提升安全性。</p>\n<h1 id=\"公钥Public-Key\"><a href=\"#公钥Public-Key\" class=\"headerlink\" title=\"公钥Public Key\"></a>公钥Public Key</h1><p>Public Key是与私钥成对出现的，这个和非对称加密的公私密钥类似吧。Public Key与Private Key组成了一个密钥对，公钥由私钥生成，无法逆推私钥。公钥能够通过一系列算法运算得到钱包的地址，因此能够作为拥有这个钱包地址的凭证。</p>\n<h1 id=\"私钥Private-Key\"><a href=\"#私钥Private-Key\" class=\"headerlink\" title=\"私钥Private Key\"></a>私钥Private Key</h1><p>Private Key是一串由随机算法生成的数据，它可以通过非对称加密算法算出公钥，公钥可以再算出币的地址。<strong>私钥是非常重要的</strong>，区块链资产实际在区块链上，所有者实际只拥有私钥，私钥代表了你对区块链资产的绝对控制权，因此，区块链资产安全问题的核心问题应该在于私钥的存储上。</p>\n<p>public key和private key实际上就是利用了非对称加密算法带来的好处，提升了数据的安全性。私钥加密再由公钥解密，和传统的账号和密码形式相比安全性提高了数据传输的安全性和完整性。</p>\n<h1 id=\"助记词Mnemonic\"><a href=\"#助记词Mnemonic\" class=\"headerlink\" title=\"助记词Mnemonic\"></a>助记词Mnemonic</h1><p>由于私钥是一长串毫无意义的字符，难以记忆，故而出现了mnemonic，就像IP地址难以记忆，故而出现了domain一样。mnemonic是利用固定算法来将私钥转换为十多个常见的英文单词，以便于记忆。所以助记词与私钥是直接关联，可以互相转换，故而助记词也需要如private key一样保护。而且助记词是明文性的，更要注意，避免泄露。最安全的保存方式自然是物理方式，电子文档还是存在更大泄露风险。</p>\n<h1 id=\"Keystore\"><a href=\"#Keystore\" class=\"headerlink\" title=\"Keystore\"></a>Keystore</h1><p>Keystore主要在以太坊wallet中较为常见，它是把私钥通过钱包密码再加密来的，与助记词不同。私钥通过钱包密码再加密得来的，与助记词不同，一般可保存为文本或 JSON 格式存储。换句话说， Keystore 需要用钱包密码解密后才等同于私钥。这意味着原本私钥的安全性问题就间接变为wallet密码的安全问题，如果wallet密码强度不高，那么可能导致private key也会不安全。存在暴力破解wallet password然后结合盗取的keystore解密出私钥的风险。故而keystore使用后，需要加强对wallet密码的保护，提高wallet密码强度。</p>\n<p>备份、备份还是备份，区块链数字钱包的私钥、助记词、keystore都要注意备份，采取多重、多次备份来减少因为这三者丢失照成的风险。</p>\n<h1 id=\"imToken钱包安全“十不原则”\"><a href=\"#imToken钱包安全“十不原则”\" class=\"headerlink\" title=\"imToken钱包安全“十不原则”\"></a>imToken钱包安全“十不原则”</h1><ol>\n<li>不使用未备份的钱包 </li>\n<li>不使用邮件传输或存储私钥 </li>\n<li>不使用微信收藏或云备份存储私钥</li>\n<li>不要截屏或拍照保存私钥 </li>\n<li>不使用微信、QQ 传输私钥</li>\n<li>不要将私钥告诉身边的人</li>\n<li>不要将私钥发送到群里</li>\n<li>不使用第三方提供的未知来源钱包应用</li>\n<li>不使用他人提供的 Apple ID</li>\n<li>不要将私钥导入未知的第三方网站</li>\n</ol>\n<h1 id=\"公链Public-Blockchain\"><a href=\"#公链Public-Blockchain\" class=\"headerlink\" title=\"公链Public Blockchain\"></a>公链Public Blockchain</h1><p>Public Blockchain即公有链，是全球所有人都可以随时进入读取、交易、确认的共识Blockchain。公有链通常认为是完全去中心化的，链上的数据都是公开透明的，不可更改，任何人都可以通过交易或挖矿读取和写入数据。</p>\n<p>一般通过代币机制（Token）来鼓励参与者竞争记账，来确保数据的安全性。无法检测所有公链。因为检测所有的公链的工作量非常大，只依靠一家企业不可能实现全体区块链生态安全监控，这就导致hacker能够转空子在众多公链中寻找可利用漏洞发起攻击。</p>\n<p>公链被黑已经累计损失5200W US Dollars</p>\n<p><img src=\"C:\\Users\\A1andNS\\AppData\\Roaming\\Typora\\typora-user-images\\image-20210825124958657.png\" alt=\"图片来自雾慢安全区块链被黑档案\"></p>\n<h1 id=\"交易所Exchange\"><a href=\"#交易所Exchange\" class=\"headerlink\" title=\"交易所Exchange\"></a>交易所Exchange</h1><p>区块链交易所就是类似证券交易所类似的功能，只不过这里的交易所是数字货币买卖交易的平台。数字货币交易所又分为<strong>中心化交易所</strong>和<strong>去中心化交易所</strong>。</p>\n<h2 id=\"去中心化交易所\"><a href=\"#去中心化交易所\" class=\"headerlink\" title=\"去中心化交易所\"></a>去中心化交易所</h2><p>交易行为直接发生在区块链上，数字货币会直接发回使用者的钱包，或是保存在区块链上的智能合约。这种设计的好处在于交易所不会持有用户大量的数字货币，所有的数字货币都存储在用户钱包或者平台的智能合约上。信任层面去中心化了，交易所的信任问题就被解决了，每笔交易都是在区块链上公开透明，交易所不用保管用户资产和私钥，这样用户资产完全由用户自己控制，提高了个人数据安全性和隐私性。常见去中心化交易所有WhaleEx、Bancor、dYdX等。</p>\n<p>去中心化交易所只是一个交易平台，而不直接经手用户资产和私钥，用户实际上只直接进行了交易，对公共链进行修改。</p>\n<h2 id=\"中心化交易所\"><a href=\"#中心化交易所\" class=\"headerlink\" title=\"中心化交易所\"></a>中心化交易所</h2><p>目前热门交易所多是采用了中心化技术的交易所，使用者需要在平台上注册，并经过一系列身份认证KYC后，才能在平台上进行数字货币的交易。<br>所谓中心化交易所，我感觉类似是区块链世界中的银行，这个银行中存储了大量的数字货币，然后用户们的交易也是在这个拥有大量数字货币的银行中进行的。这种交易并没有影响到外部的公共区块链，这只是内部的数字货币所有者变动而已，对于外部来说应当是不公开透明的。相当于交易所维护一个内部数据库，来控制不同用户资产，同时及时提供提款服务保障即可。对外这个拥有大量用户的数字资产的交易所才是一个区块链用户。这样似乎是能够减少对公链的频繁修改。</p>\n<p>但是bank是一种存储了大量财富的地方，那肯定有人会打它的主意，而中心化Exchange就是这样的一个资产聚集地，自然也成了hackers的重要目标。常见中心化交易所币安、火币、OKEx等</p>\n<p><img src=\"C:\\Users\\A1andNS\\AppData\\Roaming\\Typora\\typora-user-images\\image-20210825124704471.png\" alt=\"图片来自雾慢安全区块链被黑档案\"></p>\n<p>截止现在交易所被黑导致的损失达到了64多亿US Dollars</p>\n<h1 id=\"节点Node\"><a href=\"#节点Node\" class=\"headerlink\" title=\"节点Node\"></a>节点Node</h1><p>在传统互联网中，数据是集中存放的，即所谓中心化问题，使用中心化的服务器来存储数据，它存在的最大危机就是，如果这个中心出现故障，那就意味着大家都无法使用。所以分布式数据库出现了，而区块链就是去中心化的分布式数据库，由千万个小“服务器”构成的巨大网络。</p>\n<p>区块链网络中的每一个节点就是存储所有区块数据的每一台电脑或服务器。新区快的产生、交易验证、广播同步都是由节点来完成。Node也可以细分为全节点和轻节点。</p>\n<p>全节点：拥有全网所有的交易数据的节点</p>\n<p>轻节点：只拥有和自己相关的交易数据节点</p>\n<p>而分布式就体现在每一个全节点都会保存全网所有交易数据，相当于是在这个区块链网络中对交易数据有多重备份，即使某个节点down掉了，整个网络依旧可以正常运作。</p>\n<h1 id=\"RPC\"><a href=\"#RPC\" class=\"headerlink\" title=\"RPC\"></a>RPC</h1><p>RPC是Remote Procedure Call，远程过程调用的缩写，这是一个计算机通讯协议。</p>\n<p>以太坊 RPC 接口是以太坊节点与其他系统交互的窗口，以太坊提供了各种 RPC 调用：HTTP、IPC、WebSocket 等等。在 以太坊源码中，server.go 是核心逻辑，负责 API 服务的注入，以及请求处理、返回。http.go 实现 HTTP 的调用，websocket.go 实现 WebSocket 的调用，ipc.go 实现 IPC 的调用。以太坊节点默认在 8545 端口提供了 JSON RPC 接口，数据传输采用 JSON 格式，可以执行 Web3 库的各种命令，可以 向前端（例如 imToken、Mist 等钱包客户端）提供区块链上的信息</p>\n<p>关于RPC攻击的经典案例是<strong>以太坊黑色情人节漏洞</strong>，攻击者利用以太坊节点Geth/Parity RPC API鉴权缺陷，恶意调用eth_sendTransaction盗取代币，持续两年，造成巨大资产损失。</p>\n<h1 id=\"共识Consensus\"><a href=\"#共识Consensus\" class=\"headerlink\" title=\"共识Consensus\"></a>共识Consensus</h1><p>共识算法主要是解决分布式系统中多节点之间对某个状态达成一致性结果的问题。分布式系统给由于具有多个服务节点共同完成你事物处理，所以对整个分布式系统而言，它在对外是应当要保持数据状态的一致性。但是现实问题是，由于节点的不可靠性和通讯的不稳定性，甚至节点作恶伪造数据等因素的存在，节点之间可能就会出现数据状态的不一致性，所以我们需要引入一个机制来进行协调，让数据状态一致化，这就是共识算法了。</p>\n<p>将不可靠的节点组建成一个可靠的分布式系统，从而提高系统可靠性，数据状态的一致性。</p>\n<p>区块链系统本身作为一个超大规模的分布式系统，但又与传统的分布式系统存在明显区别。由于它不依赖于任何一个中央权威，系统建立在去中心化的点对点网络基础之上，因此分散的节点需要就交易的有效与否达成一致，这就是共识算法发挥作用的地方，即确保所有节点都遵守协议规则并保证所有 交易都以可靠的方式进行。由共识算法实现在分散的节点间对交易的处理顺序达成一致，这是共识算法在区块链系统中起到的最主要作用。</p>\n<p><strong>共识算法本质上就是在解决分布式系统如何保持一致性的问题</strong></p>\n<h2 id=\"工作量证明PoW\"><a href=\"#工作量证明PoW\" class=\"headerlink\" title=\"工作量证明PoW\"></a>工作量证明PoW</h2><p>PoW（proof of work）是历史上第一个成功去中心化区块链共识算法，被比特币、以太坊，莱特币等主流公链广泛使用。</p>\n<p>工作量证明要求节点参与者<strong>执行计算密集型的任务</strong>，但是对于其他网络参与者来说易于验证。在比特币的例子中，矿工竞相向由整个网络维护的区块链账本中添加所收集到的交易，即区块。为了做到这 一点，矿工必须第一个准确计算出“nonce”，这是一个添加在字符串末尾的数字，用来创建一个满足开头特定个数为零的哈希值。不过存在采矿的大量电力消耗和低交易吞吐量等缺点。</p>\n<h2 id=\"权益证明PoS\"><a href=\"#权益证明PoS\" class=\"headerlink\" title=\"权益证明PoS\"></a>权益证明PoS</h2><p>PoS（proof of Stake）是一种主流的去区块链共识算法，目的是为了让区块链里的分布 式节点达成共识，它往往和工作量证明机制(Proof of Work)一起出现，两种都被认为是区块链共识算法里面的主流算法之一。作为一种算法，它通过<strong>持币人的同意来达成共识，目的是确定出新区块</strong>，这过程相对于 PoW，不需要硬件和电力，且效率更高。</p>\n<p>PoS 共识中引入了 Stake 的概念，持币人将代币进行 Staking，要求所有的参与者抵押一部分他们所拥有的 Token 来验证交易，然后获得出块的机会，PoS 共识中会通过选举算法，按照持币量比例以及 Token 抵押时长，或者是一些其他的方式，选出打包区块的矿工。矿工在指定高度完成打包交易，生成新区块，并广播区块，广播的区块经过 PoS 共识中另外一道”门槛”，验证人验证交易，通过验证后，区块得到确认。这样一轮 PoS 的共识过程就进行完成了。权益证明通过长期绑定验证者的利益和 整个网络的利益来阻止不良行为。锁定代币后，如果验证者存在欺诈性交易，那么他们所抵押的 Token 也会被削减。<strong>PoS 的研究脚步还在不断前进，安全、性能和去中心化一直都是 PoS 所追求的方向，未来也将有更多 PoS 的项目落地。</strong></p>\n<h1 id=\"参考资料\"><a href=\"#参考资料\" class=\"headerlink\" title=\"参考资料\"></a>参考资料</h1><p>[1]. 雾慢安全团队<a href=\"https://paper.seebug.org/973/\">paper.seebug.org</a></p>\n","text":"Blockchain入门必须从相关名词开始入手。 钱包WalletWallet是一个管理私钥的工具，通常包含一个软件客户端，允许使用者通过钱包检查、存储、交易持有的数字货币。这是一个重要的设施和入口。关于钱包的攻击主要集中再钓鱼和第三方hijack，这意味着钱包持有者需要提高安全...","link":"","photos":[],"count_time":{"symbolsCount":"4.7k","symbolsTime":"4 mins."},"categories":[{"name":"学习笔记","slug":"学习笔记","count":33,"path":"api/categories/学习笔记.json"}],"tags":[{"name":"区块链","slug":"区块链","count":1,"path":"api/tags/区块链.json"}],"toc":"<ol class=\"toc\"><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" href=\"#%E9%92%B1%E5%8C%85Wallet\"><span class=\"toc-text\">钱包Wallet</span></a></li><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" href=\"#%E5%86%B7%E9%92%B1%E5%8C%85Cold-Wallet\"><span class=\"toc-text\">冷钱包Cold Wallet</span></a></li><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" href=\"#%E7%83%AD%E9%92%B1%E5%8C%85Hot-Wallet\"><span class=\"toc-text\">热钱包Hot Wallet</span></a></li><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" href=\"#%E5%85%AC%E9%92%A5Public-Key\"><span class=\"toc-text\">公钥Public Key</span></a></li><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" href=\"#%E7%A7%81%E9%92%A5Private-Key\"><span class=\"toc-text\">私钥Private Key</span></a></li><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" href=\"#%E5%8A%A9%E8%AE%B0%E8%AF%8DMnemonic\"><span class=\"toc-text\">助记词Mnemonic</span></a></li><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" href=\"#Keystore\"><span class=\"toc-text\">Keystore</span></a></li><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" href=\"#imToken%E9%92%B1%E5%8C%85%E5%AE%89%E5%85%A8%E2%80%9C%E5%8D%81%E4%B8%8D%E5%8E%9F%E5%88%99%E2%80%9D\"><span class=\"toc-text\">imToken钱包安全“十不原则”</span></a></li><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" href=\"#%E5%85%AC%E9%93%BEPublic-Blockchain\"><span class=\"toc-text\">公链Public Blockchain</span></a></li><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" href=\"#%E4%BA%A4%E6%98%93%E6%89%80Exchange\"><span class=\"toc-text\">交易所Exchange</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E5%8E%BB%E4%B8%AD%E5%BF%83%E5%8C%96%E4%BA%A4%E6%98%93%E6%89%80\"><span class=\"toc-text\">去中心化交易所</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E4%B8%AD%E5%BF%83%E5%8C%96%E4%BA%A4%E6%98%93%E6%89%80\"><span class=\"toc-text\">中心化交易所</span></a></li></ol></li><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" href=\"#%E8%8A%82%E7%82%B9Node\"><span class=\"toc-text\">节点Node</span></a></li><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" href=\"#RPC\"><span class=\"toc-text\">RPC</span></a></li><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" href=\"#%E5%85%B1%E8%AF%86Consensus\"><span class=\"toc-text\">共识Consensus</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E5%B7%A5%E4%BD%9C%E9%87%8F%E8%AF%81%E6%98%8EPoW\"><span class=\"toc-text\">工作量证明PoW</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E6%9D%83%E7%9B%8A%E8%AF%81%E6%98%8EPoS\"><span class=\"toc-text\">权益证明PoS</span></a></li></ol></li><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" href=\"#%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99\"><span class=\"toc-text\">参考资料</span></a></li></ol>","author":{"name":"沐子龍","slug":"blog-author","avatar":"/svg/head.png","link":"/","description":"爱你所爱，行你所行，听从你心，无问西东","socials":{"github":"https://github.com/A1andNS","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}},"mapped":true,"prev_post":{},"next_post":{"title":"初识人机协同漏洞挖掘之概念","uid":"42e9f92a9641d13b1a38a01b1f926568","slug":"初识人机协同漏洞挖掘之概念","date":"2021-08-14T03:27:21.000Z","updated":"2021-08-14T14:28:44.363Z","comments":true,"path":"api/articles/初识人机协同漏洞挖掘之概念.json","keywords":"A1andNS","cover":[],"text":"前言近日，有幸可以看到一份关于人机协同探索软件安全的资料，这份资料是在2018年4月19日由DARPA公开发布，各种行业都有人机协同的出现，有的是human-robot,有的是human-mathine，而这种人机协同（human-computer）用于漏洞挖掘的概念很新颖。 漏...","link":"","photos":[],"count_time":{"symbolsCount":"2.8k","symbolsTime":"3 mins."},"categories":[{"name":"学习笔记","slug":"学习笔记","count":33,"path":"api/categories/学习笔记.json"}],"tags":[{"name":"漏洞挖掘","slug":"漏洞挖掘","count":4,"path":"api/tags/漏洞挖掘.json"}],"author":{"name":"沐子龍","slug":"blog-author","avatar":"/svg/head.png","link":"/","description":"爱你所爱，行你所行，听从你心，无问西东","socials":{"github":"https://github.com/A1andNS","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}}}}