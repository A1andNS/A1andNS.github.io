{"title":"恶意DLL生成器","uid":"2c85fb612c2f99edec9ccbb865c80b1b","slug":"恶意DLL生成器","date":"2020-08-02T14:48:26.000Z","updated":"2020-08-04T15:46:22.000Z","comments":true,"path":"api/articles/恶意DLL生成器.json","keywords":"A1andNS","cover":"https://cdn.jsdelivr.net/gh/A1andNS/picgo@latest/img/20200802224948.jpg","content":"<p>今天在Freebuf上看到了关于一个恶意DLL文件生成器的介绍，就跟着文章了解了一下。记录一下内容。文章链接：<code>https://mp.weixin.qq.com/s/CCKA4jZ6Wk1qcK9500D5mA</code></p>\n<p>首先就是今天看到的这个工具叫做EvilDLL，根据Freebuf上的介绍，以下为原文：</p>\n<blockquote><span class=\"custom-blockquote-svg\"><svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"\" xmlns=\"http://www.w3.org/2000/svg\" data-reactroot=\"\">\n<path fill=\"\" d=\"M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\" undefined=\"1\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\"></path>\n</svg>\n</span><p><strong>EvilDLL是一款专门针对DLL劫持攻击而开发并设计的恶意DLL（反向Shell）生成器。</strong></p></blockquote>\n<p>然后正好了解一下DLL劫持是什么意思。</p>\n<h3 id=\"什么时DLL劫持\"><a href=\"#什么时DLL劫持\" class=\"headerlink\" title=\"什么时DLL劫持\"></a>什么时DLL劫持</h3><p>我看了一下，大概的意思就是正常程序在加载DLL文件时，有个优先级问题，首先会在当前程序所在目录下匹配加载DLL，如果没有找到相关的DLL文件才会去Window系统目录中查找，最后才会在环境变量中列出的目录中查找。所以这就给攻击者提供的一个劫持的机会，只要在程序目录下伪造一个同名DLL文件，就可以做到劫持了，因为程序默认先执行了恶意/伪装的DLL文件，然后才会跳转到系统的正在的DLL文件去执行。这就是一个劫持的过程了。</p>\n<p><img src=\"https://mmbiz.qpic.cn/mmbiz_jpg/qq5rfBadR3ic8zswkYia8Qic4tNcpQGhomr4BEQtXMJ1LIoCLnMyKZoY7Wxic7EY9xNsiaRfTg0yzRxFNibiatMS1XBxg/640?wx_fmt=jpeg&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1\" alt=\"图片来源之Freebuf\"></p>\n<p>关于功能性的介绍就不多说了，原链接里有。</p>\n<p>下面就按照原链接里的方法，来配置一下环境以满足工具运行要求。</p>\n<h3 id=\"一、Mingw-w64编译器：\"><a href=\"#一、Mingw-w64编译器：\" class=\"headerlink\" title=\"一、Mingw-w64编译器：\"></a>一、Mingw-w64编译器：</h3><p><img src=\"https://cdn.jsdelivr.net/gh/A1andNS/picgo@latest/img/20200804230235.png\" alt=\"编译器安装\"></p>\n<h3 id=\"二、Ngork认证令牌\"><a href=\"#二、Ngork认证令牌\" class=\"headerlink\" title=\"二、Ngork认证令牌\"></a>二、Ngork认证令牌</h3><p>接下来要搞个Ngork认证令牌：访问<a href=\"https://ngrok.com/signup\">https://ngrok.com/signup</a></p>\n<p>注册一个用户，我这里使用注册新用户的方式，没有成功，始终都是验证失败。所以我在此处直接使用我的GitHub账号登录。</p>\n<p>然后到Authentication处拿去令牌</p>\n<p><img src=\"https://cdn.jsdelivr.net/gh/A1andNS/picgo@latest/img/20200804230456.png\" alt=\"拿取令牌\"></p>\n<p>接下来要在ngrok官网下载客户端，然后安装认证令牌。</p>\n<pre class=\"line-numbers language-powershell\" data-language=\"powershell\"><code class=\"language-powershell\"><span class=\"token punctuation\">.</span><span class=\"token operator\">/</span>ngrok authtoken &lt;YOUR_AUTHTOKEN><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<h3 id=\"三、克隆工具到本地\"><a href=\"#三、克隆工具到本地\" class=\"headerlink\" title=\"三、克隆工具到本地\"></a>三、克隆工具到本地</h3><p>这个工具的原本仓库应该是thelinuxchoice/evildll，但是我在git克隆时，发现该仓库已不存在了。不知道到什么原因，于是我在GitHub上重新检索了evilldll工具。找到了如下图中的仓库：<a href=\"https://github.com/CrackerCat/evildll.git\">https://github.com/CrackerCat/evildll.git</a></p>\n<p><img src=\"https://cdn.jsdelivr.net/gh/A1andNS/picgo@latest/img/20200804234602.png\" alt=\"image-20200804230229407\"></p>\n<p>克隆到本地后，就可以试着来运行一下了。</p>\n<p><img src=\"https://cdn.jsdelivr.net/gh/A1andNS/picgo@latest/img/20200804234611.png\" alt=\"image-20200804234513278\"></p>\n","text":"今天在Freebuf上看到了关于一个恶意DLL文件生成器的介绍，就跟着文章了解了一下。记录一下内容。文章链接：https://mp.weixin.qq.com/s/CCKA4jZ6Wk1qcK9500D5mA 首先就是今天看到的这个工具叫做EvilDLL，根据Freebuf上的介...","link":"","photos":[],"count_time":{"symbolsCount":894,"symbolsTime":"1 mins."},"categories":[{"name":"网络安全","slug":"网络安全","count":3,"path":"api/categories/网络安全.json"}],"tags":[{"name":"网络安全","slug":"网络安全","count":32,"path":"api/tags/网络安全.json"}],"toc":"<ol class=\"toc\"><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E4%BB%80%E4%B9%88%E6%97%B6DLL%E5%8A%AB%E6%8C%81\"><span class=\"toc-text\">什么时DLL劫持</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E4%B8%80%E3%80%81Mingw-w64%E7%BC%96%E8%AF%91%E5%99%A8%EF%BC%9A\"><span class=\"toc-text\">一、Mingw-w64编译器：</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E4%BA%8C%E3%80%81Ngork%E8%AE%A4%E8%AF%81%E4%BB%A4%E7%89%8C\"><span class=\"toc-text\">二、Ngork认证令牌</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E4%B8%89%E3%80%81%E5%85%8B%E9%9A%86%E5%B7%A5%E5%85%B7%E5%88%B0%E6%9C%AC%E5%9C%B0\"><span class=\"toc-text\">三、克隆工具到本地</span></a></li></ol>","author":{"name":"A1andNS","slug":"blog-author","avatar":"/svg/head.png","link":"/","description":"爱你所爱，行你所行，听从你心，无问西东","socials":{"github":"https://github.com/A1andNS","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}},"mapped":true,"prev_post":{"title":"PHP学习（一）","uid":"a391b63f847545ca1acc39698f975b5f","slug":"PHP学习（一）","date":"2020-08-08T06:28:34.000Z","updated":"2020-08-26T08:31:10.000Z","comments":true,"path":"api/articles/PHP学习（一）.json","keywords":"A1andNS","cover":[],"text":"先学习的pyhton，PHP落下了，虽然大体上看得懂，还是觉得不太稳，所以整体学习一下。 什么是PHP？ PHP（全称：PHP：Hypertext Preprocessor，即”PHP：超文本预处理器”）是一种通用开源脚本语言。 PHP 脚本在服务器上执行。 PHP 可免费下载使...","link":"","photos":[],"count_time":{"symbolsCount":"1.8k","symbolsTime":"2 mins."},"categories":[{"name":"PHP","slug":"PHP","count":7,"path":"api/categories/PHP.json"}],"tags":[{"name":"PHP","slug":"PHP","count":8,"path":"api/tags/PHP.json"}],"author":{"name":"A1andNS","slug":"blog-author","avatar":"/svg/head.png","link":"/","description":"爱你所爱，行你所行，听从你心，无问西东","socials":{"github":"https://github.com/A1andNS","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}}},"next_post":{"title":"第五空间WEB之hate-php","uid":"64631c5ddb0aa3cce868e64df4ac6772","slug":"第五空间WEB之hate-php","date":"2020-06-28T04:15:47.000Z","updated":"2020-06-28T06:26:04.000Z","comments":true,"path":"api/articles/第五空间WEB之hate-php.json","keywords":"A1andNS","cover":[],"text":"hate-php 复现平台：CTFHUB 题目来源：“第五空间”智能安全大赛WEB题 题目上来直接给源码： &lt;?php error_reporting(0); if(!isset($_GET['code']))&#123; highlight_file(__FILE__);...","link":"","photos":[],"count_time":{"symbolsCount":955,"symbolsTime":"1 mins."},"categories":[{"name":"CTF","slug":"CTF","count":44,"path":"api/categories/CTF.json"}],"tags":[{"name":"CTF","slug":"CTF","count":16,"path":"api/tags/CTF.json"},{"name":"WEB","slug":"WEB","count":39,"path":"api/tags/WEB.json"}],"author":{"name":"A1andNS","slug":"blog-author","avatar":"/svg/head.png","link":"/","description":"爱你所爱，行你所行，听从你心，无问西东","socials":{"github":"https://github.com/A1andNS","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}}}}