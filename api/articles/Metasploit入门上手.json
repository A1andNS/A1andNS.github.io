{"title":"Metasploit入门上手","uid":"da0bd7cce36ba07293df734f9332fbf1","slug":"Metasploit入门上手","date":"2020-03-09T08:02:10.000Z","updated":"2021-07-17T16:59:17.587Z","comments":true,"path":"api/articles/Metasploit入门上手.json","keywords":"A1andNS","cover":"https://gitee.com/A1andNS/blogimage/raw/master/img/20210718005833.png","content":"<h1 id=\"Metasploit入门上手\"><a href=\"#Metasploit入门上手\" class=\"headerlink\" title=\"Metasploit入门上手\"></a>Metasploit入门上手</h1><p>今天是2019年10月24日打卡嘀嘀嘀！！！菜鸟卡！！一起学习进步！！！</p>\n<h2 id=\"基本介绍\"><a href=\"#基本介绍\" class=\"headerlink\" title=\"基本介绍\"></a>基本介绍</h2><h3 id=\"发展历史\"><a href=\"#发展历史\" class=\"headerlink\" title=\"发展历史\"></a>发展历史</h3><p>开源软件metasploit是由HD Moore在2003年创立的，并在2003年10月发布了第一个版本。它集成了11个渗透攻击模块。</p>\n<h3 id=\"版本\"><a href=\"#版本\" class=\"headerlink\" title=\"版本\"></a>版本</h3><p>metasploit分为两个版本，一个是专业版一个是精简版。当然专业版是要收费的。。。。当然虽然有些东西要付费但是你想要也未必就没有。</p>\n<h2 id=\"Metasploit基本模块\"><a href=\"#Metasploit基本模块\" class=\"headerlink\" title=\"Metasploit基本模块\"></a>Metasploit基本模块</h2><h3 id=\"模块类型\"><a href=\"#模块类型\" class=\"headerlink\" title=\"模块类型\"></a>模块类型</h3><p>metasploit的模块有很多，根据用途的不同大概分为一下几类，渗透模块，辅助模块，攻击载荷模块，Shellcode模块。</p>\n<h3 id=\"渗透模块\"><a href=\"#渗透模块\" class=\"headerlink\" title=\"渗透模块\"></a>渗透模块</h3><p>这个模块是metasploit的最核心功能组件了，还可以细分为渗透攻击模块和后渗透攻击模块。主要就是漏洞利用和利用配置弱点发起攻击。如果你想要看渗透攻击的源代码，可以去metasploit源代码目录的modules/exploits子目录下找到。</p>\n<p>对于渗透攻击模组，它的 攻击行为也可以分为两种：主动渗透攻击和被动渗透攻击。</p>\n<p>主动当然就是我们利用存在的安全漏洞，对网络服务端软件或者应用程序之间的联系进行攻击。主要是发起基于服务的攻击，注入恶意执行代码，触发漏洞。一般恶意代码也会包含一些payloads，这样就可以窃取控制权。一般多见的都是主动渗透了，攻击web应用，甚至工控系统服务。注：工控安全目前也称为一个重要的行业关注点。</p>\n<p>被动渗透攻击针对主要是客户端软件，还要用户自己把恶意内容输进去，这个就很考验社会工程学水平了，你得诱骗用户。没错就是诱骗，接下来就是利用用户自己触发漏洞，从而到达了控制用户系统的目的。注：社工也挺重要的。</p>\n<h3 id=\"辅助模块\"><a href=\"#辅助模块\" class=\"headerlink\" title=\"辅助模块\"></a>辅助模块</h3><p>辅助模块主要是为信息收集环节提供了大量的情报支持，也可以进行网络扫描查点，甚至构建虚假服务去获取用户的密码。</p>\n<h3 id=\"攻击载荷模块\"><a href=\"#攻击载荷模块\" class=\"headerlink\" title=\"攻击载荷模块\"></a>攻击载荷模块</h3><p>所谓的攻击载荷模块就是大家常说的Payload，它是在渗透攻击成功以后再目标系统上植入一段可以执行的代码，以此帮助攻击者取得目标系统上的攻击会话。metasploit上就提供了各种各样的Payload，这些都可以供我们使用，福利啊！</p>\n<h3 id=\"Shellcode模块\"><a href=\"#Shellcode模块\" class=\"headerlink\" title=\"Shellcode模块\"></a>Shellcode模块</h3><p>如果说Payloads是metasploit里的炸弹，那么shellcode就是其中的TNT炸药。再完成渗透攻击后，shellcode模块会被攻击者植入到目标系统上，创建后门，上传恶意代码，再执行攻击载荷中相应的命令产生Shell，以达到偷偷对目标系统进行破坏或信息窃取的目的。</p>\n<h2 id=\"metasploit的使用\"><a href=\"#metasploit的使用\" class=\"headerlink\" title=\"metasploit的使用\"></a>metasploit的使用</h2><p>metasploit可以通过不同的方式打开，建议使用图形化界面的方式，毕竟我们还是图形化比较习惯，不过你是大佬就无所谓了。在打开Metasploit之前首先要启用Metasploit服务。如果网络不稳定或者计算机资源不足时，需要对metasploit服务进行重启。</p>\n<p>不过从kali Linux 2开始，系统就没有metasploit服务了，所以原来的<code>service metasploit start</code>的启动方式就废了。<br><img src=\"https://img-blog.csdnimg.cn/20191024210920381.png\" alt=\"1\"></p>\n<p>在kali 2版本中启动自带数据库支持的MSF就需要别的办法了：</p>\n<p>（1）打开postgresql数据库</p>\n<p><code>service postgresql start</code></p>\n<p>（2）初始化MSF数据库</p>\n<p><code>msfdb init</code></p>\n<p>（3）运行msfconsole</p>\n<p><code>msfconsole</code></p>\n<p>（4）在msf中查看数据库连接状态：</p>\n<p><code>db_status</code></p>\n<p><img src=\"https://img-blog.csdnimg.cn/20191024211003575.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzI2MTM5MDQ1,size_16,color_FFFFFF,t_70\" alt=\"2\"></p>\n<p>这样就启动成功了。</p>\n<p>接下来我们启动Metasploit图形化界面armitag。</p>\n<p>可是我发现我的kali里居然没有Armitage，所以我用了上次提到的apt-get命令下载了一个Armitage</p>\n<p>打开后，会显示如下图片</p>\n<p><img src=\"https://img-blog.csdnimg.cn/20191024211134912.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzI2MTM5MDQ1,size_16,color_FFFFFF,t_70\" alt=\"3\"></p>\n<p>这里显示了Metasploit的服务基本信息。点击connect连接服务，会出现一个metasploit的RPC服务，单击“是”就好了。然后就会显示预配置模块、活跃的目标系统和metasploit标签。<br><img src=\"https://img-blog.csdnimg.cn/2019102421130774.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzI2MTM5MDQ1,size_16,color_FFFFFF,t_70\" alt=\"4\"><br>对所有的主机进行扫描，就选择Hosts-&gt;Nmap-&gt;Scan-&gt;Quick Scan<br><img src=\"https://img-blog.csdnimg.cn/20191024211341993.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzI2MTM5MDQ1,size_16,color_FFFFFF,t_70\" alt=\"5\"><br>扫描结果如下：<br><img src=\"https://img-blog.csdnimg.cn/20191024211408196.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzI2MTM5MDQ1,size_16,color_FFFFFF,t_70\" alt=\"6\"></p>\n<p>还可以对单个ip地址进行nmap扫描，就会得到更多的有用信息，例如上图我们可以看到IP地址和MAC地址以及网卡是intel公司的。在一定程度上可以分辨目标ip的品牌，如我下面说的手机。</p>\n<p>我在以我的手机为例，扫描我的手机的IP地址得到下图：<br><img src=\"https://img-blog.csdnimg.cn/20191024211458670.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzI2MTM5MDQ1,size_16,color_FFFFFF,t_70\" alt=\"6\"><br>可以看出我的这台设备是属于摩托罗拉移动的设备。注：联想品牌和moto同属摩托罗拉移动。</p>\n<p>扫描结束后，单击左上栏的Attacks按钮，然后选择Find Attacks，找到可以攻击的目标和方法，然后再次右击目标主机的时候就会出现攻击选项，这个时候就可以对其进行攻击了。<br><img src=\"https://img-blog.csdnimg.cn/20191024211532144.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzI2MTM5MDQ1,size_16,color_FFFFFF,t_70\" alt=\"7\"></p>\n<p>在攻击选项里可以看到很多的子选项，这些都是可供攻击的攻击漏洞。此时就已经可以在预配置模块中选择攻击方式，我们在预配置模块中选择exploit/Windows/browser/adobe_cooltype_sing模块。</p>\n<p>通过选择adobe_cooltype_sing使其显示为以下模块。<br><img src=\"https://img-blog.csdnimg.cn/20191024211605610.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzI2MTM5MDQ1,size_16,color_FFFFFF,t_70\" alt=\"8\"></p>\n<p>它会在主机上创建一个PDF文件，而且这个PDF文件可以包含了恶意代码或者攻击载荷模块。如果有主机访问了这个PDF文档我们将会获取到该主机的详细信息，包括操作系统和使用的浏览器等信息。</p>\n<p>比如现在我的电脑访问了<a href=\"http://192.168.199.172:8080/7gwC8kcfVO%E5%B0%B1%E4%BC%9A%E7%9C%8B%E5%88%B0%E8%BF%99%E4%B8%AAPDF\">http://192.168.199.172:8080/7gwC8kcfVO就会看到这个PDF</a><br><img src=\"https://img-blog.csdnimg.cn/2019102421163069.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzI2MTM5MDQ1,size_16,color_FFFFFF,t_70\" alt=\"9\"><br>我就可以在Kali上看到我的这台Windows是Windows10 系统，edge浏览器。<br><img src=\"https://img-blog.csdnimg.cn/20191024211708390.png\" alt=\"在这里插入图片描述\"><br>我使用Windows下载了PDF，很可惜我的电脑自带的联想电脑管家，完全没有安全风险提示，于是我手动调用了联想电脑管家去扫描文件，依旧是没有报出风险。根据联想官网的显示使用的是火绒的杀毒引擎，看来查杀能力还是令人担忧啊！查杀率似乎不高。（我要不要换一个杀软？？？？）<br><img src=\"https://img-blog.csdnimg.cn/20191024211735637.png\" alt=\"10\"></p>\n<p>但是怎么可能没有风险呢，所以我选择上网通过腾讯的哈勃文件分析系统进行扫描，结果如下：<br><img src=\"https://img-blog.csdnimg.cn/20191024211805518.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzI2MTM5MDQ1,size_16,color_FFFFFF,t_70\" alt=\"11\"></p>\n<p>附上哈勃分析系统网址：<a href=\"http://habo.qq.com/\">http://habo.qq.com</a></p>\n<p>当然你也可以使用attack命令中的命令对主机进行攻击，前提是需要绑定一个靶机。</p>\n<p>再对靶机运行attack中的相应模块进行攻击，与上面演示的大致是一样的。大家可以自行使用Kali来进行metasploit的练习，但是不一定可以找到可以供攻击的攻击漏洞。可以自行尝试一些模块。</p>\n<p>本文只为简单的介绍一下metasploit的使用流程吧。</p>\n<h2 id=\"参考资料\"><a href=\"#参考资料\" class=\"headerlink\" title=\"参考资料\"></a>参考资料</h2><p>[1]陈铁明.网络空间安全实战基础:第一版.北京:人民邮电出版社,2018.</p>\n","text":"Metasploit入门上手今天是2019年10月24日打卡嘀嘀嘀！！！菜鸟卡！！一起学习进步！！！ 基本介绍发展历史开源软件metasploit是由HD Moore在2003年创立的，并在2003年10月发布了第一个版本。它集成了11个渗透攻击模块。 版本metasploit分...","link":"","photos":[],"count_time":{"symbolsCount":"2.7k","symbolsTime":"2 mins."},"categories":[{"name":"学习笔记","slug":"学习笔记","count":32,"path":"api/categories/学习笔记.json"}],"tags":[{"name":"网络安全","slug":"网络安全","count":32,"path":"api/tags/网络安全.json"}],"toc":"<ol class=\"toc\"><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" href=\"#Metasploit%E5%85%A5%E9%97%A8%E4%B8%8A%E6%89%8B\"><span class=\"toc-text\">Metasploit入门上手</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E5%9F%BA%E6%9C%AC%E4%BB%8B%E7%BB%8D\"><span class=\"toc-text\">基本介绍</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E5%8F%91%E5%B1%95%E5%8E%86%E5%8F%B2\"><span class=\"toc-text\">发展历史</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E7%89%88%E6%9C%AC\"><span class=\"toc-text\">版本</span></a></li></ol></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#Metasploit%E5%9F%BA%E6%9C%AC%E6%A8%A1%E5%9D%97\"><span class=\"toc-text\">Metasploit基本模块</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E6%A8%A1%E5%9D%97%E7%B1%BB%E5%9E%8B\"><span class=\"toc-text\">模块类型</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E6%B8%97%E9%80%8F%E6%A8%A1%E5%9D%97\"><span class=\"toc-text\">渗透模块</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E8%BE%85%E5%8A%A9%E6%A8%A1%E5%9D%97\"><span class=\"toc-text\">辅助模块</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E6%94%BB%E5%87%BB%E8%BD%BD%E8%8D%B7%E6%A8%A1%E5%9D%97\"><span class=\"toc-text\">攻击载荷模块</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#Shellcode%E6%A8%A1%E5%9D%97\"><span class=\"toc-text\">Shellcode模块</span></a></li></ol></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#metasploit%E7%9A%84%E4%BD%BF%E7%94%A8\"><span class=\"toc-text\">metasploit的使用</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99\"><span class=\"toc-text\">参考资料</span></a></li></ol></li></ol>","author":{"name":"沐子龍","slug":"blog-author","avatar":"/svg/head.png","link":"/","description":"爱你所爱，行你所行，听从你心，无问西东","socials":{"github":"https://github.com/A1andNS","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}},"mapped":true,"prev_post":{"title":"HTTP头文件（持续更新）","uid":"fa89043ea17343f99a80dd6e1c6c7c73","slug":"HTTP头文件（持续更新）","date":"2020-03-09T08:03:01.000Z","updated":"2020-04-13T00:46:32.000Z","comments":true,"path":"api/articles/HTTP头文件（持续更新）.json","keywords":"A1andNS","cover":[],"text":"HTTP头文件简介（持续更新）HTTP头文件可以包含很多有用的信息，但作为初学者大多数是不清楚这些内容的含义和作用，故我在学习过程中记录下主要的头文件内容的含义和作用，以备后续考查。本文会不定期持续更新。。。。。。 请求头下图为火狐浏览器的火狐主页https://home.fir...","link":"","photos":[],"count_time":{"symbolsCount":"2.7k","symbolsTime":"2 mins."},"categories":[{"name":"学习笔记","slug":"学习笔记","count":32,"path":"api/categories/学习笔记.json"}],"tags":[{"name":"网络安全","slug":"网络安全","count":32,"path":"api/tags/网络安全.json"},{"name":"WEB","slug":"WEB","count":39,"path":"api/tags/WEB.json"}],"author":{"name":"沐子龍","slug":"blog-author","avatar":"/svg/head.png","link":"/","description":"爱你所爱，行你所行，听从你心，无问西东","socials":{"github":"https://github.com/A1andNS","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}}},"next_post":{"title":"DVWA初学","uid":"fc19ff46ec94019a93ce13e12e1e89c6","slug":"DVWA初学","date":"2020-03-09T08:01:01.000Z","updated":"2020-04-13T00:46:12.000Z","comments":true,"path":"api/articles/DVWA初学.json","keywords":"A1andNS","cover":[],"text":"DVWA的介绍DVWA是用PHP和MySQL编写的用于常规web漏洞教学和检测web脆弱性测试程序，它包含SQL注入、XSS、CSRF等常见的一些安全漏洞。我们可以在本机或者靶机甚至服务器搭建DVWA环境，供我们练习渗透技术，也可以查看后端是怎么写的，了解原理。最重要的还是自己搭...","link":"","photos":[],"count_time":{"symbolsCount":"2.7k","symbolsTime":"2 mins."},"categories":[{"name":"学习笔记","slug":"学习笔记","count":32,"path":"api/categories/学习笔记.json"}],"tags":[{"name":"网络安全","slug":"网络安全","count":32,"path":"api/tags/网络安全.json"},{"name":"WEB","slug":"WEB","count":39,"path":"api/tags/WEB.json"}],"author":{"name":"沐子龍","slug":"blog-author","avatar":"/svg/head.png","link":"/","description":"爱你所爱，行你所行，听从你心，无问西东","socials":{"github":"https://github.com/A1andNS","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}}}}